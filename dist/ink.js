module.exports=function(t){function e(o){if(n[o])return n[o].exports;var r=n[o]={i:o,l:!1,exports:{}};return t[o].call(r.exports,r,r.exports,e),r.l=!0,r.exports}var n={};return e.m=t,e.c=n,e.i=function(t){return t},e.d=function(t,n,o){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:o})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=6)}([function(t,e,n){function o(t){return l(t.duration,Date.now()-t.mouseDown)}function r(t){return t.mouseUp>0?Date.now()-t.mouseUp:0}function i(t){var e=t.duration,n=t.radius,i=.85*a(o(t),0,n,e),u=.15*a(r(t),0,n,e),l=.02*n*c(Date.now()/e);return s(0,i+u+l)}var a=n(7),u=Math.sqrt(2),c=Math.cos,s=Math.max,l=Math.min;t.exports={getMaxRadius:function(t,e,n){return l(.5*s(t,e),n)},getBlotOpacity:function(t,e){return a(r(t),e,-e,t.duration)},getBlotOuterOpacity:function(t,e){return l(this.getBlotOpacity(t,e),a(o(t),0,.3,3*t.duration))},getBlotShiftX:function(t,e,n){return l(1,i(t)/e*2/u)*(n/2-t.x)},getBlotShiftY:function(t,e,n){return l(1,i(t)/e*2/u)*(n/2-t.y)},getBlotScale:function(t){return i(t)/t.radius}}},function(t,e){t.exports={borderRadius:"inherit",height:"100%",left:0,position:"absolute",top:0,width:"100%"}},function(t,e){var n=!1;"undefined"!=typeof window&&(n="ontouchstart"in window||window.DocumentTouch&&document instanceof window.DocumentTouch),t.exports=n},function(t,e){t.exports=function(t){return(window.devicePixelRatio||1)/(t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1)}},function(t,e,n){var o=n(0),r=function(t){var e=t.mouseUp,n=t.duration;return!e||Date.now()-e<n};t.exports=function(t){var e=[],n=!1,i=void 0,a={each:function(t,n){for(var o=0,r=e.length;o<r;o++)t.call(n,e[o])},play:function(){n||(n=!0,a.update())},stop:function(){n=!1,cancelAnimationFrame(i)},getTotalOpacity:function(t){for(var n=0,r=0,i=e.length;r<i;r++)n+=o.getBlotOuterOpacity(e[r],t);return n},update:function(){e=e.filter(r),e.length?i=requestAnimationFrame(a.update):a.stop(),t()},add:function(t){e.push(t),a.play()},release:function(t){for(var n=e.length-1;n>=0;n--)if(!e[n].mouseUp)return e[n].mouseUp=t}};return a}},function(t,e){t.exports=require("react")},function(t,e,n){function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t},u=n(2),c=0,s=n(3),l=n(5),p=n(1),f=n(4),h=2*Math.PI,d=n(0),g=function(t){function e(n){o(this,e);var i=r(this,t.apply(this,arguments));return i.tick=function(){var t=i.state,e=t.ctx,n=t.color,o=t.density,r=t.height,a=t.width,u=t.store;e.save(),e.scale(o,o),e.clearRect(0,0,a,r),e.fillStyle=n,i.props.background&&(e.globalAlpha=u.getTotalOpacity(i.props.opacity),e.fillRect(0,0,a,r)),u.each(i.makeBlot,i),e.restore()},i._getCenter=function(){var t=i.canvas,e=t.getBoundingClientRect(),n=e.top,o=e.bottom,r=e.left;return{clientX:r+(e.right-r)/2,clientY:n+(o-n)/2}},i._onPress=function(t){var e=i.props.center,n=t.button,o=t.ctrlKey,r=t.clientX,a=t.clientY,u=t.changedTouches,s=Date.now();if(u)if(e){var l=i._getCenter(),p=l.clientX,f=l.clientY;i.pushBlot(s,p,f)}else for(var h=0;h<u.length;h++){var d=u[h],g=d.clientX,y=d.clientY;i.pushBlot(s,g,y)}else if(n===c&&!o)if(e){var v=i._getCenter(),w=v.clientX,m=v.clientY;console.log(w,m),i.pushBlot(s,w,m)}else i.pushBlot(s,r,a)},i._onRelease=function(){i.state.store.release(Date.now())},i.state={color:"transparent",density:1,height:0,store:f(i.tick),touchEvents:i.touchEvents(),width:0},i}return i(e,t),e.prototype.touchEvents=function(){return this.props.hasTouch?{onTouchStart:this._onPress,onTouchEnd:this._onRelease,onTouchCancel:this._onRelease}:{onMouseDown:this._onPress,onMouseUp:this._onRelease,onMouseLeave:this._onRelease}},e.prototype.makeBlot=function(t){var e=this.state,n=e.ctx,o=e.height,r=e.width,i=t.x,a=t.y,u=t.radius;if(n.globalAlpha=d.getBlotOpacity(t,this.props.opacity),n.beginPath(),this.props.recenter){var c=Math.max(o,r);i+=d.getBlotShiftX(t,c,r),a+=d.getBlotShiftY(t,c,o)}n.arc(i,a,u*d.getBlotScale(t),0,h),n.closePath(),n.fill()},e.prototype.componentWillUnmount=function(){this.state.store.stop()},e.prototype.pushBlot=function(t,e,n){var o=this,r=this.canvas;r instanceof window.HTMLCanvasElement==!1&&(r=r.getDOMNode());var i=r.getBoundingClientRect(),a=i.top,u=i.bottom,c=i.left,l=i.right,p=window.getComputedStyle(r),f=p.color,h=this.state.ctx||r.getContext("2d"),g=s(h),y=u-a,v=l-c,w=d.getMaxRadius(y,v,this.props.radius);this.setState({color:f,ctx:h,density:g,height:y,width:v},function(){o.state.store.add({duration:o.props.duration,mouseDown:t,mouseUp:0,radius:w,x:e-c,y:n-a})})},e.prototype.render=function(){var t=this,e=this.state,n=e.density,o=e.height,r=e.width,i=e.touchEvents;return l.createElement("canvas",a({className:"ink",ref:function(e){return t.canvas=e},style:a({},p,this.props.style),height:o*n,width:r*n,onDragOver:this._onRelease},i))},e}(l.PureComponent);g.defaultProps={background:!0,duration:1e3,opacity:.25,radius:150,recenter:!0,hasTouch:u,center:!1},t.exports=g},function(t,e){t.exports=function(t,e,n,o){return n*((t=t/o-1)*t*t*t*t+1)+e}}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vaW5rLmpzIiwid2VicGFjazovLy93ZWJwYWNrL2Jvb3RzdHJhcCA5NTBkYjY2OGIyMDVmMGNlYjYwZSIsIndlYnBhY2s6Ly8vLi9zcmMvdXRpbC9lcXVhdGlvbnMuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL3N0eWxlLmpzIiwid2VicGFjazovLy8uL3NyYy91dGlsL2hhc1RvdWNoLmpzIiwid2VicGFjazovLy8uL3NyYy91dGlsL3BpeGVsUmF0aW8uanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL3V0aWwvc3RvcmUuanMiLCJ3ZWJwYWNrOi8vL2V4dGVybmFsIFwicmVhY3RcIiIsIndlYnBhY2s6Ly8vLi9zcmMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL3V0aWwvZWFzaW5nLmpzIl0sIm5hbWVzIjpbIm1vZHVsZSIsImV4cG9ydHMiLCJtb2R1bGVzIiwiX193ZWJwYWNrX3JlcXVpcmVfXyIsIm1vZHVsZUlkIiwiaW5zdGFsbGVkTW9kdWxlcyIsImkiLCJsIiwiY2FsbCIsIm0iLCJjIiwidmFsdWUiLCJkIiwibmFtZSIsImdldHRlciIsIm8iLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImNvbmZpZ3VyYWJsZSIsImVudW1lcmFibGUiLCJnZXQiLCJuIiwiX19lc01vZHVsZSIsIm9iamVjdCIsInByb3BlcnR5IiwicHJvdG90eXBlIiwiaGFzT3duUHJvcGVydHkiLCJwIiwicyIsImdldFByZXNzIiwiYmxvdCIsIm1pbiIsImR1cmF0aW9uIiwiRGF0ZSIsIm5vdyIsIm1vdXNlRG93biIsImdldFJlbGVhc2UiLCJtb3VzZVVwIiwiZ2V0UmFkaXVzIiwicmFkaXVzIiwiZG93biIsImVhc2luZyIsInVwIiwidW5kdWxhdGlvbiIsImNvcyIsIm1heCIsIlNRUlRfMiIsIk1hdGgiLCJzcXJ0IiwiZ2V0TWF4UmFkaXVzIiwiaGVpZ2h0Iiwid2lkdGgiLCJnZXRCbG90T3BhY2l0eSIsIm9wYWNpdHkiLCJnZXRCbG90T3V0ZXJPcGFjaXR5IiwidGhpcyIsImdldEJsb3RTaGlmdFgiLCJzaXplIiwieCIsImdldEJsb3RTaGlmdFkiLCJ5IiwiZ2V0QmxvdFNjYWxlIiwiYm9yZGVyUmFkaXVzIiwibGVmdCIsInBvc2l0aW9uIiwidG9wIiwiYm9vbCIsIndpbmRvdyIsIkRvY3VtZW50VG91Y2giLCJkb2N1bWVudCIsImNvbnRleHQiLCJkZXZpY2VQaXhlbFJhdGlvIiwid2Via2l0QmFja2luZ1N0b3JlUGl4ZWxSYXRpbyIsIm1vekJhY2tpbmdTdG9yZVBpeGVsUmF0aW8iLCJtc0JhY2tpbmdTdG9yZVBpeGVsUmF0aW8iLCJvQmFja2luZ1N0b3JlUGl4ZWxSYXRpbyIsImJhY2tpbmdTdG9yZVBpeGVsUmF0aW8iLCJFcXVhdGlvbnMiLCJraWxsU3RhbGUiLCJfcmVmIiwicHVibGljaXplIiwiX2RhdGEiLCJfcGxheWluZyIsIl9mcmFtZSIsIlN0b3JlIiwiZWFjaCIsImNhbGxiYWNrIiwic2NvcGUiLCJsZW5ndGgiLCJwbGF5IiwidXBkYXRlIiwic3RvcCIsImNhbmNlbEFuaW1hdGlvbkZyYW1lIiwiZ2V0VG90YWxPcGFjaXR5IiwiYW5zd2VyIiwiZmlsdGVyIiwicmVxdWVzdEFuaW1hdGlvbkZyYW1lIiwiYWRkIiwicHJvcHMiLCJwdXNoIiwicmVsZWFzZSIsInRpbWUiLCJyZXF1aXJlIiwiX2NsYXNzQ2FsbENoZWNrIiwiaW5zdGFuY2UiLCJDb25zdHJ1Y3RvciIsIlR5cGVFcnJvciIsIl9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuIiwic2VsZiIsIlJlZmVyZW5jZUVycm9yIiwiX2luaGVyaXRzIiwic3ViQ2xhc3MiLCJzdXBlckNsYXNzIiwiY3JlYXRlIiwiY29uc3RydWN0b3IiLCJ3cml0YWJsZSIsInNldFByb3RvdHlwZU9mIiwiX19wcm90b19fIiwiX2V4dGVuZHMiLCJhc3NpZ24iLCJ0YXJnZXQiLCJhcmd1bWVudHMiLCJzb3VyY2UiLCJrZXkiLCJIQVNfVE9VQ0giLCJNT1VTRV9MRUZUIiwicGl4ZWxSYXRpbyIsIlJlYWN0IiwiU1RZTEUiLCJUQVUiLCJQSSIsIkluayIsIl9SZWFjdCRQdXJlQ29tcG9uZW50IiwiX3RoaXMiLCJhcHBseSIsInRpY2siLCJfdGhpcyRzdGF0ZSIsInN0YXRlIiwiY3R4IiwiY29sb3IiLCJkZW5zaXR5Iiwic3RvcmUiLCJzYXZlIiwic2NhbGUiLCJjbGVhclJlY3QiLCJmaWxsU3R5bGUiLCJiYWNrZ3JvdW5kIiwiZ2xvYmFsQWxwaGEiLCJmaWxsUmVjdCIsIm1ha2VCbG90IiwicmVzdG9yZSIsIl9nZXRDZW50ZXIiLCJlbCIsImNhbnZhcyIsIl9lbCRnZXRCb3VuZGluZ0NsaWVudCIsImdldEJvdW5kaW5nQ2xpZW50UmVjdCIsImJvdHRvbSIsImNsaWVudFgiLCJyaWdodCIsImNsaWVudFkiLCJfb25QcmVzcyIsImUiLCJjZW50ZXIiLCJidXR0b24iLCJjdHJsS2V5IiwiY2hhbmdlZFRvdWNoZXMiLCJ0aW1lU3RhbXAiLCJfdGhpcyRfZ2V0Q2VudGVyIiwicHVzaEJsb3QiLCJfY2hhbmdlZFRvdWNoZXMkaSIsIl90aGlzJF9nZXRDZW50ZXIyIiwiY29uc29sZSIsImxvZyIsIl9vblJlbGVhc2UiLCJ0b3VjaEV2ZW50cyIsImhhc1RvdWNoIiwib25Ub3VjaFN0YXJ0Iiwib25Ub3VjaEVuZCIsIm9uVG91Y2hDYW5jZWwiLCJvbk1vdXNlRG93biIsIm9uTW91c2VVcCIsIm9uTW91c2VMZWF2ZSIsIl9zdGF0ZSIsImJlZ2luUGF0aCIsInJlY2VudGVyIiwiYXJjIiwiY2xvc2VQYXRoIiwiZmlsbCIsImNvbXBvbmVudFdpbGxVbm1vdW50IiwiX3RoaXMyIiwiSFRNTENhbnZhc0VsZW1lbnQiLCJnZXRET01Ob2RlIiwiX2VsJGdldEJvdW5kaW5nQ2xpZW50MiIsIl93aW5kb3ckZ2V0Q29tcHV0ZWRTdCIsImdldENvbXB1dGVkU3R5bGUiLCJnZXRDb250ZXh0Iiwic2V0U3RhdGUiLCJyZW5kZXIiLCJfdGhpczMiLCJfc3RhdGUyIiwiY3JlYXRlRWxlbWVudCIsImNsYXNzTmFtZSIsInJlZiIsInN0eWxlIiwib25EcmFnT3Zl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RUFDaEJnRSxXQUFhckosS0FBS3NILFlBQ2JDLEtSa1ZWM0MsR1EvY1NKLEVBQU04RSxjQUFsQjFFLEdBRUcyRSxjQUNMNUQsWUFBYSxFQUNibEgsU0FBYSxJQUNicUIsUUFBYSxJQUNiZCxPQUFhLElBQ2JpSixVQUFhLEVBQ2JULFNBQWFuRCxFQUNic0MsUUFBYSxHQWtLakJsSyxFQUFPQyxRQUFVa0ksR1JzVFgsU0FBVW5JLEVBQVFDLEdTemV4QkQsRUFBT0MsUUFBVSxTQUF1QjhNLEVBQUdDLEVBQUd0TSxFQUFHRSxHQUMvQyxNQUFPRixLQUFJcU0sRUFBRUEsRUFBRW5NLEVBQUUsR0FBR21NLEVBQUVBLEVBQUVBLEVBQUVBLEVBQUksR0FBS0MiLCJmaWxlIjoiaW5rLmpzIiwic291cmNlc0NvbnRlbnQiOlsibW9kdWxlLmV4cG9ydHMgPVxuLyoqKioqKi8gKGZ1bmN0aW9uKG1vZHVsZXMpIHsgLy8gd2VicGFja0Jvb3RzdHJhcFxuLyoqKioqKi8gXHQvLyBUaGUgbW9kdWxlIGNhY2hlXG4vKioqKioqLyBcdHZhciBpbnN0YWxsZWRNb2R1bGVzID0ge307XG4vKioqKioqL1xuLyoqKioqKi8gXHQvLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuLyoqKioqKi8gXHRmdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG4vKioqKioqL1xuLyoqKioqKi8gXHRcdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuLyoqKioqKi8gXHRcdGlmKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKSB7XG4vKioqKioqLyBcdFx0XHRyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0cztcbi8qKioqKiovIFx0XHR9XG4vKioqKioqLyBcdFx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcbi8qKioqKiovIFx0XHR2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7XG4vKioqKioqLyBcdFx0XHRpOiBtb2R1bGVJZCxcbi8qKioqKiovIFx0XHRcdGw6IGZhbHNlLFxuLyoqKioqKi8gXHRcdFx0ZXhwb3J0czoge31cbi8qKioqKiovIFx0XHR9O1xuLyoqKioqKi9cbi8qKioqKiovIFx0XHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cbi8qKioqKiovIFx0XHRtb2R1bGVzW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcbi8qKioqKiovXG4vKioqKioqLyBcdFx0Ly8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZFxuLyoqKioqKi8gXHRcdG1vZHVsZS5sID0gdHJ1ZTtcbi8qKioqKiovXG4vKioqKioqLyBcdFx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcbi8qKioqKiovIFx0XHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG4vKioqKioqLyBcdH1cbi8qKioqKiovXG4vKioqKioqL1xuLyoqKioqKi8gXHQvLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKVxuLyoqKioqKi8gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzO1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGUgY2FjaGVcbi8qKioqKiovIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5jID0gaW5zdGFsbGVkTW9kdWxlcztcbi8qKioqKiovXG4vKioqKioqLyBcdC8vIGlkZW50aXR5IGZ1bmN0aW9uIGZvciBjYWxsaW5nIGhhcm1vbnkgaW1wb3J0cyB3aXRoIHRoZSBjb3JyZWN0IGNvbnRleHRcbi8qKioqKiovIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5pID0gZnVuY3Rpb24odmFsdWUpIHsgcmV0dXJuIHZhbHVlOyB9O1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gZGVmaW5lIGdldHRlciBmdW5jdGlvbiBmb3IgaGFybW9ueSBleHBvcnRzXG4vKioqKioqLyBcdF9fd2VicGFja19yZXF1aXJlX18uZCA9IGZ1bmN0aW9uKGV4cG9ydHMsIG5hbWUsIGdldHRlcikge1xuLyoqKioqKi8gXHRcdGlmKCFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywgbmFtZSkpIHtcbi8qKioqKiovIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBuYW1lLCB7XG4vKioqKioqLyBcdFx0XHRcdGNvbmZpZ3VyYWJsZTogZmFsc2UsXG4vKioqKioqLyBcdFx0XHRcdGVudW1lcmFibGU6IHRydWUsXG4vKioqKioqLyBcdFx0XHRcdGdldDogZ2V0dGVyXG4vKioqKioqLyBcdFx0XHR9KTtcbi8qKioqKiovIFx0XHR9XG4vKioqKioqLyBcdH07XG4vKioqKioqL1xuLyoqKioqKi8gXHQvLyBnZXREZWZhdWx0RXhwb3J0IGZ1bmN0aW9uIGZvciBjb21wYXRpYmlsaXR5IHdpdGggbm9uLWhhcm1vbnkgbW9kdWxlc1xuLyoqKioqKi8gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm4gPSBmdW5jdGlvbihtb2R1bGUpIHtcbi8qKioqKiovIFx0XHR2YXIgZ2V0dGVyID0gbW9kdWxlICYmIG1vZHVsZS5fX2VzTW9kdWxlID9cbi8qKioqKiovIFx0XHRcdGZ1bmN0aW9uIGdldERlZmF1bHQoKSB7IHJldHVybiBtb2R1bGVbJ2RlZmF1bHQnXTsgfSA6XG4vKioqKioqLyBcdFx0XHRmdW5jdGlvbiBnZXRNb2R1bGVFeHBvcnRzKCkgeyByZXR1cm4gbW9kdWxlOyB9O1xuLyoqKioqKi8gXHRcdF9fd2VicGFja19yZXF1aXJlX18uZChnZXR0ZXIsICdhJywgZ2V0dGVyKTtcbi8qKioqKiovIFx0XHRyZXR1cm4gZ2V0dGVyO1xuLyoqKioqKi8gXHR9O1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsXG4vKioqKioqLyBcdF9fd2VicGFja19yZXF1aXJlX18ubyA9IGZ1bmN0aW9uKG9iamVjdCwgcHJvcGVydHkpIHsgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmplY3QsIHByb3BlcnR5KTsgfTtcbi8qKioqKiovXG4vKioqKioqLyBcdC8vIF9fd2VicGFja19wdWJsaWNfcGF0aF9fXG4vKioqKioqLyBcdF9fd2VicGFja19yZXF1aXJlX18ucCA9IFwiXCI7XG4vKioqKioqL1xuLyoqKioqKi8gXHQvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbi8qKioqKiovIFx0cmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oX193ZWJwYWNrX3JlcXVpcmVfXy5zID0gNik7XG4vKioqKioqLyB9KVxuLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbi8qKioqKiovIChbXG4vKiAwICovXG4vKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cbnZhciBlYXNpbmcgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDcpO1xudmFyIFNRUlRfMiA9IE1hdGguc3FydCgyKTtcbnZhciBjb3MgPSBNYXRoLmNvcyxcbiAgICBtYXggPSBNYXRoLm1heCxcbiAgICBtaW4gPSBNYXRoLm1pbjtcblxuXG5mdW5jdGlvbiBnZXRQcmVzcyhibG90KSB7XG4gIHJldHVybiBtaW4oYmxvdC5kdXJhdGlvbiwgRGF0ZS5ub3coKSAtIGJsb3QubW91c2VEb3duKTtcbn1cblxuZnVuY3Rpb24gZ2V0UmVsZWFzZShibG90KSB7XG4gIHJldHVybiBibG90Lm1vdXNlVXAgPiAwID8gRGF0ZS5ub3coKSAtIGJsb3QubW91c2VVcCA6IDA7XG59XG5cbmZ1bmN0aW9uIGdldFJhZGl1cyhibG90KSB7XG4gIHZhciBkdXJhdGlvbiA9IGJsb3QuZHVyYXRpb24sXG4gICAgICByYWRpdXMgPSBibG90LnJhZGl1cztcblxuXG4gIHZhciBkb3duID0gZWFzaW5nKGdldFByZXNzKGJsb3QpLCAwLCByYWRpdXMsIGR1cmF0aW9uKSAqIDAuODU7XG4gIHZhciB1cCA9IGVhc2luZyhnZXRSZWxlYXNlKGJsb3QpLCAwLCByYWRpdXMsIGR1cmF0aW9uKSAqIDAuMTU7XG4gIHZhciB1bmR1bGF0aW9uID0gcmFkaXVzICogMC4wMiAqIGNvcyhEYXRlLm5vdygpIC8gZHVyYXRpb24pO1xuXG4gIHJldHVybiBtYXgoMCwgZG93biArIHVwICsgdW5kdWxhdGlvbik7XG59XG5cbm1vZHVsZS5leHBvcnRzID0ge1xuICBnZXRNYXhSYWRpdXM6IGZ1bmN0aW9uIGdldE1heFJhZGl1cyhoZWlnaHQsIHdpZHRoLCByYWRpdXMpIHtcbiAgICByZXR1cm4gbWluKG1heChoZWlnaHQsIHdpZHRoKSAqIDAuNSwgcmFkaXVzKTtcbiAgfSxcbiAgZ2V0QmxvdE9wYWNpdHk6IGZ1bmN0aW9uIGdldEJsb3RPcGFjaXR5KGJsb3QsIG9wYWNpdHkpIHtcbiAgICByZXR1cm4gZWFzaW5nKGdldFJlbGVhc2UoYmxvdCksIG9wYWNpdHksIC1vcGFjaXR5LCBibG90LmR1cmF0aW9uKTtcbiAgfSxcbiAgZ2V0QmxvdE91dGVyT3BhY2l0eTogZnVuY3Rpb24gZ2V0QmxvdE91dGVyT3BhY2l0eShibG90LCBvcGFjaXR5KSB7XG4gICAgcmV0dXJuIG1pbih0aGlzLmdldEJsb3RPcGFjaXR5KGJsb3QsIG9wYWNpdHkpLCBlYXNpbmcoZ2V0UHJlc3MoYmxvdCksIDAsIDAuMywgYmxvdC5kdXJhdGlvbiAqIDMpKTtcbiAgfSxcbiAgZ2V0QmxvdFNoaWZ0WDogZnVuY3Rpb24gZ2V0QmxvdFNoaWZ0WChibG90LCBzaXplLCB3aWR0aCkge1xuICAgIHJldHVybiBtaW4oMSwgZ2V0UmFkaXVzKGJsb3QpIC8gc2l6ZSAqIDIgLyBTUVJUXzIpICogKHdpZHRoIC8gMiAtIGJsb3QueCk7XG4gIH0sXG4gIGdldEJsb3RTaGlmdFk6IGZ1bmN0aW9uIGdldEJsb3RTaGlmdFkoYmxvdCwgc2l6ZSwgaGVpZ2h0KSB7XG4gICAgcmV0dXJuIG1pbigxLCBnZXRSYWRpdXMoYmxvdCkgLyBzaXplICogMiAvIFNRUlRfMikgKiAoaGVpZ2h0IC8gMiAtIGJsb3QueSk7XG4gIH0sXG4gIGdldEJsb3RTY2FsZTogZnVuY3Rpb24gZ2V0QmxvdFNjYWxlKGJsb3QpIHtcbiAgICByZXR1cm4gZ2V0UmFkaXVzKGJsb3QpIC8gYmxvdC5yYWRpdXM7XG4gIH1cbn07XG5cbi8qKiovIH0pLFxuLyogMSAqL1xuLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykge1xuXG5tb2R1bGUuZXhwb3J0cyA9IHtcbiAgYm9yZGVyUmFkaXVzOiAnaW5oZXJpdCcsXG4gIGhlaWdodDogJzEwMCUnLFxuICBsZWZ0OiAwLFxuICBwb3NpdGlvbjogJ2Fic29sdXRlJyxcbiAgdG9wOiAwLFxuICB3aWR0aDogJzEwMCUnXG59O1xuXG4vKioqLyB9KSxcbi8qIDIgKi9cbi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHtcblxudmFyIGJvb2wgPSBmYWxzZTtcblxuaWYgKHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnKSB7XG4gIGJvb2wgPSAnb250b3VjaHN0YXJ0JyBpbiB3aW5kb3cgfHwgd2luZG93LkRvY3VtZW50VG91Y2ggJiYgZG9jdW1lbnQgaW5zdGFuY2VvZiB3aW5kb3cuRG9jdW1lbnRUb3VjaDtcbn1cblxubW9kdWxlLmV4cG9ydHMgPSBib29sO1xuXG4vKioqLyB9KSxcbi8qIDMgKi9cbi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHtcblxuLy8gR29vZCBzdHVmZiBoZXJlOlxuLy8gaHR0cDovL3d3dy5odG1sNXJvY2tzLmNvbS9lbi90dXRvcmlhbHMvY2FudmFzL2hpZHBpL1xuXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChjb250ZXh0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZGV2aWNlUGl4ZWxSYXRpbyA9IHdpbmRvdy5kZXZpY2VQaXhlbFJhdGlvIHx8IDE7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgYmFja2luZ1N0b3JlUmF0aW8gPSBjb250ZXh0LndlYmtpdEJhY2tpbmdTdG9yZVBpeGVsUmF0aW8gfHwgY29udGV4dC5tb3pCYWNraW5nU3RvcmVQaXhlbFJhdGlvIHx8IGNvbnRleHQubXNCYWNraW5nU3RvcmVQaXhlbFJhdGlvIHx8IGNvbnRleHQub0JhY2tpbmdTdG9yZVBpeGVsUmF0aW8gfHwgY29udGV4dC5iYWNraW5nU3RvcmVQaXhlbFJhdGlvIHx8IDE7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBkZXZpY2VQaXhlbFJhdGlvIC8gYmFja2luZ1N0b3JlUmF0aW87XG59O1xuXG4vKioqLyB9KSxcbi8qIDQgKi9cbi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuLyoqXG4gKiBJbmsgU3RvcmVcbiAqIEtlZXBzIHRyYWNrIG9mIGNoYW5nZXMgdG8gcmlwcGxlIGVwaWNlbnRlcnNcbiAqIHNvIHRoYXQgPEluayAvPiBjYW4gZm9jdXMgb24gcmVuZGVyaW5nIHRoZW0uXG4gKi9cblxudmFyIEVxdWF0aW9ucyA9IF9fd2VicGFja19yZXF1aXJlX18oMCk7XG5cbnZhciBraWxsU3RhbGUgPSBmdW5jdGlvbiBraWxsU3RhbGUoX3JlZikge1xuICB2YXIgbW91c2VVcCA9IF9yZWYubW91c2VVcCxcbiAgICAgIGR1cmF0aW9uID0gX3JlZi5kdXJhdGlvbjtcbiAgcmV0dXJuICFtb3VzZVVwIHx8IERhdGUubm93KCkgLSBtb3VzZVVwIDwgZHVyYXRpb247XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChwdWJsaWNpemUpIHtcbiAgdmFyIF9kYXRhID0gW107XG4gIHZhciBfcGxheWluZyA9IGZhbHNlO1xuICB2YXIgX2ZyYW1lID0gdm9pZCAwO1xuXG4gIHZhciBTdG9yZSA9IHtcbiAgICBlYWNoOiBmdW5jdGlvbiBlYWNoKGNhbGxiYWNrLCBzY29wZSkge1xuICAgICAgZm9yICh2YXIgaSA9IDAsIGwgPSBfZGF0YS5sZW5ndGg7IGkgPCBsOyBpKyspIHtcbiAgICAgICAgY2FsbGJhY2suY2FsbChzY29wZSwgX2RhdGFbaV0pO1xuICAgICAgfVxuICAgIH0sXG4gICAgcGxheTogZnVuY3Rpb24gcGxheSgpIHtcbiAgICAgIGlmICghX3BsYXlpbmcpIHtcbiAgICAgICAgX3BsYXlpbmcgPSB0cnVlO1xuICAgICAgICBTdG9yZS51cGRhdGUoKTtcbiAgICAgIH1cbiAgICB9LFxuICAgIHN0b3A6IGZ1bmN0aW9uIHN0b3AoKSB7XG4gICAgICBfcGxheWluZyA9IGZhbHNlO1xuICAgICAgY2FuY2VsQW5pbWF0aW9uRnJhbWUoX2ZyYW1lKTtcbiAgICB9LFxuICAgIGdldFRvdGFsT3BhY2l0eTogZnVuY3Rpb24gZ2V0VG90YWxPcGFjaXR5KG9wYWNpdHkpIHtcbiAgICAgIHZhciBhbnN3ZXIgPSAwO1xuXG4gICAgICBmb3IgKHZhciBpID0gMCwgbCA9IF9kYXRhLmxlbmd0aDsgaSA8IGw7IGkrKykge1xuICAgICAgICBhbnN3ZXIgKz0gRXF1YXRpb25zLmdldEJsb3RPdXRlck9wYWNpdHkoX2RhdGFbaV0sIG9wYWNpdHkpO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gYW5zd2VyO1xuICAgIH0sXG4gICAgdXBkYXRlOiBmdW5jdGlvbiB1cGRhdGUoKSB7XG4gICAgICBfZGF0YSA9IF9kYXRhLmZpbHRlcihraWxsU3RhbGUpO1xuXG4gICAgICBpZiAoX2RhdGEubGVuZ3RoKSB7XG4gICAgICAgIF9mcmFtZSA9IHJlcXVlc3RBbmltYXRpb25GcmFtZShTdG9yZS51cGRhdGUpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgU3RvcmUuc3RvcCgpO1xuICAgICAgfVxuXG4gICAgICBwdWJsaWNpemUoKTtcbiAgICB9LFxuICAgIGFkZDogZnVuY3Rpb24gYWRkKHByb3BzKSB7XG4gICAgICBfZGF0YS5wdXNoKHByb3BzKTtcbiAgICAgIFN0b3JlLnBsYXkoKTtcbiAgICB9LFxuICAgIHJlbGVhc2U6IGZ1bmN0aW9uIHJlbGVhc2UodGltZSkge1xuICAgICAgZm9yICh2YXIgaSA9IF9kYXRhLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSB7XG4gICAgICAgIGlmICghX2RhdGFbaV0ubW91c2VVcCkge1xuICAgICAgICAgIHJldHVybiBfZGF0YVtpXS5tb3VzZVVwID0gdGltZTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfTtcblxuICByZXR1cm4gU3RvcmU7XG59O1xuXG4vKioqLyB9KSxcbi8qIDUgKi9cbi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHtcblxubW9kdWxlLmV4cG9ydHMgPSByZXF1aXJlKFwicmVhY3RcIik7XG5cbi8qKiovIH0pLFxuLyogNiAqL1xuLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXG52YXIgX2V4dGVuZHMgPSBPYmplY3QuYXNzaWduIHx8IGZ1bmN0aW9uICh0YXJnZXQpIHsgZm9yICh2YXIgaSA9IDE7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspIHsgdmFyIHNvdXJjZSA9IGFyZ3VtZW50c1tpXTsgZm9yICh2YXIga2V5IGluIHNvdXJjZSkgeyBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHNvdXJjZSwga2V5KSkgeyB0YXJnZXRba2V5XSA9IHNvdXJjZVtrZXldOyB9IH0gfSByZXR1cm4gdGFyZ2V0OyB9O1xuXG5mdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIik7IH0gfVxuXG5mdW5jdGlvbiBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybihzZWxmLCBjYWxsKSB7IGlmICghc2VsZikgeyB0aHJvdyBuZXcgUmVmZXJlbmNlRXJyb3IoXCJ0aGlzIGhhc24ndCBiZWVuIGluaXRpYWxpc2VkIC0gc3VwZXIoKSBoYXNuJ3QgYmVlbiBjYWxsZWRcIik7IH0gcmV0dXJuIGNhbGwgJiYgKHR5cGVvZiBjYWxsID09PSBcIm9iamVjdFwiIHx8IHR5cGVvZiBjYWxsID09PSBcImZ1bmN0aW9uXCIpID8gY2FsbCA6IHNlbGY7IH1cblxuZnVuY3Rpb24gX2luaGVyaXRzKHN1YkNsYXNzLCBzdXBlckNsYXNzKSB7IGlmICh0eXBlb2Ygc3VwZXJDbGFzcyAhPT0gXCJmdW5jdGlvblwiICYmIHN1cGVyQ2xhc3MgIT09IG51bGwpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIlN1cGVyIGV4cHJlc3Npb24gbXVzdCBlaXRoZXIgYmUgbnVsbCBvciBhIGZ1bmN0aW9uLCBub3QgXCIgKyB0eXBlb2Ygc3VwZXJDbGFzcyk7IH0gc3ViQ2xhc3MucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShzdXBlckNsYXNzICYmIHN1cGVyQ2xhc3MucHJvdG90eXBlLCB7IGNvbnN0cnVjdG9yOiB7IHZhbHVlOiBzdWJDbGFzcywgZW51bWVyYWJsZTogZmFsc2UsIHdyaXRhYmxlOiB0cnVlLCBjb25maWd1cmFibGU6IHRydWUgfSB9KTsgaWYgKHN1cGVyQ2xhc3MpIE9iamVjdC5zZXRQcm90b3R5cGVPZiA/IE9iamVjdC5zZXRQcm90b3R5cGVPZihzdWJDbGFzcywgc3VwZXJDbGFzcykgOiBzdWJDbGFzcy5fX3Byb3RvX18gPSBzdXBlckNsYXNzOyB9XG5cbi8qKlxuICogSW5rXG4gKiBGaWxscyBhIGNvbnRhaW5lciB3aXRoIGFuIFNWRyBvYmplY3QgdGhhdCBwcm92aWRlcyBmZWVkYmFjayBvbiBtb3VzZS90b3VjaFxuICogZXZlbnRzIHdpdGggYSByaXBwbGluZyBwb29sLlxuICovXG5cbnZhciBIQVNfVE9VQ0ggPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDIpO1xudmFyIE1PVVNFX0xFRlQgPSAwO1xudmFyIHBpeGVsUmF0aW8gPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpO1xudmFyIFJlYWN0ID0gX193ZWJwYWNrX3JlcXVpcmVfXyg1KTtcbnZhciBTVFlMRSA9IF9fd2VicGFja19yZXF1aXJlX18oMSk7XG52YXIgU3RvcmUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQpO1xudmFyIFRBVSA9IE1hdGguUEkgKiAyO1xudmFyIEVxdWF0aW9ucyA9IF9fd2VicGFja19yZXF1aXJlX18oMCk7XG5cbnZhciBJbmsgPSBmdW5jdGlvbiAoX1JlYWN0JFB1cmVDb21wb25lbnQpIHtcbiAgX2luaGVyaXRzKEluaywgX1JlYWN0JFB1cmVDb21wb25lbnQpO1xuXG4gIGZ1bmN0aW9uIEluayhwcm9wcykge1xuICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBJbmspO1xuXG4gICAgdmFyIF90aGlzID0gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4odGhpcywgX1JlYWN0JFB1cmVDb21wb25lbnQuYXBwbHkodGhpcywgYXJndW1lbnRzKSk7XG5cbiAgICBfdGhpcy50aWNrID0gZnVuY3Rpb24gKCkge1xuICAgICAgdmFyIF90aGlzJHN0YXRlID0gX3RoaXMuc3RhdGUsXG4gICAgICAgICAgY3R4ID0gX3RoaXMkc3RhdGUuY3R4LFxuICAgICAgICAgIGNvbG9yID0gX3RoaXMkc3RhdGUuY29sb3IsXG4gICAgICAgICAgZGVuc2l0eSA9IF90aGlzJHN0YXRlLmRlbnNpdHksXG4gICAgICAgICAgaGVpZ2h0ID0gX3RoaXMkc3RhdGUuaGVpZ2h0LFxuICAgICAgICAgIHdpZHRoID0gX3RoaXMkc3RhdGUud2lkdGgsXG4gICAgICAgICAgc3RvcmUgPSBfdGhpcyRzdGF0ZS5zdG9yZTtcblxuXG4gICAgICBjdHguc2F2ZSgpO1xuXG4gICAgICBjdHguc2NhbGUoZGVuc2l0eSwgZGVuc2l0eSk7XG5cbiAgICAgIGN0eC5jbGVhclJlY3QoMCwgMCwgd2lkdGgsIGhlaWdodCk7XG5cbiAgICAgIGN0eC5maWxsU3R5bGUgPSBjb2xvcjtcblxuICAgICAgaWYgKF90aGlzLnByb3BzLmJhY2tncm91bmQpIHtcbiAgICAgICAgY3R4Lmdsb2JhbEFscGhhID0gc3RvcmUuZ2V0VG90YWxPcGFjaXR5KF90aGlzLnByb3BzLm9wYWNpdHkpO1xuICAgICAgICBjdHguZmlsbFJlY3QoMCwgMCwgd2lkdGgsIGhlaWdodCk7XG4gICAgICB9XG5cbiAgICAgIHN0b3JlLmVhY2goX3RoaXMubWFrZUJsb3QsIF90aGlzKTtcblxuICAgICAgY3R4LnJlc3RvcmUoKTtcbiAgICB9O1xuXG4gICAgX3RoaXMuX2dldENlbnRlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHZhciBlbCA9IF90aGlzLmNhbnZhcztcblxuICAgICAgdmFyIF9lbCRnZXRCb3VuZGluZ0NsaWVudCA9IGVsLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLFxuICAgICAgICAgIHRvcCA9IF9lbCRnZXRCb3VuZGluZ0NsaWVudC50b3AsXG4gICAgICAgICAgYm90dG9tID0gX2VsJGdldEJvdW5kaW5nQ2xpZW50LmJvdHRvbSxcbiAgICAgICAgICBsZWZ0ID0gX2VsJGdldEJvdW5kaW5nQ2xpZW50LmxlZnQsXG4gICAgICAgICAgcmlnaHQgPSBfZWwkZ2V0Qm91bmRpbmdDbGllbnQucmlnaHQ7XG5cbiAgICAgIHJldHVybiB7XG4gICAgICAgIGNsaWVudFg6IGxlZnQgKyAocmlnaHQgLSBsZWZ0KSAvIDIsXG4gICAgICAgIGNsaWVudFk6IHRvcCArIChib3R0b20gLSB0b3ApIC8gMlxuICAgICAgfTtcbiAgICB9O1xuXG4gICAgX3RoaXMuX29uUHJlc3MgPSBmdW5jdGlvbiAoZSkge1xuICAgICAgdmFyIGNlbnRlciA9IF90aGlzLnByb3BzLmNlbnRlcjtcbiAgICAgIHZhciBidXR0b24gPSBlLmJ1dHRvbixcbiAgICAgICAgICBjdHJsS2V5ID0gZS5jdHJsS2V5LFxuICAgICAgICAgIGNsaWVudFggPSBlLmNsaWVudFgsXG4gICAgICAgICAgY2xpZW50WSA9IGUuY2xpZW50WSxcbiAgICAgICAgICBjaGFuZ2VkVG91Y2hlcyA9IGUuY2hhbmdlZFRvdWNoZXM7XG5cbiAgICAgIHZhciB0aW1lU3RhbXAgPSBEYXRlLm5vdygpO1xuXG4gICAgICBpZiAoY2hhbmdlZFRvdWNoZXMpIHtcbiAgICAgICAgaWYgKGNlbnRlcikge1xuICAgICAgICAgIHZhciBfdGhpcyRfZ2V0Q2VudGVyID0gX3RoaXMuX2dldENlbnRlcigpLFxuICAgICAgICAgICAgICBfY2xpZW50WCA9IF90aGlzJF9nZXRDZW50ZXIuY2xpZW50WCxcbiAgICAgICAgICAgICAgX2NsaWVudFkgPSBfdGhpcyRfZ2V0Q2VudGVyLmNsaWVudFk7XG5cbiAgICAgICAgICBfdGhpcy5wdXNoQmxvdCh0aW1lU3RhbXAsIF9jbGllbnRYLCBfY2xpZW50WSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjaGFuZ2VkVG91Y2hlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIF9jaGFuZ2VkVG91Y2hlcyRpID0gY2hhbmdlZFRvdWNoZXNbaV0sXG4gICAgICAgICAgICAgICAgX2NsaWVudFgyID0gX2NoYW5nZWRUb3VjaGVzJGkuY2xpZW50WCxcbiAgICAgICAgICAgICAgICBfY2xpZW50WTIgPSBfY2hhbmdlZFRvdWNoZXMkaS5jbGllbnRZO1xuXG4gICAgICAgICAgICBfdGhpcy5wdXNoQmxvdCh0aW1lU3RhbXAsIF9jbGllbnRYMiwgX2NsaWVudFkyKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSBpZiAoYnV0dG9uID09PSBNT1VTRV9MRUZUICYmICFjdHJsS2V5KSB7XG4gICAgICAgIGlmIChjZW50ZXIpIHtcbiAgICAgICAgICB2YXIgX3RoaXMkX2dldENlbnRlcjIgPSBfdGhpcy5fZ2V0Q2VudGVyKCksXG4gICAgICAgICAgICAgIF9jbGllbnRYMyA9IF90aGlzJF9nZXRDZW50ZXIyLmNsaWVudFgsXG4gICAgICAgICAgICAgIF9jbGllbnRZMyA9IF90aGlzJF9nZXRDZW50ZXIyLmNsaWVudFk7XG5cbiAgICAgICAgICBjb25zb2xlLmxvZyhfY2xpZW50WDMsIF9jbGllbnRZMyk7XG4gICAgICAgICAgX3RoaXMucHVzaEJsb3QodGltZVN0YW1wLCBfY2xpZW50WDMsIF9jbGllbnRZMyk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgX3RoaXMucHVzaEJsb3QodGltZVN0YW1wLCBjbGllbnRYLCBjbGllbnRZKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH07XG5cbiAgICBfdGhpcy5fb25SZWxlYXNlID0gZnVuY3Rpb24gKCkge1xuICAgICAgX3RoaXMuc3RhdGUuc3RvcmUucmVsZWFzZShEYXRlLm5vdygpKTtcbiAgICB9O1xuXG4gICAgX3RoaXMuc3RhdGUgPSB7XG4gICAgICBjb2xvcjogJ3RyYW5zcGFyZW50JyxcbiAgICAgIGRlbnNpdHk6IDEsXG4gICAgICBoZWlnaHQ6IDAsXG4gICAgICBzdG9yZTogU3RvcmUoX3RoaXMudGljayksXG4gICAgICB0b3VjaEV2ZW50czogX3RoaXMudG91Y2hFdmVudHMoKSxcbiAgICAgIHdpZHRoOiAwXG4gICAgfTtcbiAgICByZXR1cm4gX3RoaXM7XG4gIH1cblxuICBJbmsucHJvdG90eXBlLnRvdWNoRXZlbnRzID0gZnVuY3Rpb24gdG91Y2hFdmVudHMoKSB7XG4gICAgaWYgKHRoaXMucHJvcHMuaGFzVG91Y2gpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIG9uVG91Y2hTdGFydDogdGhpcy5fb25QcmVzcyxcbiAgICAgICAgb25Ub3VjaEVuZDogdGhpcy5fb25SZWxlYXNlLFxuICAgICAgICBvblRvdWNoQ2FuY2VsOiB0aGlzLl9vblJlbGVhc2VcbiAgICAgIH07XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIG9uTW91c2VEb3duOiB0aGlzLl9vblByZXNzLFxuICAgICAgICBvbk1vdXNlVXA6IHRoaXMuX29uUmVsZWFzZSxcbiAgICAgICAgb25Nb3VzZUxlYXZlOiB0aGlzLl9vblJlbGVhc2VcbiAgICAgIH07XG4gICAgfVxuICB9O1xuXG4gIEluay5wcm90b3R5cGUubWFrZUJsb3QgPSBmdW5jdGlvbiBtYWtlQmxvdChibG90KSB7XG4gICAgdmFyIF9zdGF0ZSA9IHRoaXMuc3RhdGUsXG4gICAgICAgIGN0eCA9IF9zdGF0ZS5jdHgsXG4gICAgICAgIGhlaWdodCA9IF9zdGF0ZS5oZWlnaHQsXG4gICAgICAgIHdpZHRoID0gX3N0YXRlLndpZHRoO1xuICAgIHZhciB4ID0gYmxvdC54LFxuICAgICAgICB5ID0gYmxvdC55LFxuICAgICAgICByYWRpdXMgPSBibG90LnJhZGl1cztcblxuXG4gICAgY3R4Lmdsb2JhbEFscGhhID0gRXF1YXRpb25zLmdldEJsb3RPcGFjaXR5KGJsb3QsIHRoaXMucHJvcHMub3BhY2l0eSk7XG4gICAgY3R4LmJlZ2luUGF0aCgpO1xuXG4gICAgaWYgKHRoaXMucHJvcHMucmVjZW50ZXIpIHtcbiAgICAgIHZhciBzaXplID0gTWF0aC5tYXgoaGVpZ2h0LCB3aWR0aCk7XG5cbiAgICAgIHggKz0gRXF1YXRpb25zLmdldEJsb3RTaGlmdFgoYmxvdCwgc2l6ZSwgd2lkdGgpO1xuICAgICAgeSArPSBFcXVhdGlvbnMuZ2V0QmxvdFNoaWZ0WShibG90LCBzaXplLCBoZWlnaHQpO1xuICAgIH1cblxuICAgIGN0eC5hcmMoeCwgeSwgcmFkaXVzICogRXF1YXRpb25zLmdldEJsb3RTY2FsZShibG90KSwgMCwgVEFVKTtcblxuICAgIGN0eC5jbG9zZVBhdGgoKTtcbiAgICBjdHguZmlsbCgpO1xuICB9O1xuXG4gIEluay5wcm90b3R5cGUuY29tcG9uZW50V2lsbFVubW91bnQgPSBmdW5jdGlvbiBjb21wb25lbnRXaWxsVW5tb3VudCgpIHtcbiAgICB0aGlzLnN0YXRlLnN0b3JlLnN0b3AoKTtcbiAgfTtcblxuICBJbmsucHJvdG90eXBlLnB1c2hCbG90ID0gZnVuY3Rpb24gcHVzaEJsb3QodGltZVN0YW1wLCBjbGllbnRYLCBjbGllbnRZKSB7XG4gICAgdmFyIF90aGlzMiA9IHRoaXM7XG5cbiAgICB2YXIgZWwgPSB0aGlzLmNhbnZhcztcblxuICAgIC8vIDAuMTMgc3VwcG9ydFxuICAgIGlmIChlbCBpbnN0YW5jZW9mIHdpbmRvdy5IVE1MQ2FudmFzRWxlbWVudCA9PT0gZmFsc2UpIHtcbiAgICAgIGVsID0gZWwuZ2V0RE9NTm9kZSgpO1xuICAgIH1cblxuICAgIHZhciBfZWwkZ2V0Qm91bmRpbmdDbGllbnQyID0gZWwuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCksXG4gICAgICAgIHRvcCA9IF9lbCRnZXRCb3VuZGluZ0NsaWVudDIudG9wLFxuICAgICAgICBib3R0b20gPSBfZWwkZ2V0Qm91bmRpbmdDbGllbnQyLmJvdHRvbSxcbiAgICAgICAgbGVmdCA9IF9lbCRnZXRCb3VuZGluZ0NsaWVudDIubGVmdCxcbiAgICAgICAgcmlnaHQgPSBfZWwkZ2V0Qm91bmRpbmdDbGllbnQyLnJpZ2h0O1xuXG4gICAgdmFyIF93aW5kb3ckZ2V0Q29tcHV0ZWRTdCA9IHdpbmRvdy5nZXRDb21wdXRlZFN0eWxlKGVsKSxcbiAgICAgICAgY29sb3IgPSBfd2luZG93JGdldENvbXB1dGVkU3QuY29sb3I7XG5cbiAgICB2YXIgY3R4ID0gdGhpcy5zdGF0ZS5jdHggfHwgZWwuZ2V0Q29udGV4dCgnMmQnKTtcbiAgICB2YXIgZGVuc2l0eSA9IHBpeGVsUmF0aW8oY3R4KTtcbiAgICB2YXIgaGVpZ2h0ID0gYm90dG9tIC0gdG9wO1xuICAgIHZhciB3aWR0aCA9IHJpZ2h0IC0gbGVmdDtcbiAgICB2YXIgcmFkaXVzID0gRXF1YXRpb25zLmdldE1heFJhZGl1cyhoZWlnaHQsIHdpZHRoLCB0aGlzLnByb3BzLnJhZGl1cyk7XG5cbiAgICB0aGlzLnNldFN0YXRlKHsgY29sb3I6IGNvbG9yLCBjdHg6IGN0eCwgZGVuc2l0eTogZGVuc2l0eSwgaGVpZ2h0OiBoZWlnaHQsIHdpZHRoOiB3aWR0aCB9LCBmdW5jdGlvbiAoKSB7XG4gICAgICBfdGhpczIuc3RhdGUuc3RvcmUuYWRkKHtcbiAgICAgICAgZHVyYXRpb246IF90aGlzMi5wcm9wcy5kdXJhdGlvbixcbiAgICAgICAgbW91c2VEb3duOiB0aW1lU3RhbXAsXG4gICAgICAgIG1vdXNlVXA6IDAsXG4gICAgICAgIHJhZGl1czogcmFkaXVzLFxuICAgICAgICB4OiBjbGllbnRYIC0gbGVmdCxcbiAgICAgICAgeTogY2xpZW50WSAtIHRvcFxuICAgICAgfSk7XG4gICAgfSk7XG4gIH07XG5cbiAgSW5rLnByb3RvdHlwZS5yZW5kZXIgPSBmdW5jdGlvbiByZW5kZXIoKSB7XG4gICAgdmFyIF90aGlzMyA9IHRoaXM7XG5cbiAgICB2YXIgX3N0YXRlMiA9IHRoaXMuc3RhdGUsXG4gICAgICAgIGRlbnNpdHkgPSBfc3RhdGUyLmRlbnNpdHksXG4gICAgICAgIGhlaWdodCA9IF9zdGF0ZTIuaGVpZ2h0LFxuICAgICAgICB3aWR0aCA9IF9zdGF0ZTIud2lkdGgsXG4gICAgICAgIHRvdWNoRXZlbnRzID0gX3N0YXRlMi50b3VjaEV2ZW50cztcblxuXG4gICAgcmV0dXJuIFJlYWN0LmNyZWF0ZUVsZW1lbnQoJ2NhbnZhcycsIF9leHRlbmRzKHsgY2xhc3NOYW1lOiAnaW5rJyxcbiAgICAgIHJlZjogZnVuY3Rpb24gcmVmKGVsKSB7XG4gICAgICAgIHJldHVybiBfdGhpczMuY2FudmFzID0gZWw7XG4gICAgICB9LFxuICAgICAgc3R5bGU6IF9leHRlbmRzKHt9LCBTVFlMRSwgdGhpcy5wcm9wcy5zdHlsZSksXG4gICAgICBoZWlnaHQ6IGhlaWdodCAqIGRlbnNpdHksXG4gICAgICB3aWR0aDogd2lkdGggKiBkZW5zaXR5LFxuICAgICAgb25EcmFnT3ZlcjogdGhpcy5fb25SZWxlYXNlXG4gICAgfSwgdG91Y2hFdmVudHMpKTtcbiAgfTtcblxuICByZXR1cm4gSW5rO1xufShSZWFjdC5QdXJlQ29tcG9uZW50KTtcblxuSW5rLmRlZmF1bHRQcm9wcyA9IHtcbiAgYmFja2dyb3VuZDogdHJ1ZSxcbiAgZHVyYXRpb246IDEwMDAsXG4gIG9wYWNpdHk6IDAuMjUsXG4gIHJhZGl1czogMTUwLFxuICByZWNlbnRlcjogdHJ1ZSxcbiAgaGFzVG91Y2g6IEhBU19UT1VDSCxcbiAgY2VudGVyOiBmYWxzZVxufTtcblxuXG5tb2R1bGUuZXhwb3J0cyA9IEluaztcblxuLyoqKi8gfSksXG4vKiA3ICovXG4vKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7XG5cbi8qKlxuICogQHQgaXMgdGhlIGN1cnJlbnQgdGltZSAob3IgcG9zaXRpb24pIG9mIHRoZSB0d2Vlbi4gVGhpcyBjYW4gYmUgc2Vjb25kcyBvciBmcmFtZXMsIHN0ZXBzLCBzZWNvbmRzLCBtcywgd2hhdGV2ZXIg4oCTIGFzIGxvbmcgYXMgdGhlIHVuaXQgaXMgdGhlIHNhbWUgYXMgaXMgdXNlZCBmb3IgdGhlIHRvdGFsIHRpbWUgWzNdLlxuICogQGIgaXMgdGhlIGJlZ2lubmluZyB2YWx1ZSBvZiB0aGUgcHJvcGVydHkuXG4gKiBAYyBpcyB0aGUgY2hhbmdlIGJldHdlZW4gdGhlIGJlZ2lubmluZyBhbmQgZGVzdGluYXRpb24gdmFsdWUgb2YgdGhlIHByb3BlcnR5LlxuICogQGQgaXMgdGhlIHRvdGFsIHRpbWUgb2YgdGhlIHR3ZWVuLlxuICovXG5cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gZWFzZU91dFF1aW50KHQsIGIsIGMsIGQpIHtcbiAgcmV0dXJuIGMgKiAoKHQgPSB0IC8gZCAtIDEpICogdCAqIHQgKiB0ICogdCArIDEpICsgYjtcbn07XG5cbi8qKiovIH0pXG4vKioqKioqLyBdKTtcblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gaW5rLmpzIiwiIFx0Ly8gVGhlIG1vZHVsZSBjYWNoZVxuIFx0dmFyIGluc3RhbGxlZE1vZHVsZXMgPSB7fTtcblxuIFx0Ly8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbiBcdGZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblxuIFx0XHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcbiBcdFx0aWYoaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0pIHtcbiBcdFx0XHRyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0cztcbiBcdFx0fVxuIFx0XHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuIFx0XHR2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7XG4gXHRcdFx0aTogbW9kdWxlSWQsXG4gXHRcdFx0bDogZmFsc2UsXG4gXHRcdFx0ZXhwb3J0czoge31cbiBcdFx0fTtcblxuIFx0XHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cbiBcdFx0bW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cbiBcdFx0Ly8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZFxuIFx0XHRtb2R1bGUubCA9IHRydWU7XG5cbiBcdFx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcbiBcdFx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xuIFx0fVxuXG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzO1xuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZSBjYWNoZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5jID0gaW5zdGFsbGVkTW9kdWxlcztcblxuIFx0Ly8gaWRlbnRpdHkgZnVuY3Rpb24gZm9yIGNhbGxpbmcgaGFybW9ueSBpbXBvcnRzIHdpdGggdGhlIGNvcnJlY3QgY29udGV4dFxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5pID0gZnVuY3Rpb24odmFsdWUpIHsgcmV0dXJuIHZhbHVlOyB9O1xuXG4gXHQvLyBkZWZpbmUgZ2V0dGVyIGZ1bmN0aW9uIGZvciBoYXJtb255IGV4cG9ydHNcbiBcdF9fd2VicGFja19yZXF1aXJlX18uZCA9IGZ1bmN0aW9uKGV4cG9ydHMsIG5hbWUsIGdldHRlcikge1xuIFx0XHRpZighX193ZWJwYWNrX3JlcXVpcmVfXy5vKGV4cG9ydHMsIG5hbWUpKSB7XG4gXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIG5hbWUsIHtcbiBcdFx0XHRcdGNvbmZpZ3VyYWJsZTogZmFsc2UsXG4gXHRcdFx0XHRlbnVtZXJhYmxlOiB0cnVlLFxuIFx0XHRcdFx0Z2V0OiBnZXR0ZXJcbiBcdFx0XHR9KTtcbiBcdFx0fVxuIFx0fTtcblxuIFx0Ly8gZ2V0RGVmYXVsdEV4cG9ydCBmdW5jdGlvbiBmb3IgY29tcGF0aWJpbGl0eSB3aXRoIG5vbi1oYXJtb255IG1vZHVsZXNcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubiA9IGZ1bmN0aW9uKG1vZHVsZSkge1xuIFx0XHR2YXIgZ2V0dGVyID0gbW9kdWxlICYmIG1vZHVsZS5fX2VzTW9kdWxlID9cbiBcdFx0XHRmdW5jdGlvbiBnZXREZWZhdWx0KCkgeyByZXR1cm4gbW9kdWxlWydkZWZhdWx0J107IH0gOlxuIFx0XHRcdGZ1bmN0aW9uIGdldE1vZHVsZUV4cG9ydHMoKSB7IHJldHVybiBtb2R1bGU7IH07XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18uZChnZXR0ZXIsICdhJywgZ2V0dGVyKTtcbiBcdFx0cmV0dXJuIGdldHRlcjtcbiBcdH07XG5cbiBcdC8vIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbFxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5vID0gZnVuY3Rpb24ob2JqZWN0LCBwcm9wZXJ0eSkgeyByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iamVjdCwgcHJvcGVydHkpOyB9O1xuXG4gXHQvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfX1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjtcblxuIFx0Ly8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG4gXHRyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXyhfX3dlYnBhY2tfcmVxdWlyZV9fLnMgPSA2KTtcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyB3ZWJwYWNrL2Jvb3RzdHJhcCA5NTBkYjY2OGIyMDVmMGNlYjYwZSIsImxldCBlYXNpbmcgPSByZXF1aXJlKCcuL2Vhc2luZycpXG5sZXQgU1FSVF8yID0gTWF0aC5zcXJ0KDIpXG5sZXQgeyBjb3MsIG1heCwgbWluIH0gPSBNYXRoXG5cbmZ1bmN0aW9uIGdldFByZXNzKGJsb3QpIHtcbiAgcmV0dXJuIG1pbihibG90LmR1cmF0aW9uLCBEYXRlLm5vdygpIC0gYmxvdC5tb3VzZURvd24pXG59XG5cbmZ1bmN0aW9uIGdldFJlbGVhc2UoYmxvdCkge1xuICByZXR1cm4gYmxvdC5tb3VzZVVwID4gMCA/IERhdGUubm93KCkgLSBibG90Lm1vdXNlVXAgOiAwXG59XG5cbmZ1bmN0aW9uIGdldFJhZGl1cyhibG90KSB7XG4gIGxldCB7IGR1cmF0aW9uLCByYWRpdXMgfSA9IGJsb3RcblxuICBsZXQgZG93biAgICAgICA9IGVhc2luZyhnZXRQcmVzcyhibG90KSwgMCwgcmFkaXVzLCBkdXJhdGlvbikgKiAwLjg1XG4gIGxldCB1cCAgICAgICAgID0gZWFzaW5nKGdldFJlbGVhc2UoYmxvdCksIDAsIHJhZGl1cywgZHVyYXRpb24pICogMC4xNVxuICBsZXQgdW5kdWxhdGlvbiA9IHJhZGl1cyAqIDAuMDIgKiBjb3MoRGF0ZS5ub3coKSAvIGR1cmF0aW9uKVxuXG4gIHJldHVybiBtYXgoMCwgZG93biArIHVwICsgdW5kdWxhdGlvbilcbn1cblxubW9kdWxlLmV4cG9ydHMgPSB7XG5cbiAgZ2V0TWF4UmFkaXVzKGhlaWdodCwgd2lkdGgsIHJhZGl1cykge1xuICAgIHJldHVybiBtaW4obWF4KGhlaWdodCwgd2lkdGgpICogMC41LCByYWRpdXMpXG4gIH0sXG5cbiAgZ2V0QmxvdE9wYWNpdHkoYmxvdCwgb3BhY2l0eSkge1xuICAgIHJldHVybiBlYXNpbmcoZ2V0UmVsZWFzZShibG90KSwgb3BhY2l0eSwgLW9wYWNpdHksIGJsb3QuZHVyYXRpb24pXG4gIH0sXG5cbiAgZ2V0QmxvdE91dGVyT3BhY2l0eShibG90LCBvcGFjaXR5KSB7XG4gICAgcmV0dXJuIG1pbih0aGlzLmdldEJsb3RPcGFjaXR5KGJsb3QsIG9wYWNpdHkpLFxuICAgICAgICAgICAgICAgZWFzaW5nKGdldFByZXNzKGJsb3QpLCAwLCAwLjMsIGJsb3QuZHVyYXRpb24gKiAzKSlcbiAgfSxcblxuICBnZXRCbG90U2hpZnRYKGJsb3QsIHNpemUsIHdpZHRoKSB7XG4gICAgcmV0dXJuIG1pbigxLFxuICAgICAgICAgICAgICAgZ2V0UmFkaXVzKGJsb3QpIC8gc2l6ZSAqIDIgLyBTUVJUXzIpICogKHdpZHRoIC8gMiAtIGJsb3QueClcbiAgfSxcblxuICBnZXRCbG90U2hpZnRZKGJsb3QsIHNpemUsIGhlaWdodCkge1xuICAgIHJldHVybiBtaW4oMSxcbiAgICAgICAgICAgICAgIGdldFJhZGl1cyhibG90KSAvIHNpemUgKiAyIC8gU1FSVF8yKSAqIChoZWlnaHQgLyAyIC0gYmxvdC55KVxuICB9LFxuXG4gIGdldEJsb3RTY2FsZShibG90KSB7XG4gICAgcmV0dXJuIGdldFJhZGl1cyhibG90KSAvIGJsb3QucmFkaXVzXG4gIH1cbn1cblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL3NyYy91dGlsL2VxdWF0aW9ucy5qcyIsIm1vZHVsZS5leHBvcnRzID0ge1xuICBib3JkZXJSYWRpdXM6ICdpbmhlcml0JyxcbiAgaGVpZ2h0OiAnMTAwJScsXG4gIGxlZnQ6IDAsXG4gIHBvc2l0aW9uOiAnYWJzb2x1dGUnLFxuICB0b3A6IDAsXG4gIHdpZHRoOiAnMTAwJSdcbn1cblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL3NyYy9zdHlsZS5qcyIsInZhciBib29sID0gZmFsc2VcblxuaWYgKHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnKSB7XG4gIGJvb2wgPSAoJ29udG91Y2hzdGFydCcgaW4gd2luZG93KSB8fCB3aW5kb3cuRG9jdW1lbnRUb3VjaCAmJiBkb2N1bWVudCBpbnN0YW5jZW9mIHdpbmRvdy5Eb2N1bWVudFRvdWNoXG59XG5cbm1vZHVsZS5leHBvcnRzID0gYm9vbFxuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3JjL3V0aWwvaGFzVG91Y2guanMiLCIvLyBHb29kIHN0dWZmIGhlcmU6XG4vLyBodHRwOi8vd3d3Lmh0bWw1cm9ja3MuY29tL2VuL3R1dG9yaWFscy9jYW52YXMvaGlkcGkvXG5cbm1vZHVsZS5leHBvcnRzID0gY29udGV4dCA9PiB7XG4gIGxldCBkZXZpY2VQaXhlbFJhdGlvICA9IHdpbmRvdy5kZXZpY2VQaXhlbFJhdGlvIHx8IDFcbiAgbGV0IGJhY2tpbmdTdG9yZVJhdGlvID0gY29udGV4dC53ZWJraXRCYWNraW5nU3RvcmVQaXhlbFJhdGlvIHx8XG4gICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRleHQubW96QmFja2luZ1N0b3JlUGl4ZWxSYXRpbyAgICB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZXh0Lm1zQmFja2luZ1N0b3JlUGl4ZWxSYXRpbyAgICAgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGV4dC5vQmFja2luZ1N0b3JlUGl4ZWxSYXRpbyAgICAgIHx8XG4gICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRleHQuYmFja2luZ1N0b3JlUGl4ZWxSYXRpbyAgICAgICB8fCAxXG5cbiAgcmV0dXJuIGRldmljZVBpeGVsUmF0aW8gLyBiYWNraW5nU3RvcmVSYXRpb1xufVxuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3JjL3V0aWwvcGl4ZWxSYXRpby5qcyIsIi8qKlxuICogSW5rIFN0b3JlXG4gKiBLZWVwcyB0cmFjayBvZiBjaGFuZ2VzIHRvIHJpcHBsZSBlcGljZW50ZXJzXG4gKiBzbyB0aGF0IDxJbmsgLz4gY2FuIGZvY3VzIG9uIHJlbmRlcmluZyB0aGVtLlxuICovXG5cbnZhciBFcXVhdGlvbnMgPSByZXF1aXJlKCcuL2VxdWF0aW9ucycpXG5cbmxldCBraWxsU3RhbGUgPSAoeyBtb3VzZVVwLCBkdXJhdGlvbiB9KSA9PiAhbW91c2VVcCB8fCAoRGF0ZS5ub3coKSAtIG1vdXNlVXApIDwgZHVyYXRpb25cblxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihwdWJsaWNpemUpIHtcbiAgbGV0IF9kYXRhICAgID0gW11cbiAgbGV0IF9wbGF5aW5nID0gZmFsc2VcbiAgbGV0IF9mcmFtZVxuXG4gIGxldCBTdG9yZSA9IHtcblxuICAgIGVhY2goY2FsbGJhY2ssIHNjb3BlKSB7XG4gICAgICBmb3IgKHZhciBpID0gMCwgbCA9IF9kYXRhLmxlbmd0aDsgaSA8IGw7IGkrKykge1xuICAgICAgICBjYWxsYmFjay5jYWxsKHNjb3BlLCBfZGF0YVtpXSlcbiAgICAgIH1cbiAgICB9LFxuXG4gICAgcGxheSgpIHtcbiAgICAgIGlmICghX3BsYXlpbmcpIHtcbiAgICAgICAgX3BsYXlpbmcgPSB0cnVlXG4gICAgICAgIFN0b3JlLnVwZGF0ZSgpXG4gICAgICB9XG4gICAgfSxcblxuICAgIHN0b3AoKSB7XG4gICAgICBfcGxheWluZyA9IGZhbHNlXG4gICAgICBjYW5jZWxBbmltYXRpb25GcmFtZShfZnJhbWUpXG4gICAgfSxcblxuICAgIGdldFRvdGFsT3BhY2l0eShvcGFjaXR5KSB7XG4gICAgICBsZXQgYW5zd2VyID0gMFxuXG4gICAgICBmb3IgKHZhciBpID0gMCwgbCA9IF9kYXRhLmxlbmd0aDsgaSA8IGw7IGkrKykge1xuICAgICAgICBhbnN3ZXIgKz0gRXF1YXRpb25zLmdldEJsb3RPdXRlck9wYWNpdHkoX2RhdGFbaV0sIG9wYWNpdHkpXG4gICAgICB9XG5cbiAgICAgIHJldHVybiBhbnN3ZXJcbiAgICB9LFxuXG4gICAgdXBkYXRlKCkge1xuICAgICAgX2RhdGEgPSBfZGF0YS5maWx0ZXIoa2lsbFN0YWxlKVxuXG4gICAgICBpZiAoX2RhdGEubGVuZ3RoKSB7XG4gICAgICAgIF9mcmFtZSA9IHJlcXVlc3RBbmltYXRpb25GcmFtZShTdG9yZS51cGRhdGUpXG4gICAgICB9IGVsc2Uge1xuICAgICAgICBTdG9yZS5zdG9wKClcbiAgICAgIH1cblxuICAgICAgcHVibGljaXplKClcbiAgICB9LFxuXG4gICAgYWRkKHByb3BzKSB7XG4gICAgICBfZGF0YS5wdXNoKHByb3BzKVxuICAgICAgU3RvcmUucGxheSgpXG4gICAgfSxcblxuICAgIHJlbGVhc2UodGltZSkge1xuICAgICAgZm9yIChsZXQgaSA9IF9kYXRhLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSB7XG4gICAgICAgIGlmICghX2RhdGFbaV0ubW91c2VVcCkge1xuICAgICAgICAgIHJldHVybiBfZGF0YVtpXS5tb3VzZVVwID0gdGltZVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gIH1cblxuICByZXR1cm4gU3RvcmVcbn1cblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL3NyYy91dGlsL3N0b3JlLmpzIiwibW9kdWxlLmV4cG9ydHMgPSByZXF1aXJlKFwicmVhY3RcIik7XG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gZXh0ZXJuYWwgXCJyZWFjdFwiXG4vLyBtb2R1bGUgaWQgPSA1XG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsIi8qKlxuICogSW5rXG4gKiBGaWxscyBhIGNvbnRhaW5lciB3aXRoIGFuIFNWRyBvYmplY3QgdGhhdCBwcm92aWRlcyBmZWVkYmFjayBvbiBtb3VzZS90b3VjaFxuICogZXZlbnRzIHdpdGggYSByaXBwbGluZyBwb29sLlxuICovXG5cbmxldCBIQVNfVE9VQ0ggID0gcmVxdWlyZSgnLi91dGlsL2hhc1RvdWNoJylcbmxldCBNT1VTRV9MRUZUID0gMFxubGV0IHBpeGVsUmF0aW8gPSByZXF1aXJlKCcuL3V0aWwvcGl4ZWxSYXRpbycpXG5sZXQgUmVhY3QgICAgICA9IHJlcXVpcmUoJ3JlYWN0JylcbmxldCBTVFlMRSAgICAgID0gcmVxdWlyZSgnLi9zdHlsZScpXG5sZXQgU3RvcmUgICAgICA9IHJlcXVpcmUoJy4vdXRpbC9zdG9yZScpXG5sZXQgVEFVICAgICAgICA9IE1hdGguUEkgKiAyXG5sZXQgRXF1YXRpb25zICA9IHJlcXVpcmUoJy4vdXRpbC9lcXVhdGlvbnMnKVxuXG5jbGFzcyBJbmsgZXh0ZW5kcyBSZWFjdC5QdXJlQ29tcG9uZW50IHtcblxuICBzdGF0aWMgZGVmYXVsdFByb3BzID0ge1xuICAgIGJhY2tncm91bmQgOiB0cnVlLFxuICAgIGR1cmF0aW9uICAgOiAxMDAwLFxuICAgIG9wYWNpdHkgICAgOiAwLjI1LFxuICAgIHJhZGl1cyAgICAgOiAxNTAsXG4gICAgcmVjZW50ZXIgICA6IHRydWUsXG4gICAgaGFzVG91Y2ggICA6IEhBU19UT1VDSCxcbiAgICBjZW50ZXIgICAgIDogZmFsc2UsXG4gIH1cblxuICBjb25zdHJ1Y3RvciAocHJvcHMpIHtcbiAgICBzdXBlciguLi5hcmd1bWVudHMpXG5cbiAgICB0aGlzLnN0YXRlID0ge1xuICAgICAgY29sb3IgICAgICAgOiAndHJhbnNwYXJlbnQnLFxuICAgICAgZGVuc2l0eSAgICAgOiAxLFxuICAgICAgaGVpZ2h0ICAgICAgOiAwLFxuICAgICAgc3RvcmUgICAgICAgOiBTdG9yZSh0aGlzLnRpY2spLFxuICAgICAgdG91Y2hFdmVudHMgOiB0aGlzLnRvdWNoRXZlbnRzKCksXG4gICAgICB3aWR0aCAgICAgICA6IDBcbiAgICB9XG4gIH1cblxuICB0b3VjaEV2ZW50cyAoKSB7XG4gICAgaWYgKHRoaXMucHJvcHMuaGFzVG91Y2gpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIG9uVG91Y2hTdGFydCAgOiB0aGlzLl9vblByZXNzLFxuICAgICAgICBvblRvdWNoRW5kICAgIDogdGhpcy5fb25SZWxlYXNlLFxuICAgICAgICBvblRvdWNoQ2FuY2VsIDogdGhpcy5fb25SZWxlYXNlXG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIG9uTW91c2VEb3duICAgOiB0aGlzLl9vblByZXNzLFxuICAgICAgICBvbk1vdXNlVXAgICAgIDogdGhpcy5fb25SZWxlYXNlLFxuICAgICAgICBvbk1vdXNlTGVhdmUgIDogdGhpcy5fb25SZWxlYXNlXG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgdGljayA9ICgpID0+IHtcbiAgICBsZXQgeyBjdHgsIGNvbG9yLCBkZW5zaXR5LCBoZWlnaHQsIHdpZHRoLCBzdG9yZSB9ID0gdGhpcy5zdGF0ZVxuXG4gICAgY3R4LnNhdmUoKVxuXG4gICAgY3R4LnNjYWxlKGRlbnNpdHksIGRlbnNpdHkpXG5cbiAgICBjdHguY2xlYXJSZWN0KDAsIDAsIHdpZHRoLCBoZWlnaHQpXG5cbiAgICBjdHguZmlsbFN0eWxlID0gY29sb3JcblxuICAgIGlmICh0aGlzLnByb3BzLmJhY2tncm91bmQpIHtcbiAgICAgIGN0eC5nbG9iYWxBbHBoYSA9IHN0b3JlLmdldFRvdGFsT3BhY2l0eSh0aGlzLnByb3BzLm9wYWNpdHkpXG4gICAgICBjdHguZmlsbFJlY3QoMCwgMCwgd2lkdGgsIGhlaWdodClcbiAgICB9XG5cbiAgICBzdG9yZS5lYWNoKHRoaXMubWFrZUJsb3QsIHRoaXMpXG5cbiAgICBjdHgucmVzdG9yZSgpXG4gIH1cblxuICBtYWtlQmxvdCAoYmxvdCkge1xuICAgIGxldCB7IGN0eCwgaGVpZ2h0LCB3aWR0aCB9ID0gdGhpcy5zdGF0ZVxuICAgIGxldCB7IHgsIHksIHJhZGl1cyB9ID0gYmxvdFxuXG4gICAgY3R4Lmdsb2JhbEFscGhhID0gRXF1YXRpb25zLmdldEJsb3RPcGFjaXR5KGJsb3QsIHRoaXMucHJvcHMub3BhY2l0eSlcbiAgICBjdHguYmVnaW5QYXRoKClcblxuICAgIGlmICh0aGlzLnByb3BzLnJlY2VudGVyKSB7XG4gICAgICBsZXQgc2l6ZSA9IE1hdGgubWF4KGhlaWdodCwgd2lkdGgpXG5cbiAgICAgIHggKz0gRXF1YXRpb25zLmdldEJsb3RTaGlmdFgoYmxvdCwgc2l6ZSwgd2lkdGgpXG4gICAgICB5ICs9IEVxdWF0aW9ucy5nZXRCbG90U2hpZnRZKGJsb3QsIHNpemUsIGhlaWdodClcbiAgICB9XG5cbiAgICBjdHguYXJjKHgsIHksIHJhZGl1cyAqIEVxdWF0aW9ucy5nZXRCbG90U2NhbGUoYmxvdCksIDAsIFRBVSlcblxuICAgIGN0eC5jbG9zZVBhdGgoKVxuICAgIGN0eC5maWxsKClcbiAgfVxuXG4gIGNvbXBvbmVudFdpbGxVbm1vdW50ICgpIHtcbiAgICB0aGlzLnN0YXRlLnN0b3JlLnN0b3AoKVxuICB9XG5cbiAgcHVzaEJsb3QgKHRpbWVTdGFtcCwgY2xpZW50WCwgY2xpZW50WSkge1xuICAgIGxldCBlbCA9IHRoaXMuY2FudmFzXG5cbiAgICAvLyAwLjEzIHN1cHBvcnRcbiAgICBpZiAoZWwgaW5zdGFuY2VvZiB3aW5kb3cuSFRNTENhbnZhc0VsZW1lbnQgPT09IGZhbHNlKSB7XG4gICAgICBlbCA9IGVsLmdldERPTU5vZGUoKVxuICAgIH1cblxuICAgIGxldCB7IHRvcCwgYm90dG9tLCBsZWZ0LCByaWdodCB9ID0gZWwuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KClcbiAgICBsZXQgeyBjb2xvciB9ID0gd2luZG93LmdldENvbXB1dGVkU3R5bGUoZWwpXG5cbiAgICBsZXQgY3R4ICAgICA9IHRoaXMuc3RhdGUuY3R4IHx8IGVsLmdldENvbnRleHQoJzJkJylcbiAgICBsZXQgZGVuc2l0eSA9IHBpeGVsUmF0aW8oY3R4KVxuICAgIGxldCBoZWlnaHQgID0gYm90dG9tIC0gdG9wXG4gICAgbGV0IHdpZHRoICAgPSByaWdodCAtIGxlZnRcbiAgICBsZXQgcmFkaXVzICA9IEVxdWF0aW9ucy5nZXRNYXhSYWRpdXMoaGVpZ2h0LCB3aWR0aCwgdGhpcy5wcm9wcy5yYWRpdXMpXG5cbiAgICB0aGlzLnNldFN0YXRlKHsgY29sb3IsIGN0eCwgZGVuc2l0eSwgaGVpZ2h0LCB3aWR0aCB9LCAoKSA9PiB7XG4gICAgICB0aGlzLnN0YXRlLnN0b3JlLmFkZCh7XG4gICAgICAgIGR1cmF0aW9uICA6IHRoaXMucHJvcHMuZHVyYXRpb24sXG4gICAgICAgIG1vdXNlRG93biA6IHRpbWVTdGFtcCxcbiAgICAgICAgbW91c2VVcCAgIDogMCxcbiAgICAgICAgcmFkaXVzICAgIDogcmFkaXVzLFxuICAgICAgICB4ICAgICAgICAgOiBjbGllbnRYIC0gbGVmdCxcbiAgICAgICAgeSAgICAgICAgIDogY2xpZW50WSAtIHRvcFxuICAgICAgfSlcbiAgICB9KVxuICB9XG5cbiAgcmVuZGVyICgpIHtcbiAgICBsZXQgeyBkZW5zaXR5LCBoZWlnaHQsIHdpZHRoLCB0b3VjaEV2ZW50cyB9ID0gdGhpcy5zdGF0ZVxuXG4gICAgcmV0dXJuIChcbiAgICAgIDxjYW52YXMgY2xhc3NOYW1lPVwiaW5rXCJcbiAgICAgICAgICAgICAgcmVmPXtlbCA9PiB0aGlzLmNhbnZhcyA9IGVsfVxuICAgICAgICAgICAgICBzdHlsZT17eyAuLi5TVFlMRSwgLi4udGhpcy5wcm9wcy5zdHlsZSB9fVxuICAgICAgICAgICAgICBoZWlnaHQ9eyBoZWlnaHQgKiBkZW5zaXR5IH1cbiAgICAgICAgICAgICAgd2lkdGg9eyB3aWR0aCAqIGRlbnNpdHkgfVxuICAgICAgICAgICAgICBvbkRyYWdPdmVyPXsgdGhpcy5fb25SZWxlYXNlIH1cbiAgICAgICAgICAgICAgeyAuLi50b3VjaEV2ZW50cyB9IC8+XG4gICAgKVxuICB9XG5cbiAgX2dldENlbnRlciA9ICgpID0+IHtcbiAgICBsZXQgZWwgPSB0aGlzLmNhbnZhc1xuICAgIGxldCB7IHRvcCwgYm90dG9tLCBsZWZ0LCByaWdodCB9ID0gZWwuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KClcblxuICAgIHJldHVybiB7XG4gICAgICBjbGllbnRYOiBsZWZ0ICsgKHJpZ2h0IC0gbGVmdCkgLyAyLFxuICAgICAgY2xpZW50WTogdG9wICsgKGJvdHRvbSAtIHRvcCkgLyAyLFxuICAgIH1cbiAgfVxuXG4gIF9vblByZXNzID0gKGUpID0+IHtcbiAgICBsZXQgeyBjZW50ZXIgfSA9IHRoaXMucHJvcHNcbiAgICBsZXQgeyBidXR0b24sIGN0cmxLZXksIGNsaWVudFgsIGNsaWVudFksIGNoYW5nZWRUb3VjaGVzIH0gPSBlXG4gICAgbGV0IHRpbWVTdGFtcCA9IERhdGUubm93KClcblxuICAgIGlmIChjaGFuZ2VkVG91Y2hlcykge1xuICAgICAgaWYgKGNlbnRlcikge1xuICAgICAgICBsZXQgeyBjbGllbnRYLCBjbGllbnRZIH0gPSB0aGlzLl9nZXRDZW50ZXIoKVxuICAgICAgICB0aGlzLnB1c2hCbG90KHRpbWVTdGFtcCwgY2xpZW50WCwgY2xpZW50WSlcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY2hhbmdlZFRvdWNoZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICBsZXQgeyBjbGllbnRYLCBjbGllbnRZIH0gPSBjaGFuZ2VkVG91Y2hlc1tpXVxuICAgICAgICAgIHRoaXMucHVzaEJsb3QodGltZVN0YW1wLCBjbGllbnRYLCBjbGllbnRZKVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfSBlbHNlIGlmIChidXR0b24gPT09IE1PVVNFX0xFRlQgJiYgIWN0cmxLZXkpIHtcbiAgICAgIGlmIChjZW50ZXIpIHtcbiAgICAgICAgbGV0IHsgY2xpZW50WCwgY2xpZW50WSB9ID0gdGhpcy5fZ2V0Q2VudGVyKClcbiAgICAgICAgY29uc29sZS5sb2coY2xpZW50WCwgY2xpZW50WSlcbiAgICAgICAgdGhpcy5wdXNoQmxvdCh0aW1lU3RhbXAsIGNsaWVudFgsIGNsaWVudFkpXG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLnB1c2hCbG90KHRpbWVTdGFtcCwgY2xpZW50WCwgY2xpZW50WSlcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBfb25SZWxlYXNlID0gKCkgPT4ge1xuICAgIHRoaXMuc3RhdGUuc3RvcmUucmVsZWFzZShEYXRlLm5vdygpKVxuICB9XG5cbn1cblxubW9kdWxlLmV4cG9ydHMgPSBJbmtcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL3NyYy9pbmRleC5qcyIsIi8qKlxuICogQHQgaXMgdGhlIGN1cnJlbnQgdGltZSAob3IgcG9zaXRpb24pIG9mIHRoZSB0d2Vlbi4gVGhpcyBjYW4gYmUgc2Vjb25kcyBvciBmcmFtZXMsIHN0ZXBzLCBzZWNvbmRzLCBtcywgd2hhdGV2ZXIg4oCTIGFzIGxvbmcgYXMgdGhlIHVuaXQgaXMgdGhlIHNhbWUgYXMgaXMgdXNlZCBmb3IgdGhlIHRvdGFsIHRpbWUgWzNdLlxuICogQGIgaXMgdGhlIGJlZ2lubmluZyB2YWx1ZSBvZiB0aGUgcHJvcGVydHkuXG4gKiBAYyBpcyB0aGUgY2hhbmdlIGJldHdlZW4gdGhlIGJlZ2lubmluZyBhbmQgZGVzdGluYXRpb24gdmFsdWUgb2YgdGhlIHByb3BlcnR5LlxuICogQGQgaXMgdGhlIHRvdGFsIHRpbWUgb2YgdGhlIHR3ZWVuLlxuICovXG5cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gZWFzZU91dFF1aW50ICh0LCBiLCBjLCBkKSB7XG4gIHJldHVybiBjKigodD10L2QtMSkqdCp0KnQqdCArIDEpICsgYlxufVxuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3JjL3V0aWwvZWFzaW5nLmpzIl0sInNvdXJjZVJvb3QiOiIifQ==