module.exports=function(t){function e(o){if(n[o])return n[o].exports;var r=n[o]={i:o,l:!1,exports:{}};return t[o].call(r.exports,r,r.exports,e),r.l=!0,r.exports}var n={};return e.m=t,e.c=n,e.i=function(t){return t},e.d=function(t,n,o){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:o})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=6)}([function(t,e,n){function o(t){return l(t.duration,Date.now()-t.mouseDown)}function r(t){return t.mouseUp>0?Date.now()-t.mouseUp:0}function i(t){var e=t.duration,n=t.radius,i=.85*a(o(t),0,n,e),u=.15*a(r(t),0,n,e),l=.02*n*c(Date.now()/e);return s(0,i+u+l)}var a=n(7),u=Math.sqrt(2),c=Math.cos,s=Math.max,l=Math.min;t.exports={getMaxRadius:function(t,e,n){return l(.5*s(t,e),n)},getBlotOpacity:function(t,e){return a(r(t),e,-e,t.duration)},getBlotOuterOpacity:function(t,e){return l(this.getBlotOpacity(t,e),a(o(t),0,.3,3*t.duration))},getBlotShiftX:function(t,e,n){return l(1,i(t)/e*2/u)*(n/2-t.x)},getBlotShiftY:function(t,e,n){return l(1,i(t)/e*2/u)*(n/2-t.y)},getBlotScale:function(t){return i(t)/t.radius}}},function(t,e){t.exports={borderRadius:"inherit",height:"100%",left:0,position:"absolute",top:0,width:"100%"}},function(t,e){var n=!1;"undefined"!=typeof window&&(n="ontouchstart"in window||window.DocumentTouch&&document instanceof window.DocumentTouch),t.exports=n},function(t,e){t.exports=function(t){return(window.devicePixelRatio||1)/(t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1)}},function(t,e,n){var o=n(0),r=function(t){var e=t.mouseUp,n=t.duration;return!e||Date.now()-e<n};t.exports=function(t){var e=[],n=!1,i=void 0,a={each:function(t,n){for(var o=0,r=e.length;o<r;o++)t.call(n,e[o])},play:function(){n||(n=!0,a.update())},stop:function(){n=!1,cancelAnimationFrame(i)},getTotalOpacity:function(t){for(var n=0,r=0,i=e.length;r<i;r++)n+=o.getBlotOuterOpacity(e[r],t);return n},update:function(){e=e.filter(r),e.length?i=requestAnimationFrame(a.update):a.stop(),t()},add:function(t){e.push(t),a.play()},release:function(t){for(var n=e.length-1;n>=0;n--)if(!e[n].mouseUp)return e[n].mouseUp=t}};return a}},function(t,e){t.exports=require("react")},function(t,e,n){function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t},u=n(2),c=0,s=n(3),l=n(5),p=n(1),f=n(4),h=2*Math.PI,d=n(0),g=function(t){function e(n){o(this,e);var i=r(this,t.apply(this,arguments));return i.tick=function(){var t=i.state,e=t.ctx,n=t.color,o=t.density,r=t.height,a=t.width,u=t.store;e.save(),e.scale(o,o),e.clearRect(0,0,a,r),e.fillStyle=n,i.props.background&&(e.globalAlpha=u.getTotalOpacity(i.props.opacity),e.fillRect(0,0,a,r)),u.each(i.makeBlot,i),e.restore()},i._getCenter=function(){var t=i.refs.canvas,e=t.getBoundingClientRect(),n=e.top,o=e.bottom,r=e.left;return{clientX:r+(e.right-r)/2,clientY:n+(o-n)/2}},i._onPress=function(t){var e=i.props.center,n=t.button,o=t.ctrlKey,r=t.clientX,a=t.clientY,u=t.changedTouches,s=Date.now();if(u)if(e){var l=i._getCenter(),p=l.clientX,f=l.clientY;i.pushBlot(s,p,f)}else for(var h=0;h<u.length;h++){var d=u[h],g=d.clientX,y=d.clientY;i.pushBlot(s,g,y)}else if(n===c&&!o)if(e){var v=i._getCenter(),w=v.clientX,m=v.clientY;console.log(w,m),i.pushBlot(s,w,m)}else i.pushBlot(s,r,a)},i._onRelease=function(){i.state.store.release(Date.now())},i.state={color:"transparent",density:1,height:0,store:f(i.tick),touchEvents:i.touchEvents(),width:0},i}return i(e,t),e.prototype.touchEvents=function(){return this.props.hasTouch?{onTouchStart:this._onPress,onTouchEnd:this._onRelease,onTouchCancel:this._onRelease}:{onMouseDown:this._onPress,onMouseUp:this._onRelease,onMouseLeave:this._onRelease}},e.prototype.makeBlot=function(t){var e=this.state,n=e.ctx,o=e.height,r=e.width,i=t.x,a=t.y,u=t.radius;if(n.globalAlpha=d.getBlotOpacity(t,this.props.opacity),n.beginPath(),this.props.recenter){var c=Math.max(o,r);i+=d.getBlotShiftX(t,c,r),a+=d.getBlotShiftY(t,c,o)}n.arc(i,a,u*d.getBlotScale(t),0,h),n.closePath(),n.fill()},e.prototype.componentWillUnmount=function(){this.state.store.stop()},e.prototype.pushBlot=function(t,e,n){var o=this,r=this.refs.canvas;r instanceof window.HTMLCanvasElement==!1&&(r=r.getDOMNode());var i=r.getBoundingClientRect(),a=i.top,u=i.bottom,c=i.left,l=i.right,p=window.getComputedStyle(r),f=p.color,h=this.state.ctx||r.getContext("2d"),g=s(h),y=u-a,v=l-c,w=d.getMaxRadius(y,v,this.props.radius);this.setState({color:f,ctx:h,density:g,height:y,width:v},function(){o.state.store.add({duration:o.props.duration,mouseDown:t,mouseUp:0,radius:w,x:e-c,y:n-a})})},e.prototype.render=function(){var t=this.state,e=t.density,n=t.height,o=t.width,r=t.touchEvents;return l.createElement("canvas",a({className:"ink",ref:"canvas",style:a({},p,this.props.style),height:n*e,width:o*e,onDragOver:this._onRelease},r))},e}(l.PureComponent);g.defaultProps={background:!0,duration:1e3,opacity:.25,radius:150,recenter:!0,hasTouch:u,center:!1},t.exports=g},function(t,e){t.exports=function(t,e,n,o){return n*((t=t/o-1)*t*t*t*t+1)+e}}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vaW5rLmpzIiwid2VicGFjazovLy93ZWJwYWNrL2Jvb3RzdHJhcCBkNDVjNDYxZTdlYzQwZDFjYjMwNCIsIndlYnBhY2s6Ly8vLi9zcmMvdXRpbC9lcXVhdGlvbnMuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL3N0eWxlLmpzIiwid2VicGFjazovLy8uL3NyYy91dGlsL2hhc1RvdWNoLmpzIiwid2VicGFjazovLy8uL3NyYy91dGlsL3BpeGVsUmF0aW8uanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL3V0aWwvc3RvcmUuanMiLCJ3ZWJwYWNrOi8vL2V4dGVybmFsIFwicmVhY3RcIiIsIndlYnBhY2s6Ly8vLi9zcmMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL3V0aWwvZWFzaW5nLmpzIl0sIm5hbWVzIjpbIm1vZHVsZSIsImV4cG9ydHMiLCJtb2R1bGVzIiwiX193ZWJwYWNrX3JlcXVpcmVfXyIsIm1vZHVsZUlkIiwiaW5zdGFsbGVkTW9kdWxlcyIsImkiLCJsIiwiY2FsbCIsIm0iLCJjIiwidmFsdWUiLCJkIiwibmFtZSIsImdldHRlciIsIm8iLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImNvbmZpZ3VyYWJsZSIsImVudW1lcmFibGUiLCJnZXQiLCJuIiwiX19lc01vZHVsZSIsIm9iamVjdCIsInByb3BlcnR5IiwicHJvdG90eXBlIiwiaGFzT3duUHJvcGVydHkiLCJwIiwicyIsImdldFByZXNzIiwiYmxvdCIsIm1pbiIsImR1cmF0aW9uIiwiRGF0ZSIsIm5vdyIsIm1vdXNlRG93biIsImdldFJlbGVhc2UiLCJtb3VzZVVwIiwiZ2V0UmFkaXVzIiwicmFkaXVzIiwiZG93biIsImVhc2luZyIsInVwIiwidW5kdWxhdGlvbiIsImNvcyIsIm1heCIsIlNRUlRfMiIsIk1hdGgiLCJzcXJ0IiwiZ2V0TWF4UmFkaXVzIiwiaGVpZ2h0Iiwid2lkdGgiLCJnZXRCbG90T3BhY2l0eSIsIm9wYWNpdHkiLCJnZXRCbG90T3V0ZXJPcGFjaXR5IiwidGhpcyIsImdldEJsb3RTaGlmdFgiLCJzaXplIiwieCIsImdldEJsb3RTaGlmdFkiLCJ5IiwiZ2V0QmxvdFNjYWxlIiwiYm9yZGVyUmFkaXVzIiwibGVmdCIsInBvc2l0aW9uIiwidG9wIiwiYm9vbCIsIndpbmRvdyIsIkRvY3VtZW50VG91Y2giLCJkb2N1bWVudCIsImNvbnRleHQiLCJkZXZpY2VQaXhlbFJhdGlvIiwid2Via2l0QmFja2luZ1N0b3JlUGl4ZWxSYXRpbyIsIm1vekJhY2tpbmdTdG9yZVBpeGVsUmF0aW8iLCJtc0JhY2tpbmdTdG9yZVBpeGVsUmF0aW8iLCJvQmFja2luZ1N0b3JlUGl4ZWxSYXRpbyIsImJhY2tpbmdTdG9yZVBpeGVsUmF0aW8iLCJFcXVhdGlvbnMiLCJraWxsU3RhbGUiLCJfcmVmIiwicHVibGljaXplIiwiX2RhdGEiLCJfcGxheWluZyIsIl9mcmFtZSIsIlN0b3JlIiwiZWFjaCIsImNhbGxiYWNrIiwic2NvcGUiLCJsZW5ndGgiLCJwbGF5IiwidXBkYXRlIiwic3RvcCIsImNhbmNlbEFuaW1hdGlvbkZyYW1lIiwiZ2V0VG90YWxPcGFjaXR5IiwiYW5zd2VyIiwiZmlsdGVyIiwicmVxdWVzdEFuaW1hdGlvbkZyYW1lIiwiYWRkIiwicHJvcHMiLCJwdXNoIiwicmVsZWFzZSIsInRpbWUiLCJyZXF1aXJlIiwiX2NsYXNzQ2FsbENoZWNrIiwiaW5zdGFuY2UiLCJDb25zdHJ1Y3RvciIsIlR5cGVFcnJvciIsIl9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuIiwic2VsZiIsIlJlZmVyZW5jZUVycm9yIiwiX2luaGVyaXRzIiwic3ViQ2xhc3MiLCJzdXBlckNsYXNzIiwiY3JlYXRlIiwiY29uc3RydWN0b3IiLCJ3cml0YWJsZSIsInNldFByb3RvdHlwZU9mIiwiX19wcm90b19fIiwiX2V4dGVuZHMiLCJhc3NpZ24iLCJ0YXJnZXQiLCJhcmd1bWVudHMiLCJzb3VyY2UiLCJrZXkiLCJIQVNfVE9VQ0giLCJNT1VTRV9MRUZUIiwicGl4ZWxSYXRpbyIsIlJlYWN0IiwiU1RZTEUiLCJUQVUiLCJQSSIsIkluayIsIl9SZWFjdCRQdXJlQ29tcG9uZW50IiwiX3RoaXMiLCJhcHBseSIsInRpY2siLCJfdGhpcyRzdGF0ZSIsInN0YXRlIiwiY3R4IiwiY29sb3IiLCJkZW5zaXR5Iiwic3RvcmUiLCJzYXZlIiwic2NhbGUiLCJjbGVhclJlY3QiLCJmaWxsU3R5bGUiLCJiYWNrZ3JvdW5kIiwiZ2xvYmFsQWxwaGEiLCJmaWxsUmVjdCIsIm1ha2VCbG90IiwicmVzdG9yZSIsIl9nZXRDZW50ZXIiLCJlbCIsInJlZnMiLCJjYW52YXMiLCJfZWwkZ2V0Qm91bmRpbmdDbGllbnQiLCJnZXRCb3VuZGluZ0NsaWVudFJlY3QiLCJib3R0b20iLCJjbGllbnRYIiwicmlnaHQiLCJjbGllbnRZIiwiX29uUHJlc3MiLCJlIiwiY2VudGVyIiwiYnV0dG9uIiwiY3RybEtleSIsImNoYW5nZWRUb3VjaGVzIiwidGltZVN0YW1wIiwiX3RoaXMkX2dldENlbnRlciIsInB1c2hCbG90IiwiX2NoYW5nZWRUb3VjaGVzJGkiLCJfdGhpcyRfZ2V0Q2VudGVyMiIsImNvbnNvbGUiLCJsb2ciLCJfb25SZWxlYXNlIiwidG91Y2hFdmVudHMiLCJoYXNUb3VjaCIsIm9uVG91Y2hTdGFydCIsIm9uVG91Y2hFbmQiLCJvblRvdWNoQ2FuY2VsIiwib25Nb3VzZURvd24iLCJvbk1vdXNlVXAiLCJvbk1vdXNlTGVhdmUiLCJfc3RhdGUiLCJiZWdpblBhdGgiLCJyZWNlbnRlciIsImFyYyIsImNsb3NlUGF0aCIsImZpbGwiLCJjb21wb25lbnRXaWxsVW5tb3VudCIsIl90aGlzMiIsIkhUTUxDYW52YXNFbGVtZW50IiwiZ2V0RE9NTm9kZSIsIl9lbCRnZXRCb3VuZGluZ0NsaWVudDIiLCJfd2luZG93JGdldENvbXB1dGVkU3QiLCJnZXRDb21wdXRlZFN0eWxlIiwiZ2V0Q29udGV4dCIsInNldFN0YXRlIiwicmVuZGVyIiwiX3N0YXRlMiIsImNyZWF0ZUVsZW1lbnQiLCJjbGFzc05hbWUiLCJyZWYiLCJzdHlsZSIsIm9uRHJhZ092ZXIi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M2NTSixFQUFNOEUsY0FBbEIxRSxHQUVHMkUsY0FDTDVELFlBQWEsRUFDYmxILFNBQWEsSUFDYnFCLFFBQWEsSUFDYmQsT0FBYSxJQUNia0osVUFBYSxFQUNiVCxTQUFhcEQsRUFDYnVDLFFBQWEsR0FrS2pCbkssRUFBT0MsUUFBVWtJLEdSa1RYLFNBQVVuSSxFQUFRQyxHU3JleEJELEVBQU9DLFFBQVUsU0FBdUI4TSxFQUFHQyxFQUFHdE0sRUFBR0UsR0FDL0MsTUFBT0YsS0FBSXFNLEVBQUVBLEVBQUVuTSxFQUFFLEdBQUdtTSxFQUFFQSxFQUFFQSxFQUFFQSxFQUFJLEdBQUtDIiwiZmlsZSI6Imluay5qcyIsInNvdXJjZXNDb250ZW50IjpbIm1vZHVsZS5leHBvcnRzID1cbi8qKioqKiovIChmdW5jdGlvbihtb2R1bGVzKSB7IC8vIHdlYnBhY2tCb290c3RyYXBcbi8qKioqKiovIFx0Ly8gVGhlIG1vZHVsZSBjYWNoZVxuLyoqKioqKi8gXHR2YXIgaW5zdGFsbGVkTW9kdWxlcyA9IHt9O1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbi8qKioqKiovIFx0ZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuLyoqKioqKi9cbi8qKioqKiovIFx0XHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcbi8qKioqKiovIFx0XHRpZihpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSkge1xuLyoqKioqKi8gXHRcdFx0cmV0dXJuIGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdLmV4cG9ydHM7XG4vKioqKioqLyBcdFx0fVxuLyoqKioqKi8gXHRcdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG4vKioqKioqLyBcdFx0dmFyIG1vZHVsZSA9IGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdID0ge1xuLyoqKioqKi8gXHRcdFx0aTogbW9kdWxlSWQsXG4vKioqKioqLyBcdFx0XHRsOiBmYWxzZSxcbi8qKioqKiovIFx0XHRcdGV4cG9ydHM6IHt9XG4vKioqKioqLyBcdFx0fTtcbi8qKioqKiovXG4vKioqKioqLyBcdFx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG4vKioqKioqLyBcdFx0bW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG4vKioqKioqL1xuLyoqKioqKi8gXHRcdC8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWRcbi8qKioqKiovIFx0XHRtb2R1bGUubCA9IHRydWU7XG4vKioqKioqL1xuLyoqKioqKi8gXHRcdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG4vKioqKioqLyBcdFx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xuLyoqKioqKi8gXHR9XG4vKioqKioqL1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXylcbi8qKioqKiovIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlcztcbi8qKioqKiovXG4vKioqKioqLyBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlXG4vKioqKioqLyBcdF9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7XG4vKioqKioqL1xuLyoqKioqKi8gXHQvLyBpZGVudGl0eSBmdW5jdGlvbiBmb3IgY2FsbGluZyBoYXJtb255IGltcG9ydHMgd2l0aCB0aGUgY29ycmVjdCBjb250ZXh0XG4vKioqKioqLyBcdF9fd2VicGFja19yZXF1aXJlX18uaSA9IGZ1bmN0aW9uKHZhbHVlKSB7IHJldHVybiB2YWx1ZTsgfTtcbi8qKioqKiovXG4vKioqKioqLyBcdC8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb24gZm9yIGhhcm1vbnkgZXhwb3J0c1xuLyoqKioqKi8gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSBmdW5jdGlvbihleHBvcnRzLCBuYW1lLCBnZXR0ZXIpIHtcbi8qKioqKiovIFx0XHRpZighX193ZWJwYWNrX3JlcXVpcmVfXy5vKGV4cG9ydHMsIG5hbWUpKSB7XG4vKioqKioqLyBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgbmFtZSwge1xuLyoqKioqKi8gXHRcdFx0XHRjb25maWd1cmFibGU6IGZhbHNlLFxuLyoqKioqKi8gXHRcdFx0XHRlbnVtZXJhYmxlOiB0cnVlLFxuLyoqKioqKi8gXHRcdFx0XHRnZXQ6IGdldHRlclxuLyoqKioqKi8gXHRcdFx0fSk7XG4vKioqKioqLyBcdFx0fVxuLyoqKioqKi8gXHR9O1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gZ2V0RGVmYXVsdEV4cG9ydCBmdW5jdGlvbiBmb3IgY29tcGF0aWJpbGl0eSB3aXRoIG5vbi1oYXJtb255IG1vZHVsZXNcbi8qKioqKiovIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5uID0gZnVuY3Rpb24obW9kdWxlKSB7XG4vKioqKioqLyBcdFx0dmFyIGdldHRlciA9IG1vZHVsZSAmJiBtb2R1bGUuX19lc01vZHVsZSA/XG4vKioqKioqLyBcdFx0XHRmdW5jdGlvbiBnZXREZWZhdWx0KCkgeyByZXR1cm4gbW9kdWxlWydkZWZhdWx0J107IH0gOlxuLyoqKioqKi8gXHRcdFx0ZnVuY3Rpb24gZ2V0TW9kdWxlRXhwb3J0cygpIHsgcmV0dXJuIG1vZHVsZTsgfTtcbi8qKioqKiovIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQoZ2V0dGVyLCAnYScsIGdldHRlcik7XG4vKioqKioqLyBcdFx0cmV0dXJuIGdldHRlcjtcbi8qKioqKiovIFx0fTtcbi8qKioqKiovXG4vKioqKioqLyBcdC8vIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbFxuLyoqKioqKi8gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSBmdW5jdGlvbihvYmplY3QsIHByb3BlcnR5KSB7IHJldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqZWN0LCBwcm9wZXJ0eSk7IH07XG4vKioqKioqL1xuLyoqKioqKi8gXHQvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfX1xuLyoqKioqKi8gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIlwiO1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG4vKioqKioqLyBcdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKF9fd2VicGFja19yZXF1aXJlX18ucyA9IDYpO1xuLyoqKioqKi8gfSlcbi8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4vKioqKioqLyAoW1xuLyogMCAqL1xuLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXG52YXIgZWFzaW5nID0gX193ZWJwYWNrX3JlcXVpcmVfXyg3KTtcbnZhciBTUVJUXzIgPSBNYXRoLnNxcnQoMik7XG52YXIgY29zID0gTWF0aC5jb3MsXG4gICAgbWF4ID0gTWF0aC5tYXgsXG4gICAgbWluID0gTWF0aC5taW47XG5cblxuZnVuY3Rpb24gZ2V0UHJlc3MoYmxvdCkge1xuICByZXR1cm4gbWluKGJsb3QuZHVyYXRpb24sIERhdGUubm93KCkgLSBibG90Lm1vdXNlRG93bik7XG59XG5cbmZ1bmN0aW9uIGdldFJlbGVhc2UoYmxvdCkge1xuICByZXR1cm4gYmxvdC5tb3VzZVVwID4gMCA/IERhdGUubm93KCkgLSBibG90Lm1vdXNlVXAgOiAwO1xufVxuXG5mdW5jdGlvbiBnZXRSYWRpdXMoYmxvdCkge1xuICB2YXIgZHVyYXRpb24gPSBibG90LmR1cmF0aW9uLFxuICAgICAgcmFkaXVzID0gYmxvdC5yYWRpdXM7XG5cblxuICB2YXIgZG93biA9IGVhc2luZyhnZXRQcmVzcyhibG90KSwgMCwgcmFkaXVzLCBkdXJhdGlvbikgKiAwLjg1O1xuICB2YXIgdXAgPSBlYXNpbmcoZ2V0UmVsZWFzZShibG90KSwgMCwgcmFkaXVzLCBkdXJhdGlvbikgKiAwLjE1O1xuICB2YXIgdW5kdWxhdGlvbiA9IHJhZGl1cyAqIDAuMDIgKiBjb3MoRGF0ZS5ub3coKSAvIGR1cmF0aW9uKTtcblxuICByZXR1cm4gbWF4KDAsIGRvd24gKyB1cCArIHVuZHVsYXRpb24pO1xufVxuXG5tb2R1bGUuZXhwb3J0cyA9IHtcbiAgZ2V0TWF4UmFkaXVzOiBmdW5jdGlvbiBnZXRNYXhSYWRpdXMoaGVpZ2h0LCB3aWR0aCwgcmFkaXVzKSB7XG4gICAgcmV0dXJuIG1pbihtYXgoaGVpZ2h0LCB3aWR0aCkgKiAwLjUsIHJhZGl1cyk7XG4gIH0sXG4gIGdldEJsb3RPcGFjaXR5OiBmdW5jdGlvbiBnZXRCbG90T3BhY2l0eShibG90LCBvcGFjaXR5KSB7XG4gICAgcmV0dXJuIGVhc2luZyhnZXRSZWxlYXNlKGJsb3QpLCBvcGFjaXR5LCAtb3BhY2l0eSwgYmxvdC5kdXJhdGlvbik7XG4gIH0sXG4gIGdldEJsb3RPdXRlck9wYWNpdHk6IGZ1bmN0aW9uIGdldEJsb3RPdXRlck9wYWNpdHkoYmxvdCwgb3BhY2l0eSkge1xuICAgIHJldHVybiBtaW4odGhpcy5nZXRCbG90T3BhY2l0eShibG90LCBvcGFjaXR5KSwgZWFzaW5nKGdldFByZXNzKGJsb3QpLCAwLCAwLjMsIGJsb3QuZHVyYXRpb24gKiAzKSk7XG4gIH0sXG4gIGdldEJsb3RTaGlmdFg6IGZ1bmN0aW9uIGdldEJsb3RTaGlmdFgoYmxvdCwgc2l6ZSwgd2lkdGgpIHtcbiAgICByZXR1cm4gbWluKDEsIGdldFJhZGl1cyhibG90KSAvIHNpemUgKiAyIC8gU1FSVF8yKSAqICh3aWR0aCAvIDIgLSBibG90LngpO1xuICB9LFxuICBnZXRCbG90U2hpZnRZOiBmdW5jdGlvbiBnZXRCbG90U2hpZnRZKGJsb3QsIHNpemUsIGhlaWdodCkge1xuICAgIHJldHVybiBtaW4oMSwgZ2V0UmFkaXVzKGJsb3QpIC8gc2l6ZSAqIDIgLyBTUVJUXzIpICogKGhlaWdodCAvIDIgLSBibG90LnkpO1xuICB9LFxuICBnZXRCbG90U2NhbGU6IGZ1bmN0aW9uIGdldEJsb3RTY2FsZShibG90KSB7XG4gICAgcmV0dXJuIGdldFJhZGl1cyhibG90KSAvIGJsb3QucmFkaXVzO1xuICB9XG59O1xuXG4vKioqLyB9KSxcbi8qIDEgKi9cbi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHtcblxubW9kdWxlLmV4cG9ydHMgPSB7XG4gIGJvcmRlclJhZGl1czogJ2luaGVyaXQnLFxuICBoZWlnaHQ6ICcxMDAlJyxcbiAgbGVmdDogMCxcbiAgcG9zaXRpb246ICdhYnNvbHV0ZScsXG4gIHRvcDogMCxcbiAgd2lkdGg6ICcxMDAlJ1xufTtcblxuLyoqKi8gfSksXG4vKiAyICovXG4vKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7XG5cbnZhciBib29sID0gZmFsc2U7XG5cbmlmICh0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJykge1xuICBib29sID0gJ29udG91Y2hzdGFydCcgaW4gd2luZG93IHx8IHdpbmRvdy5Eb2N1bWVudFRvdWNoICYmIGRvY3VtZW50IGluc3RhbmNlb2Ygd2luZG93LkRvY3VtZW50VG91Y2g7XG59XG5cbm1vZHVsZS5leHBvcnRzID0gYm9vbDtcblxuLyoqKi8gfSksXG4vKiAzICovXG4vKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7XG5cbi8vIEdvb2Qgc3R1ZmYgaGVyZTpcbi8vIGh0dHA6Ly93d3cuaHRtbDVyb2Nrcy5jb20vZW4vdHV0b3JpYWxzL2NhbnZhcy9oaWRwaS9cblxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoY29udGV4dCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGRldmljZVBpeGVsUmF0aW8gPSB3aW5kb3cuZGV2aWNlUGl4ZWxSYXRpbyB8fCAxO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGJhY2tpbmdTdG9yZVJhdGlvID0gY29udGV4dC53ZWJraXRCYWNraW5nU3RvcmVQaXhlbFJhdGlvIHx8IGNvbnRleHQubW96QmFja2luZ1N0b3JlUGl4ZWxSYXRpbyB8fCBjb250ZXh0Lm1zQmFja2luZ1N0b3JlUGl4ZWxSYXRpbyB8fCBjb250ZXh0Lm9CYWNraW5nU3RvcmVQaXhlbFJhdGlvIHx8IGNvbnRleHQuYmFja2luZ1N0b3JlUGl4ZWxSYXRpbyB8fCAxO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZGV2aWNlUGl4ZWxSYXRpbyAvIGJhY2tpbmdTdG9yZVJhdGlvO1xufTtcblxuLyoqKi8gfSksXG4vKiA0ICovXG4vKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cbi8qKlxuICogSW5rIFN0b3JlXG4gKiBLZWVwcyB0cmFjayBvZiBjaGFuZ2VzIHRvIHJpcHBsZSBlcGljZW50ZXJzXG4gKiBzbyB0aGF0IDxJbmsgLz4gY2FuIGZvY3VzIG9uIHJlbmRlcmluZyB0aGVtLlxuICovXG5cbnZhciBFcXVhdGlvbnMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDApO1xuXG52YXIga2lsbFN0YWxlID0gZnVuY3Rpb24ga2lsbFN0YWxlKF9yZWYpIHtcbiAgdmFyIG1vdXNlVXAgPSBfcmVmLm1vdXNlVXAsXG4gICAgICBkdXJhdGlvbiA9IF9yZWYuZHVyYXRpb247XG4gIHJldHVybiAhbW91c2VVcCB8fCBEYXRlLm5vdygpIC0gbW91c2VVcCA8IGR1cmF0aW9uO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAocHVibGljaXplKSB7XG4gIHZhciBfZGF0YSA9IFtdO1xuICB2YXIgX3BsYXlpbmcgPSBmYWxzZTtcbiAgdmFyIF9mcmFtZSA9IHZvaWQgMDtcblxuICB2YXIgU3RvcmUgPSB7XG4gICAgZWFjaDogZnVuY3Rpb24gZWFjaChjYWxsYmFjaywgc2NvcGUpIHtcbiAgICAgIGZvciAodmFyIGkgPSAwLCBsID0gX2RhdGEubGVuZ3RoOyBpIDwgbDsgaSsrKSB7XG4gICAgICAgIGNhbGxiYWNrLmNhbGwoc2NvcGUsIF9kYXRhW2ldKTtcbiAgICAgIH1cbiAgICB9LFxuICAgIHBsYXk6IGZ1bmN0aW9uIHBsYXkoKSB7XG4gICAgICBpZiAoIV9wbGF5aW5nKSB7XG4gICAgICAgIF9wbGF5aW5nID0gdHJ1ZTtcbiAgICAgICAgU3RvcmUudXBkYXRlKCk7XG4gICAgICB9XG4gICAgfSxcbiAgICBzdG9wOiBmdW5jdGlvbiBzdG9wKCkge1xuICAgICAgX3BsYXlpbmcgPSBmYWxzZTtcbiAgICAgIGNhbmNlbEFuaW1hdGlvbkZyYW1lKF9mcmFtZSk7XG4gICAgfSxcbiAgICBnZXRUb3RhbE9wYWNpdHk6IGZ1bmN0aW9uIGdldFRvdGFsT3BhY2l0eShvcGFjaXR5KSB7XG4gICAgICB2YXIgYW5zd2VyID0gMDtcblxuICAgICAgZm9yICh2YXIgaSA9IDAsIGwgPSBfZGF0YS5sZW5ndGg7IGkgPCBsOyBpKyspIHtcbiAgICAgICAgYW5zd2VyICs9IEVxdWF0aW9ucy5nZXRCbG90T3V0ZXJPcGFjaXR5KF9kYXRhW2ldLCBvcGFjaXR5KTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIGFuc3dlcjtcbiAgICB9LFxuICAgIHVwZGF0ZTogZnVuY3Rpb24gdXBkYXRlKCkge1xuICAgICAgX2RhdGEgPSBfZGF0YS5maWx0ZXIoa2lsbFN0YWxlKTtcblxuICAgICAgaWYgKF9kYXRhLmxlbmd0aCkge1xuICAgICAgICBfZnJhbWUgPSByZXF1ZXN0QW5pbWF0aW9uRnJhbWUoU3RvcmUudXBkYXRlKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIFN0b3JlLnN0b3AoKTtcbiAgICAgIH1cblxuICAgICAgcHVibGljaXplKCk7XG4gICAgfSxcbiAgICBhZGQ6IGZ1bmN0aW9uIGFkZChwcm9wcykge1xuICAgICAgX2RhdGEucHVzaChwcm9wcyk7XG4gICAgICBTdG9yZS5wbGF5KCk7XG4gICAgfSxcbiAgICByZWxlYXNlOiBmdW5jdGlvbiByZWxlYXNlKHRpbWUpIHtcbiAgICAgIGZvciAodmFyIGkgPSBfZGF0YS5sZW5ndGggLSAxOyBpID49IDA7IGktLSkge1xuICAgICAgICBpZiAoIV9kYXRhW2ldLm1vdXNlVXApIHtcbiAgICAgICAgICByZXR1cm4gX2RhdGFbaV0ubW91c2VVcCA9IHRpbWU7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH07XG5cbiAgcmV0dXJuIFN0b3JlO1xufTtcblxuLyoqKi8gfSksXG4vKiA1ICovXG4vKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7XG5cbm1vZHVsZS5leHBvcnRzID0gcmVxdWlyZShcInJlYWN0XCIpO1xuXG4vKioqLyB9KSxcbi8qIDYgKi9cbi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxudmFyIF9leHRlbmRzID0gT2JqZWN0LmFzc2lnbiB8fCBmdW5jdGlvbiAodGFyZ2V0KSB7IGZvciAodmFyIGkgPSAxOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKSB7IHZhciBzb3VyY2UgPSBhcmd1bWVudHNbaV07IGZvciAodmFyIGtleSBpbiBzb3VyY2UpIHsgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChzb3VyY2UsIGtleSkpIHsgdGFyZ2V0W2tleV0gPSBzb3VyY2Vba2V5XTsgfSB9IH0gcmV0dXJuIHRhcmdldDsgfTtcblxuZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpOyB9IH1cblxuZnVuY3Rpb24gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4oc2VsZiwgY2FsbCkgeyBpZiAoIXNlbGYpIHsgdGhyb3cgbmV3IFJlZmVyZW5jZUVycm9yKFwidGhpcyBoYXNuJ3QgYmVlbiBpbml0aWFsaXNlZCAtIHN1cGVyKCkgaGFzbid0IGJlZW4gY2FsbGVkXCIpOyB9IHJldHVybiBjYWxsICYmICh0eXBlb2YgY2FsbCA9PT0gXCJvYmplY3RcIiB8fCB0eXBlb2YgY2FsbCA9PT0gXCJmdW5jdGlvblwiKSA/IGNhbGwgOiBzZWxmOyB9XG5cbmZ1bmN0aW9uIF9pbmhlcml0cyhzdWJDbGFzcywgc3VwZXJDbGFzcykgeyBpZiAodHlwZW9mIHN1cGVyQ2xhc3MgIT09IFwiZnVuY3Rpb25cIiAmJiBzdXBlckNsYXNzICE9PSBudWxsKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJTdXBlciBleHByZXNzaW9uIG11c3QgZWl0aGVyIGJlIG51bGwgb3IgYSBmdW5jdGlvbiwgbm90IFwiICsgdHlwZW9mIHN1cGVyQ2xhc3MpOyB9IHN1YkNsYXNzLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoc3VwZXJDbGFzcyAmJiBzdXBlckNsYXNzLnByb3RvdHlwZSwgeyBjb25zdHJ1Y3RvcjogeyB2YWx1ZTogc3ViQ2xhc3MsIGVudW1lcmFibGU6IGZhbHNlLCB3cml0YWJsZTogdHJ1ZSwgY29uZmlndXJhYmxlOiB0cnVlIH0gfSk7IGlmIChzdXBlckNsYXNzKSBPYmplY3Quc2V0UHJvdG90eXBlT2YgPyBPYmplY3Quc2V0UHJvdG90eXBlT2Yoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIDogc3ViQ2xhc3MuX19wcm90b19fID0gc3VwZXJDbGFzczsgfVxuXG4vKipcbiAqIElua1xuICogRmlsbHMgYSBjb250YWluZXIgd2l0aCBhbiBTVkcgb2JqZWN0IHRoYXQgcHJvdmlkZXMgZmVlZGJhY2sgb24gbW91c2UvdG91Y2hcbiAqIGV2ZW50cyB3aXRoIGEgcmlwcGxpbmcgcG9vbC5cbiAqL1xuXG52YXIgSEFTX1RPVUNIID0gX193ZWJwYWNrX3JlcXVpcmVfXygyKTtcbnZhciBNT1VTRV9MRUZUID0gMDtcbnZhciBwaXhlbFJhdGlvID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKTtcbnZhciBSZWFjdCA9IF9fd2VicGFja19yZXF1aXJlX18oNSk7XG52YXIgU1RZTEUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEpO1xudmFyIFN0b3JlID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0KTtcbnZhciBUQVUgPSBNYXRoLlBJICogMjtcbnZhciBFcXVhdGlvbnMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDApO1xuXG52YXIgSW5rID0gZnVuY3Rpb24gKF9SZWFjdCRQdXJlQ29tcG9uZW50KSB7XG4gIF9pbmhlcml0cyhJbmssIF9SZWFjdCRQdXJlQ29tcG9uZW50KTtcblxuICBmdW5jdGlvbiBJbmsocHJvcHMpIHtcbiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgSW5rKTtcblxuICAgIHZhciBfdGhpcyA9IF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHRoaXMsIF9SZWFjdCRQdXJlQ29tcG9uZW50LmFwcGx5KHRoaXMsIGFyZ3VtZW50cykpO1xuXG4gICAgX3RoaXMudGljayA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHZhciBfdGhpcyRzdGF0ZSA9IF90aGlzLnN0YXRlLFxuICAgICAgICAgIGN0eCA9IF90aGlzJHN0YXRlLmN0eCxcbiAgICAgICAgICBjb2xvciA9IF90aGlzJHN0YXRlLmNvbG9yLFxuICAgICAgICAgIGRlbnNpdHkgPSBfdGhpcyRzdGF0ZS5kZW5zaXR5LFxuICAgICAgICAgIGhlaWdodCA9IF90aGlzJHN0YXRlLmhlaWdodCxcbiAgICAgICAgICB3aWR0aCA9IF90aGlzJHN0YXRlLndpZHRoLFxuICAgICAgICAgIHN0b3JlID0gX3RoaXMkc3RhdGUuc3RvcmU7XG5cblxuICAgICAgY3R4LnNhdmUoKTtcblxuICAgICAgY3R4LnNjYWxlKGRlbnNpdHksIGRlbnNpdHkpO1xuXG4gICAgICBjdHguY2xlYXJSZWN0KDAsIDAsIHdpZHRoLCBoZWlnaHQpO1xuXG4gICAgICBjdHguZmlsbFN0eWxlID0gY29sb3I7XG5cbiAgICAgIGlmIChfdGhpcy5wcm9wcy5iYWNrZ3JvdW5kKSB7XG4gICAgICAgIGN0eC5nbG9iYWxBbHBoYSA9IHN0b3JlLmdldFRvdGFsT3BhY2l0eShfdGhpcy5wcm9wcy5vcGFjaXR5KTtcbiAgICAgICAgY3R4LmZpbGxSZWN0KDAsIDAsIHdpZHRoLCBoZWlnaHQpO1xuICAgICAgfVxuXG4gICAgICBzdG9yZS5lYWNoKF90aGlzLm1ha2VCbG90LCBfdGhpcyk7XG5cbiAgICAgIGN0eC5yZXN0b3JlKCk7XG4gICAgfTtcblxuICAgIF90aGlzLl9nZXRDZW50ZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICB2YXIgZWwgPSBfdGhpcy5yZWZzLmNhbnZhcztcblxuICAgICAgdmFyIF9lbCRnZXRCb3VuZGluZ0NsaWVudCA9IGVsLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLFxuICAgICAgICAgIHRvcCA9IF9lbCRnZXRCb3VuZGluZ0NsaWVudC50b3AsXG4gICAgICAgICAgYm90dG9tID0gX2VsJGdldEJvdW5kaW5nQ2xpZW50LmJvdHRvbSxcbiAgICAgICAgICBsZWZ0ID0gX2VsJGdldEJvdW5kaW5nQ2xpZW50LmxlZnQsXG4gICAgICAgICAgcmlnaHQgPSBfZWwkZ2V0Qm91bmRpbmdDbGllbnQucmlnaHQ7XG5cbiAgICAgIHJldHVybiB7XG4gICAgICAgIGNsaWVudFg6IGxlZnQgKyAocmlnaHQgLSBsZWZ0KSAvIDIsXG4gICAgICAgIGNsaWVudFk6IHRvcCArIChib3R0b20gLSB0b3ApIC8gMlxuICAgICAgfTtcbiAgICB9O1xuXG4gICAgX3RoaXMuX29uUHJlc3MgPSBmdW5jdGlvbiAoZSkge1xuICAgICAgdmFyIGNlbnRlciA9IF90aGlzLnByb3BzLmNlbnRlcjtcbiAgICAgIHZhciBidXR0b24gPSBlLmJ1dHRvbixcbiAgICAgICAgICBjdHJsS2V5ID0gZS5jdHJsS2V5LFxuICAgICAgICAgIGNsaWVudFggPSBlLmNsaWVudFgsXG4gICAgICAgICAgY2xpZW50WSA9IGUuY2xpZW50WSxcbiAgICAgICAgICBjaGFuZ2VkVG91Y2hlcyA9IGUuY2hhbmdlZFRvdWNoZXM7XG5cbiAgICAgIHZhciB0aW1lU3RhbXAgPSBEYXRlLm5vdygpO1xuXG4gICAgICBpZiAoY2hhbmdlZFRvdWNoZXMpIHtcbiAgICAgICAgaWYgKGNlbnRlcikge1xuICAgICAgICAgIHZhciBfdGhpcyRfZ2V0Q2VudGVyID0gX3RoaXMuX2dldENlbnRlcigpLFxuICAgICAgICAgICAgICBfY2xpZW50WCA9IF90aGlzJF9nZXRDZW50ZXIuY2xpZW50WCxcbiAgICAgICAgICAgICAgX2NsaWVudFkgPSBfdGhpcyRfZ2V0Q2VudGVyLmNsaWVudFk7XG5cbiAgICAgICAgICBfdGhpcy5wdXNoQmxvdCh0aW1lU3RhbXAsIF9jbGllbnRYLCBfY2xpZW50WSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjaGFuZ2VkVG91Y2hlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIF9jaGFuZ2VkVG91Y2hlcyRpID0gY2hhbmdlZFRvdWNoZXNbaV0sXG4gICAgICAgICAgICAgICAgX2NsaWVudFgyID0gX2NoYW5nZWRUb3VjaGVzJGkuY2xpZW50WCxcbiAgICAgICAgICAgICAgICBfY2xpZW50WTIgPSBfY2hhbmdlZFRvdWNoZXMkaS5jbGllbnRZO1xuXG4gICAgICAgICAgICBfdGhpcy5wdXNoQmxvdCh0aW1lU3RhbXAsIF9jbGllbnRYMiwgX2NsaWVudFkyKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSBpZiAoYnV0dG9uID09PSBNT1VTRV9MRUZUICYmICFjdHJsS2V5KSB7XG4gICAgICAgIGlmIChjZW50ZXIpIHtcbiAgICAgICAgICB2YXIgX3RoaXMkX2dldENlbnRlcjIgPSBfdGhpcy5fZ2V0Q2VudGVyKCksXG4gICAgICAgICAgICAgIF9jbGllbnRYMyA9IF90aGlzJF9nZXRDZW50ZXIyLmNsaWVudFgsXG4gICAgICAgICAgICAgIF9jbGllbnRZMyA9IF90aGlzJF9nZXRDZW50ZXIyLmNsaWVudFk7XG5cbiAgICAgICAgICBjb25zb2xlLmxvZyhfY2xpZW50WDMsIF9jbGllbnRZMyk7XG4gICAgICAgICAgX3RoaXMucHVzaEJsb3QodGltZVN0YW1wLCBfY2xpZW50WDMsIF9jbGllbnRZMyk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgX3RoaXMucHVzaEJsb3QodGltZVN0YW1wLCBjbGllbnRYLCBjbGllbnRZKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH07XG5cbiAgICBfdGhpcy5fb25SZWxlYXNlID0gZnVuY3Rpb24gKCkge1xuICAgICAgX3RoaXMuc3RhdGUuc3RvcmUucmVsZWFzZShEYXRlLm5vdygpKTtcbiAgICB9O1xuXG4gICAgX3RoaXMuc3RhdGUgPSB7XG4gICAgICBjb2xvcjogJ3RyYW5zcGFyZW50JyxcbiAgICAgIGRlbnNpdHk6IDEsXG4gICAgICBoZWlnaHQ6IDAsXG4gICAgICBzdG9yZTogU3RvcmUoX3RoaXMudGljayksXG4gICAgICB0b3VjaEV2ZW50czogX3RoaXMudG91Y2hFdmVudHMoKSxcbiAgICAgIHdpZHRoOiAwXG4gICAgfTtcbiAgICByZXR1cm4gX3RoaXM7XG4gIH1cblxuICBJbmsucHJvdG90eXBlLnRvdWNoRXZlbnRzID0gZnVuY3Rpb24gdG91Y2hFdmVudHMoKSB7XG4gICAgaWYgKHRoaXMucHJvcHMuaGFzVG91Y2gpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIG9uVG91Y2hTdGFydDogdGhpcy5fb25QcmVzcyxcbiAgICAgICAgb25Ub3VjaEVuZDogdGhpcy5fb25SZWxlYXNlLFxuICAgICAgICBvblRvdWNoQ2FuY2VsOiB0aGlzLl9vblJlbGVhc2VcbiAgICAgIH07XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIG9uTW91c2VEb3duOiB0aGlzLl9vblByZXNzLFxuICAgICAgICBvbk1vdXNlVXA6IHRoaXMuX29uUmVsZWFzZSxcbiAgICAgICAgb25Nb3VzZUxlYXZlOiB0aGlzLl9vblJlbGVhc2VcbiAgICAgIH07XG4gICAgfVxuICB9O1xuXG4gIEluay5wcm90b3R5cGUubWFrZUJsb3QgPSBmdW5jdGlvbiBtYWtlQmxvdChibG90KSB7XG4gICAgdmFyIF9zdGF0ZSA9IHRoaXMuc3RhdGUsXG4gICAgICAgIGN0eCA9IF9zdGF0ZS5jdHgsXG4gICAgICAgIGhlaWdodCA9IF9zdGF0ZS5oZWlnaHQsXG4gICAgICAgIHdpZHRoID0gX3N0YXRlLndpZHRoO1xuICAgIHZhciB4ID0gYmxvdC54LFxuICAgICAgICB5ID0gYmxvdC55LFxuICAgICAgICByYWRpdXMgPSBibG90LnJhZGl1cztcblxuXG4gICAgY3R4Lmdsb2JhbEFscGhhID0gRXF1YXRpb25zLmdldEJsb3RPcGFjaXR5KGJsb3QsIHRoaXMucHJvcHMub3BhY2l0eSk7XG4gICAgY3R4LmJlZ2luUGF0aCgpO1xuXG4gICAgaWYgKHRoaXMucHJvcHMucmVjZW50ZXIpIHtcbiAgICAgIHZhciBzaXplID0gTWF0aC5tYXgoaGVpZ2h0LCB3aWR0aCk7XG5cbiAgICAgIHggKz0gRXF1YXRpb25zLmdldEJsb3RTaGlmdFgoYmxvdCwgc2l6ZSwgd2lkdGgpO1xuICAgICAgeSArPSBFcXVhdGlvbnMuZ2V0QmxvdFNoaWZ0WShibG90LCBzaXplLCBoZWlnaHQpO1xuICAgIH1cblxuICAgIGN0eC5hcmMoeCwgeSwgcmFkaXVzICogRXF1YXRpb25zLmdldEJsb3RTY2FsZShibG90KSwgMCwgVEFVKTtcblxuICAgIGN0eC5jbG9zZVBhdGgoKTtcbiAgICBjdHguZmlsbCgpO1xuICB9O1xuXG4gIEluay5wcm90b3R5cGUuY29tcG9uZW50V2lsbFVubW91bnQgPSBmdW5jdGlvbiBjb21wb25lbnRXaWxsVW5tb3VudCgpIHtcbiAgICB0aGlzLnN0YXRlLnN0b3JlLnN0b3AoKTtcbiAgfTtcblxuICBJbmsucHJvdG90eXBlLnB1c2hCbG90ID0gZnVuY3Rpb24gcHVzaEJsb3QodGltZVN0YW1wLCBjbGllbnRYLCBjbGllbnRZKSB7XG4gICAgdmFyIF90aGlzMiA9IHRoaXM7XG5cbiAgICB2YXIgZWwgPSB0aGlzLnJlZnMuY2FudmFzO1xuXG4gICAgLy8gMC4xMyBzdXBwb3J0XG4gICAgaWYgKGVsIGluc3RhbmNlb2Ygd2luZG93LkhUTUxDYW52YXNFbGVtZW50ID09PSBmYWxzZSkge1xuICAgICAgZWwgPSBlbC5nZXRET01Ob2RlKCk7XG4gICAgfVxuXG4gICAgdmFyIF9lbCRnZXRCb3VuZGluZ0NsaWVudDIgPSBlbC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKSxcbiAgICAgICAgdG9wID0gX2VsJGdldEJvdW5kaW5nQ2xpZW50Mi50b3AsXG4gICAgICAgIGJvdHRvbSA9IF9lbCRnZXRCb3VuZGluZ0NsaWVudDIuYm90dG9tLFxuICAgICAgICBsZWZ0ID0gX2VsJGdldEJvdW5kaW5nQ2xpZW50Mi5sZWZ0LFxuICAgICAgICByaWdodCA9IF9lbCRnZXRCb3VuZGluZ0NsaWVudDIucmlnaHQ7XG5cbiAgICB2YXIgX3dpbmRvdyRnZXRDb21wdXRlZFN0ID0gd2luZG93LmdldENvbXB1dGVkU3R5bGUoZWwpLFxuICAgICAgICBjb2xvciA9IF93aW5kb3ckZ2V0Q29tcHV0ZWRTdC5jb2xvcjtcblxuICAgIHZhciBjdHggPSB0aGlzLnN0YXRlLmN0eCB8fCBlbC5nZXRDb250ZXh0KCcyZCcpO1xuICAgIHZhciBkZW5zaXR5ID0gcGl4ZWxSYXRpbyhjdHgpO1xuICAgIHZhciBoZWlnaHQgPSBib3R0b20gLSB0b3A7XG4gICAgdmFyIHdpZHRoID0gcmlnaHQgLSBsZWZ0O1xuICAgIHZhciByYWRpdXMgPSBFcXVhdGlvbnMuZ2V0TWF4UmFkaXVzKGhlaWdodCwgd2lkdGgsIHRoaXMucHJvcHMucmFkaXVzKTtcblxuICAgIHRoaXMuc2V0U3RhdGUoeyBjb2xvcjogY29sb3IsIGN0eDogY3R4LCBkZW5zaXR5OiBkZW5zaXR5LCBoZWlnaHQ6IGhlaWdodCwgd2lkdGg6IHdpZHRoIH0sIGZ1bmN0aW9uICgpIHtcbiAgICAgIF90aGlzMi5zdGF0ZS5zdG9yZS5hZGQoe1xuICAgICAgICBkdXJhdGlvbjogX3RoaXMyLnByb3BzLmR1cmF0aW9uLFxuICAgICAgICBtb3VzZURvd246IHRpbWVTdGFtcCxcbiAgICAgICAgbW91c2VVcDogMCxcbiAgICAgICAgcmFkaXVzOiByYWRpdXMsXG4gICAgICAgIHg6IGNsaWVudFggLSBsZWZ0LFxuICAgICAgICB5OiBjbGllbnRZIC0gdG9wXG4gICAgICB9KTtcbiAgICB9KTtcbiAgfTtcblxuICBJbmsucHJvdG90eXBlLnJlbmRlciA9IGZ1bmN0aW9uIHJlbmRlcigpIHtcbiAgICB2YXIgX3N0YXRlMiA9IHRoaXMuc3RhdGUsXG4gICAgICAgIGRlbnNpdHkgPSBfc3RhdGUyLmRlbnNpdHksXG4gICAgICAgIGhlaWdodCA9IF9zdGF0ZTIuaGVpZ2h0LFxuICAgICAgICB3aWR0aCA9IF9zdGF0ZTIud2lkdGgsXG4gICAgICAgIHRvdWNoRXZlbnRzID0gX3N0YXRlMi50b3VjaEV2ZW50cztcblxuXG4gICAgcmV0dXJuIFJlYWN0LmNyZWF0ZUVsZW1lbnQoJ2NhbnZhcycsIF9leHRlbmRzKHsgY2xhc3NOYW1lOiAnaW5rJyxcbiAgICAgIHJlZjogJ2NhbnZhcycsXG4gICAgICBzdHlsZTogX2V4dGVuZHMoe30sIFNUWUxFLCB0aGlzLnByb3BzLnN0eWxlKSxcbiAgICAgIGhlaWdodDogaGVpZ2h0ICogZGVuc2l0eSxcbiAgICAgIHdpZHRoOiB3aWR0aCAqIGRlbnNpdHksXG4gICAgICBvbkRyYWdPdmVyOiB0aGlzLl9vblJlbGVhc2VcbiAgICB9LCB0b3VjaEV2ZW50cykpO1xuICB9O1xuXG4gIHJldHVybiBJbms7XG59KFJlYWN0LlB1cmVDb21wb25lbnQpO1xuXG5JbmsuZGVmYXVsdFByb3BzID0ge1xuICBiYWNrZ3JvdW5kOiB0cnVlLFxuICBkdXJhdGlvbjogMTAwMCxcbiAgb3BhY2l0eTogMC4yNSxcbiAgcmFkaXVzOiAxNTAsXG4gIHJlY2VudGVyOiB0cnVlLFxuICBoYXNUb3VjaDogSEFTX1RPVUNILFxuICBjZW50ZXI6IGZhbHNlXG59O1xuXG5cbm1vZHVsZS5leHBvcnRzID0gSW5rO1xuXG4vKioqLyB9KSxcbi8qIDcgKi9cbi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHtcblxuLyoqXG4gKiBAdCBpcyB0aGUgY3VycmVudCB0aW1lIChvciBwb3NpdGlvbikgb2YgdGhlIHR3ZWVuLiBUaGlzIGNhbiBiZSBzZWNvbmRzIG9yIGZyYW1lcywgc3RlcHMsIHNlY29uZHMsIG1zLCB3aGF0ZXZlciDigJMgYXMgbG9uZyBhcyB0aGUgdW5pdCBpcyB0aGUgc2FtZSBhcyBpcyB1c2VkIGZvciB0aGUgdG90YWwgdGltZSBbM10uXG4gKiBAYiBpcyB0aGUgYmVnaW5uaW5nIHZhbHVlIG9mIHRoZSBwcm9wZXJ0eS5cbiAqIEBjIGlzIHRoZSBjaGFuZ2UgYmV0d2VlbiB0aGUgYmVnaW5uaW5nIGFuZCBkZXN0aW5hdGlvbiB2YWx1ZSBvZiB0aGUgcHJvcGVydHkuXG4gKiBAZCBpcyB0aGUgdG90YWwgdGltZSBvZiB0aGUgdHdlZW4uXG4gKi9cblxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiBlYXNlT3V0UXVpbnQodCwgYiwgYywgZCkge1xuICByZXR1cm4gYyAqICgodCA9IHQgLyBkIC0gMSkgKiB0ICogdCAqIHQgKiB0ICsgMSkgKyBiO1xufTtcblxuLyoqKi8gfSlcbi8qKioqKiovIF0pO1xuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyBpbmsuanMiLCIgXHQvLyBUaGUgbW9kdWxlIGNhY2hlXG4gXHR2YXIgaW5zdGFsbGVkTW9kdWxlcyA9IHt9O1xuXG4gXHQvLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuIFx0ZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXG4gXHRcdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuIFx0XHRpZihpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSkge1xuIFx0XHRcdHJldHVybiBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXS5leHBvcnRzO1xuIFx0XHR9XG4gXHRcdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG4gXHRcdHZhciBtb2R1bGUgPSBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSA9IHtcbiBcdFx0XHRpOiBtb2R1bGVJZCxcbiBcdFx0XHRsOiBmYWxzZSxcbiBcdFx0XHRleHBvcnRzOiB7fVxuIFx0XHR9O1xuXG4gXHRcdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuIFx0XHRtb2R1bGVzW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuIFx0XHQvLyBGbGFnIHRoZSBtb2R1bGUgYXMgbG9hZGVkXG4gXHRcdG1vZHVsZS5sID0gdHJ1ZTtcblxuIFx0XHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuIFx0XHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG4gXHR9XG5cblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXylcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubSA9IG1vZHVsZXM7XG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmMgPSBpbnN0YWxsZWRNb2R1bGVzO1xuXG4gXHQvLyBpZGVudGl0eSBmdW5jdGlvbiBmb3IgY2FsbGluZyBoYXJtb255IGltcG9ydHMgd2l0aCB0aGUgY29ycmVjdCBjb250ZXh0XG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmkgPSBmdW5jdGlvbih2YWx1ZSkgeyByZXR1cm4gdmFsdWU7IH07XG5cbiBcdC8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb24gZm9yIGhhcm1vbnkgZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kID0gZnVuY3Rpb24oZXhwb3J0cywgbmFtZSwgZ2V0dGVyKSB7XG4gXHRcdGlmKCFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywgbmFtZSkpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgbmFtZSwge1xuIFx0XHRcdFx0Y29uZmlndXJhYmxlOiBmYWxzZSxcbiBcdFx0XHRcdGVudW1lcmFibGU6IHRydWUsXG4gXHRcdFx0XHRnZXQ6IGdldHRlclxuIFx0XHRcdH0pO1xuIFx0XHR9XG4gXHR9O1xuXG4gXHQvLyBnZXREZWZhdWx0RXhwb3J0IGZ1bmN0aW9uIGZvciBjb21wYXRpYmlsaXR5IHdpdGggbm9uLWhhcm1vbnkgbW9kdWxlc1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5uID0gZnVuY3Rpb24obW9kdWxlKSB7XG4gXHRcdHZhciBnZXR0ZXIgPSBtb2R1bGUgJiYgbW9kdWxlLl9fZXNNb2R1bGUgP1xuIFx0XHRcdGZ1bmN0aW9uIGdldERlZmF1bHQoKSB7IHJldHVybiBtb2R1bGVbJ2RlZmF1bHQnXTsgfSA6XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0TW9kdWxlRXhwb3J0cygpIHsgcmV0dXJuIG1vZHVsZTsgfTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kKGdldHRlciwgJ2EnLCBnZXR0ZXIpO1xuIFx0XHRyZXR1cm4gZ2V0dGVyO1xuIFx0fTtcblxuIFx0Ly8gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSBmdW5jdGlvbihvYmplY3QsIHByb3BlcnR5KSB7IHJldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqZWN0LCBwcm9wZXJ0eSk7IH07XG5cbiBcdC8vIF9fd2VicGFja19wdWJsaWNfcGF0aF9fXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIlwiO1xuXG4gXHQvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbiBcdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKF9fd2VicGFja19yZXF1aXJlX18ucyA9IDYpO1xuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIHdlYnBhY2svYm9vdHN0cmFwIGQ0NWM0NjFlN2VjNDBkMWNiMzA0IiwibGV0IGVhc2luZyA9IHJlcXVpcmUoJy4vZWFzaW5nJylcbmxldCBTUVJUXzIgPSBNYXRoLnNxcnQoMilcbmxldCB7IGNvcywgbWF4LCBtaW4gfSA9IE1hdGhcblxuZnVuY3Rpb24gZ2V0UHJlc3MoYmxvdCkge1xuICByZXR1cm4gbWluKGJsb3QuZHVyYXRpb24sIERhdGUubm93KCkgLSBibG90Lm1vdXNlRG93bilcbn1cblxuZnVuY3Rpb24gZ2V0UmVsZWFzZShibG90KSB7XG4gIHJldHVybiBibG90Lm1vdXNlVXAgPiAwID8gRGF0ZS5ub3coKSAtIGJsb3QubW91c2VVcCA6IDBcbn1cblxuZnVuY3Rpb24gZ2V0UmFkaXVzKGJsb3QpIHtcbiAgbGV0IHsgZHVyYXRpb24sIHJhZGl1cyB9ID0gYmxvdFxuXG4gIGxldCBkb3duICAgICAgID0gZWFzaW5nKGdldFByZXNzKGJsb3QpLCAwLCByYWRpdXMsIGR1cmF0aW9uKSAqIDAuODVcbiAgbGV0IHVwICAgICAgICAgPSBlYXNpbmcoZ2V0UmVsZWFzZShibG90KSwgMCwgcmFkaXVzLCBkdXJhdGlvbikgKiAwLjE1XG4gIGxldCB1bmR1bGF0aW9uID0gcmFkaXVzICogMC4wMiAqIGNvcyhEYXRlLm5vdygpIC8gZHVyYXRpb24pXG5cbiAgcmV0dXJuIG1heCgwLCBkb3duICsgdXAgKyB1bmR1bGF0aW9uKVxufVxuXG5tb2R1bGUuZXhwb3J0cyA9IHtcblxuICBnZXRNYXhSYWRpdXMoaGVpZ2h0LCB3aWR0aCwgcmFkaXVzKSB7XG4gICAgcmV0dXJuIG1pbihtYXgoaGVpZ2h0LCB3aWR0aCkgKiAwLjUsIHJhZGl1cylcbiAgfSxcblxuICBnZXRCbG90T3BhY2l0eShibG90LCBvcGFjaXR5KSB7XG4gICAgcmV0dXJuIGVhc2luZyhnZXRSZWxlYXNlKGJsb3QpLCBvcGFjaXR5LCAtb3BhY2l0eSwgYmxvdC5kdXJhdGlvbilcbiAgfSxcblxuICBnZXRCbG90T3V0ZXJPcGFjaXR5KGJsb3QsIG9wYWNpdHkpIHtcbiAgICByZXR1cm4gbWluKHRoaXMuZ2V0QmxvdE9wYWNpdHkoYmxvdCwgb3BhY2l0eSksXG4gICAgICAgICAgICAgICBlYXNpbmcoZ2V0UHJlc3MoYmxvdCksIDAsIDAuMywgYmxvdC5kdXJhdGlvbiAqIDMpKVxuICB9LFxuXG4gIGdldEJsb3RTaGlmdFgoYmxvdCwgc2l6ZSwgd2lkdGgpIHtcbiAgICByZXR1cm4gbWluKDEsXG4gICAgICAgICAgICAgICBnZXRSYWRpdXMoYmxvdCkgLyBzaXplICogMiAvIFNRUlRfMikgKiAod2lkdGggLyAyIC0gYmxvdC54KVxuICB9LFxuXG4gIGdldEJsb3RTaGlmdFkoYmxvdCwgc2l6ZSwgaGVpZ2h0KSB7XG4gICAgcmV0dXJuIG1pbigxLFxuICAgICAgICAgICAgICAgZ2V0UmFkaXVzKGJsb3QpIC8gc2l6ZSAqIDIgLyBTUVJUXzIpICogKGhlaWdodCAvIDIgLSBibG90LnkpXG4gIH0sXG5cbiAgZ2V0QmxvdFNjYWxlKGJsb3QpIHtcbiAgICByZXR1cm4gZ2V0UmFkaXVzKGJsb3QpIC8gYmxvdC5yYWRpdXNcbiAgfVxufVxuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3JjL3V0aWwvZXF1YXRpb25zLmpzIiwibW9kdWxlLmV4cG9ydHMgPSB7XG4gIGJvcmRlclJhZGl1czogJ2luaGVyaXQnLFxuICBoZWlnaHQ6ICcxMDAlJyxcbiAgbGVmdDogMCxcbiAgcG9zaXRpb246ICdhYnNvbHV0ZScsXG4gIHRvcDogMCxcbiAgd2lkdGg6ICcxMDAlJ1xufVxuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3JjL3N0eWxlLmpzIiwidmFyIGJvb2wgPSBmYWxzZVxuXG5pZiAodHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgYm9vbCA9ICgnb250b3VjaHN0YXJ0JyBpbiB3aW5kb3cpIHx8IHdpbmRvdy5Eb2N1bWVudFRvdWNoICYmIGRvY3VtZW50IGluc3RhbmNlb2Ygd2luZG93LkRvY3VtZW50VG91Y2hcbn1cblxubW9kdWxlLmV4cG9ydHMgPSBib29sXG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9zcmMvdXRpbC9oYXNUb3VjaC5qcyIsIi8vIEdvb2Qgc3R1ZmYgaGVyZTpcbi8vIGh0dHA6Ly93d3cuaHRtbDVyb2Nrcy5jb20vZW4vdHV0b3JpYWxzL2NhbnZhcy9oaWRwaS9cblxubW9kdWxlLmV4cG9ydHMgPSBjb250ZXh0ID0+IHtcbiAgbGV0IGRldmljZVBpeGVsUmF0aW8gID0gd2luZG93LmRldmljZVBpeGVsUmF0aW8gfHwgMVxuICBsZXQgYmFja2luZ1N0b3JlUmF0aW8gPSBjb250ZXh0LndlYmtpdEJhY2tpbmdTdG9yZVBpeGVsUmF0aW8gfHxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGV4dC5tb3pCYWNraW5nU3RvcmVQaXhlbFJhdGlvICAgIHx8XG4gICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRleHQubXNCYWNraW5nU3RvcmVQaXhlbFJhdGlvICAgICB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZXh0Lm9CYWNraW5nU3RvcmVQaXhlbFJhdGlvICAgICAgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGV4dC5iYWNraW5nU3RvcmVQaXhlbFJhdGlvICAgICAgIHx8IDFcblxuICByZXR1cm4gZGV2aWNlUGl4ZWxSYXRpbyAvIGJhY2tpbmdTdG9yZVJhdGlvXG59XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9zcmMvdXRpbC9waXhlbFJhdGlvLmpzIiwiLyoqXG4gKiBJbmsgU3RvcmVcbiAqIEtlZXBzIHRyYWNrIG9mIGNoYW5nZXMgdG8gcmlwcGxlIGVwaWNlbnRlcnNcbiAqIHNvIHRoYXQgPEluayAvPiBjYW4gZm9jdXMgb24gcmVuZGVyaW5nIHRoZW0uXG4gKi9cblxudmFyIEVxdWF0aW9ucyA9IHJlcXVpcmUoJy4vZXF1YXRpb25zJylcblxubGV0IGtpbGxTdGFsZSA9ICh7IG1vdXNlVXAsIGR1cmF0aW9uIH0pID0+ICFtb3VzZVVwIHx8IChEYXRlLm5vdygpIC0gbW91c2VVcCkgPCBkdXJhdGlvblxuXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKHB1YmxpY2l6ZSkge1xuICBsZXQgX2RhdGEgICAgPSBbXVxuICBsZXQgX3BsYXlpbmcgPSBmYWxzZVxuICBsZXQgX2ZyYW1lXG5cbiAgbGV0IFN0b3JlID0ge1xuXG4gICAgZWFjaChjYWxsYmFjaywgc2NvcGUpIHtcbiAgICAgIGZvciAodmFyIGkgPSAwLCBsID0gX2RhdGEubGVuZ3RoOyBpIDwgbDsgaSsrKSB7XG4gICAgICAgIGNhbGxiYWNrLmNhbGwoc2NvcGUsIF9kYXRhW2ldKVxuICAgICAgfVxuICAgIH0sXG5cbiAgICBwbGF5KCkge1xuICAgICAgaWYgKCFfcGxheWluZykge1xuICAgICAgICBfcGxheWluZyA9IHRydWVcbiAgICAgICAgU3RvcmUudXBkYXRlKClcbiAgICAgIH1cbiAgICB9LFxuXG4gICAgc3RvcCgpIHtcbiAgICAgIF9wbGF5aW5nID0gZmFsc2VcbiAgICAgIGNhbmNlbEFuaW1hdGlvbkZyYW1lKF9mcmFtZSlcbiAgICB9LFxuXG4gICAgZ2V0VG90YWxPcGFjaXR5KG9wYWNpdHkpIHtcbiAgICAgIGxldCBhbnN3ZXIgPSAwXG5cbiAgICAgIGZvciAodmFyIGkgPSAwLCBsID0gX2RhdGEubGVuZ3RoOyBpIDwgbDsgaSsrKSB7XG4gICAgICAgIGFuc3dlciArPSBFcXVhdGlvbnMuZ2V0QmxvdE91dGVyT3BhY2l0eShfZGF0YVtpXSwgb3BhY2l0eSlcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIGFuc3dlclxuICAgIH0sXG5cbiAgICB1cGRhdGUoKSB7XG4gICAgICBfZGF0YSA9IF9kYXRhLmZpbHRlcihraWxsU3RhbGUpXG5cbiAgICAgIGlmIChfZGF0YS5sZW5ndGgpIHtcbiAgICAgICAgX2ZyYW1lID0gcmVxdWVzdEFuaW1hdGlvbkZyYW1lKFN0b3JlLnVwZGF0ZSlcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIFN0b3JlLnN0b3AoKVxuICAgICAgfVxuXG4gICAgICBwdWJsaWNpemUoKVxuICAgIH0sXG5cbiAgICBhZGQocHJvcHMpIHtcbiAgICAgIF9kYXRhLnB1c2gocHJvcHMpXG4gICAgICBTdG9yZS5wbGF5KClcbiAgICB9LFxuXG4gICAgcmVsZWFzZSh0aW1lKSB7XG4gICAgICBmb3IgKGxldCBpID0gX2RhdGEubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIHtcbiAgICAgICAgaWYgKCFfZGF0YVtpXS5tb3VzZVVwKSB7XG4gICAgICAgICAgcmV0dXJuIF9kYXRhW2ldLm1vdXNlVXAgPSB0aW1lXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgfVxuXG4gIHJldHVybiBTdG9yZVxufVxuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3JjL3V0aWwvc3RvcmUuanMiLCJtb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoXCJyZWFjdFwiKTtcblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyBleHRlcm5hbCBcInJlYWN0XCJcbi8vIG1vZHVsZSBpZCA9IDVcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwiLyoqXG4gKiBJbmtcbiAqIEZpbGxzIGEgY29udGFpbmVyIHdpdGggYW4gU1ZHIG9iamVjdCB0aGF0IHByb3ZpZGVzIGZlZWRiYWNrIG9uIG1vdXNlL3RvdWNoXG4gKiBldmVudHMgd2l0aCBhIHJpcHBsaW5nIHBvb2wuXG4gKi9cblxubGV0IEhBU19UT1VDSCAgPSByZXF1aXJlKCcuL3V0aWwvaGFzVG91Y2gnKVxubGV0IE1PVVNFX0xFRlQgPSAwXG5sZXQgcGl4ZWxSYXRpbyA9IHJlcXVpcmUoJy4vdXRpbC9waXhlbFJhdGlvJylcbmxldCBSZWFjdCAgICAgID0gcmVxdWlyZSgncmVhY3QnKVxubGV0IFNUWUxFICAgICAgPSByZXF1aXJlKCcuL3N0eWxlJylcbmxldCBTdG9yZSAgICAgID0gcmVxdWlyZSgnLi91dGlsL3N0b3JlJylcbmxldCBUQVUgICAgICAgID0gTWF0aC5QSSAqIDJcbmxldCBFcXVhdGlvbnMgID0gcmVxdWlyZSgnLi91dGlsL2VxdWF0aW9ucycpXG5cbmNsYXNzIEluayBleHRlbmRzIFJlYWN0LlB1cmVDb21wb25lbnQge1xuXG4gIHN0YXRpYyBkZWZhdWx0UHJvcHMgPSB7XG4gICAgYmFja2dyb3VuZCA6IHRydWUsXG4gICAgZHVyYXRpb24gICA6IDEwMDAsXG4gICAgb3BhY2l0eSAgICA6IDAuMjUsXG4gICAgcmFkaXVzICAgICA6IDE1MCxcbiAgICByZWNlbnRlciAgIDogdHJ1ZSxcbiAgICBoYXNUb3VjaCAgIDogSEFTX1RPVUNILFxuICAgIGNlbnRlciAgICAgOiBmYWxzZSxcbiAgfVxuXG4gIGNvbnN0cnVjdG9yIChwcm9wcykge1xuICAgIHN1cGVyKC4uLmFyZ3VtZW50cylcblxuICAgIHRoaXMuc3RhdGUgPSB7XG4gICAgICBjb2xvciAgICAgICA6ICd0cmFuc3BhcmVudCcsXG4gICAgICBkZW5zaXR5ICAgICA6IDEsXG4gICAgICBoZWlnaHQgICAgICA6IDAsXG4gICAgICBzdG9yZSAgICAgICA6IFN0b3JlKHRoaXMudGljayksXG4gICAgICB0b3VjaEV2ZW50cyA6IHRoaXMudG91Y2hFdmVudHMoKSxcbiAgICAgIHdpZHRoICAgICAgIDogMFxuICAgIH1cbiAgfVxuXG4gIHRvdWNoRXZlbnRzICgpIHtcbiAgICBpZiAodGhpcy5wcm9wcy5oYXNUb3VjaCkge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgb25Ub3VjaFN0YXJ0ICA6IHRoaXMuX29uUHJlc3MsXG4gICAgICAgIG9uVG91Y2hFbmQgICAgOiB0aGlzLl9vblJlbGVhc2UsXG4gICAgICAgIG9uVG91Y2hDYW5jZWwgOiB0aGlzLl9vblJlbGVhc2VcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgb25Nb3VzZURvd24gICA6IHRoaXMuX29uUHJlc3MsXG4gICAgICAgIG9uTW91c2VVcCAgICAgOiB0aGlzLl9vblJlbGVhc2UsXG4gICAgICAgIG9uTW91c2VMZWF2ZSAgOiB0aGlzLl9vblJlbGVhc2VcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICB0aWNrID0gKCkgPT4ge1xuICAgIGxldCB7IGN0eCwgY29sb3IsIGRlbnNpdHksIGhlaWdodCwgd2lkdGgsIHN0b3JlIH0gPSB0aGlzLnN0YXRlXG5cbiAgICBjdHguc2F2ZSgpXG5cbiAgICBjdHguc2NhbGUoZGVuc2l0eSwgZGVuc2l0eSlcblxuICAgIGN0eC5jbGVhclJlY3QoMCwgMCwgd2lkdGgsIGhlaWdodClcblxuICAgIGN0eC5maWxsU3R5bGUgPSBjb2xvclxuXG4gICAgaWYgKHRoaXMucHJvcHMuYmFja2dyb3VuZCkge1xuICAgICAgY3R4Lmdsb2JhbEFscGhhID0gc3RvcmUuZ2V0VG90YWxPcGFjaXR5KHRoaXMucHJvcHMub3BhY2l0eSlcbiAgICAgIGN0eC5maWxsUmVjdCgwLCAwLCB3aWR0aCwgaGVpZ2h0KVxuICAgIH1cblxuICAgIHN0b3JlLmVhY2godGhpcy5tYWtlQmxvdCwgdGhpcylcblxuICAgIGN0eC5yZXN0b3JlKClcbiAgfVxuXG4gIG1ha2VCbG90IChibG90KSB7XG4gICAgbGV0IHsgY3R4LCBoZWlnaHQsIHdpZHRoIH0gPSB0aGlzLnN0YXRlXG4gICAgbGV0IHsgeCwgeSwgcmFkaXVzIH0gPSBibG90XG5cbiAgICBjdHguZ2xvYmFsQWxwaGEgPSBFcXVhdGlvbnMuZ2V0QmxvdE9wYWNpdHkoYmxvdCwgdGhpcy5wcm9wcy5vcGFjaXR5KVxuICAgIGN0eC5iZWdpblBhdGgoKVxuXG4gICAgaWYgKHRoaXMucHJvcHMucmVjZW50ZXIpIHtcbiAgICAgIGxldCBzaXplID0gTWF0aC5tYXgoaGVpZ2h0LCB3aWR0aClcblxuICAgICAgeCArPSBFcXVhdGlvbnMuZ2V0QmxvdFNoaWZ0WChibG90LCBzaXplLCB3aWR0aClcbiAgICAgIHkgKz0gRXF1YXRpb25zLmdldEJsb3RTaGlmdFkoYmxvdCwgc2l6ZSwgaGVpZ2h0KVxuICAgIH1cblxuICAgIGN0eC5hcmMoeCwgeSwgcmFkaXVzICogRXF1YXRpb25zLmdldEJsb3RTY2FsZShibG90KSwgMCwgVEFVKVxuXG4gICAgY3R4LmNsb3NlUGF0aCgpXG4gICAgY3R4LmZpbGwoKVxuICB9XG5cbiAgY29tcG9uZW50V2lsbFVubW91bnQgKCkge1xuICAgIHRoaXMuc3RhdGUuc3RvcmUuc3RvcCgpXG4gIH1cblxuICBwdXNoQmxvdCAodGltZVN0YW1wLCBjbGllbnRYLCBjbGllbnRZKSB7XG4gICAgbGV0IGVsID0gdGhpcy5yZWZzLmNhbnZhc1xuXG4gICAgLy8gMC4xMyBzdXBwb3J0XG4gICAgaWYgKGVsIGluc3RhbmNlb2Ygd2luZG93LkhUTUxDYW52YXNFbGVtZW50ID09PSBmYWxzZSkge1xuICAgICAgZWwgPSBlbC5nZXRET01Ob2RlKClcbiAgICB9XG5cbiAgICBsZXQgeyB0b3AsIGJvdHRvbSwgbGVmdCwgcmlnaHQgfSA9IGVsLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpXG4gICAgbGV0IHsgY29sb3IgfSA9IHdpbmRvdy5nZXRDb21wdXRlZFN0eWxlKGVsKVxuXG4gICAgbGV0IGN0eCAgICAgPSB0aGlzLnN0YXRlLmN0eCB8fCBlbC5nZXRDb250ZXh0KCcyZCcpXG4gICAgbGV0IGRlbnNpdHkgPSBwaXhlbFJhdGlvKGN0eClcbiAgICBsZXQgaGVpZ2h0ICA9IGJvdHRvbSAtIHRvcFxuICAgIGxldCB3aWR0aCAgID0gcmlnaHQgLSBsZWZ0XG4gICAgbGV0IHJhZGl1cyAgPSBFcXVhdGlvbnMuZ2V0TWF4UmFkaXVzKGhlaWdodCwgd2lkdGgsIHRoaXMucHJvcHMucmFkaXVzKVxuXG4gICAgdGhpcy5zZXRTdGF0ZSh7IGNvbG9yLCBjdHgsIGRlbnNpdHksIGhlaWdodCwgd2lkdGggfSwgKCkgPT4ge1xuICAgICAgdGhpcy5zdGF0ZS5zdG9yZS5hZGQoe1xuICAgICAgICBkdXJhdGlvbiAgOiB0aGlzLnByb3BzLmR1cmF0aW9uLFxuICAgICAgICBtb3VzZURvd24gOiB0aW1lU3RhbXAsXG4gICAgICAgIG1vdXNlVXAgICA6IDAsXG4gICAgICAgIHJhZGl1cyAgICA6IHJhZGl1cyxcbiAgICAgICAgeCAgICAgICAgIDogY2xpZW50WCAtIGxlZnQsXG4gICAgICAgIHkgICAgICAgICA6IGNsaWVudFkgLSB0b3BcbiAgICAgIH0pXG4gICAgfSlcbiAgfVxuXG4gIHJlbmRlciAoKSB7XG4gICAgbGV0IHsgZGVuc2l0eSwgaGVpZ2h0LCB3aWR0aCwgdG91Y2hFdmVudHMgfSA9IHRoaXMuc3RhdGVcblxuICAgIHJldHVybiAoXG4gICAgICA8Y2FudmFzIGNsYXNzTmFtZT1cImlua1wiXG4gICAgICAgICAgICAgIHJlZj1cImNhbnZhc1wiXG4gICAgICAgICAgICAgIHN0eWxlPXt7IC4uLlNUWUxFLCAuLi50aGlzLnByb3BzLnN0eWxlIH19XG4gICAgICAgICAgICAgIGhlaWdodD17IGhlaWdodCAqIGRlbnNpdHkgfVxuICAgICAgICAgICAgICB3aWR0aD17IHdpZHRoICogZGVuc2l0eSB9XG4gICAgICAgICAgICAgIG9uRHJhZ092ZXI9eyB0aGlzLl9vblJlbGVhc2UgfVxuICAgICAgICAgICAgICB7IC4uLnRvdWNoRXZlbnRzIH0gLz5cbiAgICApXG4gIH1cblxuICBfZ2V0Q2VudGVyID0gKCkgPT4ge1xuICAgIGxldCBlbCA9IHRoaXMucmVmcy5jYW52YXNcbiAgICBsZXQgeyB0b3AsIGJvdHRvbSwgbGVmdCwgcmlnaHQgfSA9IGVsLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpXG5cbiAgICByZXR1cm4ge1xuICAgICAgY2xpZW50WDogbGVmdCArIChyaWdodCAtIGxlZnQpIC8gMixcbiAgICAgIGNsaWVudFk6IHRvcCArIChib3R0b20gLSB0b3ApIC8gMixcbiAgICB9XG4gIH1cblxuICBfb25QcmVzcyA9IChlKSA9PiB7XG4gICAgbGV0IHsgY2VudGVyIH0gPSB0aGlzLnByb3BzXG4gICAgbGV0IHsgYnV0dG9uLCBjdHJsS2V5LCBjbGllbnRYLCBjbGllbnRZLCBjaGFuZ2VkVG91Y2hlcyB9ID0gZVxuICAgIGxldCB0aW1lU3RhbXAgPSBEYXRlLm5vdygpXG5cbiAgICBpZiAoY2hhbmdlZFRvdWNoZXMpIHtcbiAgICAgIGlmIChjZW50ZXIpIHtcbiAgICAgICAgbGV0IHsgY2xpZW50WCwgY2xpZW50WSB9ID0gdGhpcy5fZ2V0Q2VudGVyKClcbiAgICAgICAgdGhpcy5wdXNoQmxvdCh0aW1lU3RhbXAsIGNsaWVudFgsIGNsaWVudFkpXG4gICAgICB9IGVsc2Uge1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNoYW5nZWRUb3VjaGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgbGV0IHsgY2xpZW50WCwgY2xpZW50WSB9ID0gY2hhbmdlZFRvdWNoZXNbaV1cbiAgICAgICAgICB0aGlzLnB1c2hCbG90KHRpbWVTdGFtcCwgY2xpZW50WCwgY2xpZW50WSlcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0gZWxzZSBpZiAoYnV0dG9uID09PSBNT1VTRV9MRUZUICYmICFjdHJsS2V5KSB7XG4gICAgICBpZiAoY2VudGVyKSB7XG4gICAgICAgIGxldCB7IGNsaWVudFgsIGNsaWVudFkgfSA9IHRoaXMuX2dldENlbnRlcigpXG4gICAgICAgIGNvbnNvbGUubG9nKGNsaWVudFgsIGNsaWVudFkpXG4gICAgICAgIHRoaXMucHVzaEJsb3QodGltZVN0YW1wLCBjbGllbnRYLCBjbGllbnRZKVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5wdXNoQmxvdCh0aW1lU3RhbXAsIGNsaWVudFgsIGNsaWVudFkpXG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgX29uUmVsZWFzZSA9ICgpID0+IHtcbiAgICB0aGlzLnN0YXRlLnN0b3JlLnJlbGVhc2UoRGF0ZS5ub3coKSlcbiAgfVxuXG59XG5cbm1vZHVsZS5leHBvcnRzID0gSW5rXG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9zcmMvaW5kZXguanMiLCIvKipcbiAqIEB0IGlzIHRoZSBjdXJyZW50IHRpbWUgKG9yIHBvc2l0aW9uKSBvZiB0aGUgdHdlZW4uIFRoaXMgY2FuIGJlIHNlY29uZHMgb3IgZnJhbWVzLCBzdGVwcywgc2Vjb25kcywgbXMsIHdoYXRldmVyIOKAkyBhcyBsb25nIGFzIHRoZSB1bml0IGlzIHRoZSBzYW1lIGFzIGlzIHVzZWQgZm9yIHRoZSB0b3RhbCB0aW1lIFszXS5cbiAqIEBiIGlzIHRoZSBiZWdpbm5pbmcgdmFsdWUgb2YgdGhlIHByb3BlcnR5LlxuICogQGMgaXMgdGhlIGNoYW5nZSBiZXR3ZWVuIHRoZSBiZWdpbm5pbmcgYW5kIGRlc3RpbmF0aW9uIHZhbHVlIG9mIHRoZSBwcm9wZXJ0eS5cbiAqIEBkIGlzIHRoZSB0b3RhbCB0aW1lIG9mIHRoZSB0d2Vlbi5cbiAqL1xuXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIGVhc2VPdXRRdWludCAodCwgYiwgYywgZCkge1xuICByZXR1cm4gYyooKHQ9dC9kLTEpKnQqdCp0KnQgKyAxKSArIGJcbn1cblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL3NyYy91dGlsL2Vhc2luZy5qcyJdLCJzb3VyY2VSb290IjoiIn0=