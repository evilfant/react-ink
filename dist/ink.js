module.exports=function(t){function e(o){if(n[o])return n[o].exports;var r=n[o]={i:o,l:!1,exports:{}};return t[o].call(r.exports,r,r.exports,e),r.l=!0,r.exports}var n={};return e.m=t,e.c=n,e.i=function(t){return t},e.d=function(t,n,o){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:o})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=6)}([function(t,e,n){function o(t){return l(t.duration,Date.now()-t.mouseDown)}function r(t){return t.mouseUp>0?Date.now()-t.mouseUp:0}function i(t){var e=t.duration,n=t.radius,i=.85*a(o(t),0,n,e),u=.15*a(r(t),0,n,e),l=.02*n*c(Date.now()/e);return s(0,i+u+l)}var a=n(7),u=Math.sqrt(2),c=Math.cos,s=Math.max,l=Math.min;t.exports={getMaxRadius:function(t,e,n){return l(.5*s(t,e),n)},getBlotOpacity:function(t,e){return a(r(t),e,-e,t.duration)},getBlotOuterOpacity:function(t,e){return l(this.getBlotOpacity(t,e),a(o(t),0,.3,3*t.duration))},getBlotShiftX:function(t,e,n){return l(1,i(t)/e*2/u)*(n/2-t.x)},getBlotShiftY:function(t,e,n){return l(1,i(t)/e*2/u)*(n/2-t.y)},getBlotScale:function(t){return i(t)/t.radius}}},function(t,e){t.exports={borderRadius:"inherit",height:"100%",left:0,position:"absolute",top:0,width:"100%"}},function(t,e){var n=!1;"undefined"!=typeof window&&(n="ontouchstart"in window||window.DocumentTouch&&document instanceof window.DocumentTouch),t.exports=n},function(t,e){t.exports=function(t){return(window.devicePixelRatio||1)/(t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1)}},function(t,e,n){var o=n(0),r=function(t){var e=t.mouseUp,n=t.duration;return!e||Date.now()-e<n};t.exports=function(t){var e=[],n=!1,i=void 0,a={each:function(t,n){for(var o=0,r=e.length;o<r;o++)t.call(n,e[o])},play:function(){n||(n=!0,a.update())},stop:function(){n=!1,cancelAnimationFrame(i)},getTotalOpacity:function(t){for(var n=0,r=0,i=e.length;r<i;r++)n+=o.getBlotOuterOpacity(e[r],t);return n},update:function(){e=e.filter(r),e.length?i=requestAnimationFrame(a.update):a.stop(),t()},add:function(t){e.push(t),a.play()},release:function(t){for(var n=e.length-1;n>=0;n--)if(!e[n].mouseUp)return e[n].mouseUp=t}};return a}},function(t,e){t.exports=require("react")},function(t,e,n){function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t},u=n(2),c=0,s=n(3),l=n(5),p=n(1),f=n(4),h=2*Math.PI,d=n(0),g=function(t){function e(n){o(this,e);var i=r(this,t.apply(this,arguments));return i.tick=function(){var t=i.state,e=t.ctx,n=t.color,o=t.density,r=t.height,a=t.width,u=t.store;e.save(),e.scale(o,o),e.clearRect(0,0,a,r),e.fillStyle=n,i.props.background&&(e.globalAlpha=u.getTotalOpacity(i.props.opacity),e.fillRect(0,0,a,r)),u.each(i.makeBlot,i),e.restore()},i._getCenter=function(){var t=i.canvas,e=t.getBoundingClientRect(),n=e.top,o=e.bottom,r=e.left;return{clientX:r+(e.right-r)/2,clientY:n+(o-n)/2}},i._onPress=function(t){var e=i.props.center,n=t.button,o=t.ctrlKey,r=t.clientX,a=t.clientY,u=t.changedTouches,s=Date.now();if(u)if(e){var l=i._getCenter(),p=l.clientX,f=l.clientY;i.pushBlot(s,p,f)}else for(var h=0;h<u.length;h++){var d=u[h],g=d.clientX,y=d.clientY;i.pushBlot(s,g,y)}else if(n===c&&!o)if(e){var v=i._getCenter(),w=v.clientX,m=v.clientY;i.pushBlot(s,w,m)}else i.pushBlot(s,r,a)},i._onRelease=function(){i.state.store.release(Date.now())},i.state={color:"transparent",density:1,height:0,store:f(i.tick),touchEvents:i.touchEvents(),width:0},i}return i(e,t),e.prototype.touchEvents=function(){return this.props.hasTouch?{onTouchStart:this._onPress,onTouchEnd:this._onRelease,onTouchCancel:this._onRelease}:{onMouseDown:this._onPress,onMouseUp:this._onRelease,onMouseLeave:this._onRelease}},e.prototype.makeBlot=function(t){var e=this.state,n=e.ctx,o=e.height,r=e.width,i=t.x,a=t.y,u=t.radius;if(n.globalAlpha=d.getBlotOpacity(t,this.props.opacity),n.beginPath(),this.props.recenter){var c=Math.max(o,r);i+=d.getBlotShiftX(t,c,r),a+=d.getBlotShiftY(t,c,o)}n.arc(i,a,u*d.getBlotScale(t),0,h),n.closePath(),n.fill()},e.prototype.componentWillUnmount=function(){this.state.store.stop()},e.prototype.pushBlot=function(t,e,n){var o=this,r=this.canvas;r instanceof window.HTMLCanvasElement==!1&&(r=r.getDOMNode());var i=r.getBoundingClientRect(),a=i.top,u=i.bottom,c=i.left,l=i.right,p=window.getComputedStyle(r),f=p.color,h=this.state.ctx||r.getContext("2d"),g=s(h),y=u-a,v=l-c,w=d.getMaxRadius(y,v,this.props.radius);this.setState({color:f,ctx:h,density:g,height:y,width:v},function(){o.state.store.add({duration:o.props.duration,mouseDown:t,mouseUp:0,radius:w,x:e-c,y:n-a})})},e.prototype.render=function(){var t=this,e=this.state,n=e.density,o=e.height,r=e.width,i=e.touchEvents;return l.createElement("canvas",a({className:"ink",ref:function(e){return t.canvas=e},style:a({},p,this.props.style),height:o*n,width:r*n,onDragOver:this._onRelease},i))},e}(l.PureComponent);g.defaultProps={background:!0,duration:1e3,opacity:.25,radius:150,recenter:!0,hasTouch:u,center:!1},t.exports=g},function(t,e){t.exports=function(t,e,n,o){return n*((t=t/o-1)*t*t*t*t+1)+e}}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vaW5rLmpzIiwid2VicGFjazovLy93ZWJwYWNrL2Jvb3RzdHJhcCBiNmZkZmVlODExODY0NDYwNWU1MyIsIndlYnBhY2s6Ly8vLi9zcmMvdXRpbC9lcXVhdGlvbnMuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL3N0eWxlLmpzIiwid2VicGFjazovLy8uL3NyYy91dGlsL2hhc1RvdWNoLmpzIiwid2VicGFjazovLy8uL3NyYy91dGlsL3BpeGVsUmF0aW8uanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL3V0aWwvc3RvcmUuanMiLCJ3ZWJwYWNrOi8vL2V4dGVybmFsIFwicmVhY3RcIiIsIndlYnBhY2s6Ly8vLi9zcmMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL3V0aWwvZWFzaW5nLmpzIl0sIm5hbWVzIjpbIm1vZHVsZSIsImV4cG9ydHMiLCJtb2R1bGVzIiwiX193ZWJwYWNrX3JlcXVpcmVfXyIsIm1vZHVsZUlkIiwiaW5zdGFsbGVkTW9kdWxlcyIsImkiLCJsIiwiY2FsbCIsIm0iLCJjIiwidmFsdWUiLCJkIiwibmFtZSIsImdldHRlciIsIm8iLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImNvbmZpZ3VyYWJsZSIsImVudW1lcmFibGUiLCJnZXQiLCJuIiwiX19lc01vZHVsZSIsIm9iamVjdCIsInByb3BlcnR5IiwicHJvdG90eXBlIiwiaGFzT3duUHJvcGVydHkiLCJwIiwicyIsImdldFByZXNzIiwiYmxvdCIsIm1pbiIsImR1cmF0aW9uIiwiRGF0ZSIsIm5vdyIsIm1vdXNlRG93biIsImdldFJlbGVhc2UiLCJtb3VzZVVwIiwiZ2V0UmFkaXVzIiwicmFkaXVzIiwiZG93biIsImVhc2luZyIsInVwIiwidW5kdWxhdGlvbiIsImNvcyIsIm1heCIsIlNRUlRfMiIsIk1hdGgiLCJzcXJ0IiwiZ2V0TWF4UmFkaXVzIiwiaGVpZ2h0Iiwid2lkdGgiLCJnZXRCbG90T3BhY2l0eSIsIm9wYWNpdHkiLCJnZXRCbG90T3V0ZXJPcGFjaXR5IiwidGhpcyIsImdldEJsb3RTaGlmdFgiLCJzaXplIiwieCIsImdldEJsb3RTaGlmdFkiLCJ5IiwiZ2V0QmxvdFNjYWxlIiwiYm9yZGVyUmFkaXVzIiwibGVmdCIsInBvc2l0aW9uIiwidG9wIiwiYm9vbCIsIndpbmRvdyIsIkRvY3VtZW50VG91Y2giLCJkb2N1bWVudCIsImNvbnRleHQiLCJkZXZpY2VQaXhlbFJhdGlvIiwid2Via2l0QmFja2luZ1N0b3JlUGl4ZWxSYXRpbyIsIm1vekJhY2tpbmdTdG9yZVBpeGVsUmF0aW8iLCJtc0JhY2tpbmdTdG9yZVBpeGVsUmF0aW8iLCJvQmFja2luZ1N0b3JlUGl4ZWxSYXRpbyIsImJhY2tpbmdTdG9yZVBpeGVsUmF0aW8iLCJFcXVhdGlvbnMiLCJraWxsU3RhbGUiLCJfcmVmIiwicHVibGljaXplIiwiX2RhdGEiLCJfcGxheWluZyIsIl9mcmFtZSIsIlN0b3JlIiwiZWFjaCIsImNhbGxiYWNrIiwic2NvcGUiLCJsZW5ndGgiLCJwbGF5IiwidXBkYXRlIiwic3RvcCIsImNhbmNlbEFuaW1hdGlvbkZyYW1lIiwiZ2V0VG90YWxPcGFjaXR5IiwiYW5zd2VyIiwiZmlsdGVyIiwicmVxdWVzdEFuaW1hdGlvbkZyYW1lIiwiYWRkIiwicHJvcHMiLCJwdXNoIiwicmVsZWFzZSIsInRpbWUiLCJyZXF1aXJlIiwiX2NsYXNzQ2FsbENoZWNrIiwiaW5zdGFuY2UiLCJDb25zdHJ1Y3RvciIsIlR5cGVFcnJvciIsIl9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuIiwic2VsZiIsIlJlZmVyZW5jZUVycm9yIiwiX2luaGVyaXRzIiwic3ViQ2xhc3MiLCJzdXBlckNsYXNzIiwiY3JlYXRlIiwiY29uc3RydWN0b3IiLCJ3cml0YWJsZSIsInNldFByb3RvdHlwZU9mIiwiX19wcm90b19fIiwiX2V4dGVuZHMiLCJhc3NpZ24iLCJ0YXJnZXQiLCJhcmd1bWVudHMiLCJzb3VyY2UiLCJrZXkiLCJIQVNfVE9VQ0giLCJNT1VTRV9MRUZUIiwicGl4ZWxSYXRpbyIsIlJlYWN0IiwiU1RZTEUiLCJUQVUiLCJQSSIsIkluayIsIl9SZWFjdCRQdXJlQ29tcG9uZW50IiwiX3RoaXMiLCJhcHBseSIsInRpY2siLCJfdGhpcyRzdGF0ZSIsInN0YXRlIiwiY3R4IiwiY29sb3IiLCJkZW5zaXR5Iiwic3RvcmUiLCJzYXZlIiwic2NhbGUiLCJjbGVhclJlY3QiLCJmaWxsU3R5bGUiLCJiYWNrZ3JvdW5kIiwiZ2xvYmFsQWxwaGEiLCJmaWxsUmVjdCIsIm1ha2VCbG90IiwicmVzdG9yZSIsIl9nZXRDZW50ZXIiLCJlbCIsImNhbnZhcyIsIl9lbCRnZXRCb3VuZGluZ0NsaWVudCIsImdldEJvdW5kaW5nQ2xpZW50UmVjdCIsImJvdHRvbSIsImNsaWVudFgiLCJyaWdodCIsImNsaWVudFkiLCJfb25QcmVzcyIsImUiLCJjZW50ZXIiLCJidXR0b24iLCJjdHJsS2V5IiwiY2hhbmdlZFRvdWNoZXMiLCJ0aW1lU3RhbXAiLCJfdGhpcyRfZ2V0Q2VudGVyIiwicHVzaEJsb3QiLCJfY2hhbmdlZFRvdWNoZXMkaSIsIl90aGlzJF9nZXRDZW50ZXIyIiwiX29uUmVsZWFzZSIsInRvdWNoRXZlbnRzIiwiaGFzVG91Y2giLCJvblRvdWNoU3RhcnQiLCJvblRvdWNoRW5kIiwib25Ub3VjaENhbmNlbCIsIm9uTW91c2VEb3duIiwib25Nb3VzZVVwIiwib25Nb3VzZUxlYXZlIiwiX3N0YXRlIiwiYmVnaW5QYXRoIiwicmVjZW50ZXIiLCJhcmMiLCJjbG9zZVBhdGgiLCJmaWxsIiwiY29tcG9uZW50V2lsbFVubW91bnQiLCJfdGhpczIiLCJIVE1MQ2FudmFzRWxlbWVudCIsImdldERPTU5vZGUiLCJfZWwkZ2V0Qm91bmRpbmdDbGllbnQyIiwiX3dpbmRvdyRnZXRDb21wdXRlZFN0IiwiZ2V0Q29tcHV0ZWRTdHlsZSIsImdldENvbnRleHQiLCJzZXRTdGF0ZSIsInJlbmRlciIsIl90aGlzMyIsIl9zdGF0ZTIiLCJjcmVhdGVFbGVtZW50IiwiY2xhc3NOYW1lIiwicmVmIiwic3R5bGUiLCJvbkRyYWdPdmVyIiwiUHVyZUNvbXBvbmVu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LEVBQU00RSxjQUFsQnhFLEdBRUd5RSxjQUNMMUQsWUFBYSxFQUNibEgsU0FBYSxJQUNicUIsUUFBYSxJQUNiZCxPQUFhLElBQ2IrSSxVQUFhLEVBQ2JULFNBQWFqRCxFQUNic0MsUUFBYSxHQWlLakJsSyxFQUFPQyxRQUFVa0ksR1JzVFgsU0FBVW5JLEVBQVFDLEdTeGV4QkQsRUFBT0MsUUFBVSxTQUF1QjRNLEVBQUdDLEVBQUdwTSxFQUFHRSxHQUMvQyxNQUFPRixLQUFJbU0sRUFBRUEsRUFBRWpNLEVBQUUsR0FBR2lNLEVBQUVBLEVBQUVBLEVBQUVBLEVBQUksR0FBS0MiLCJmaWxlIjoiaW5rLmpzIiwic291cmNlc0NvbnRlbnQiOlsibW9kdWxlLmV4cG9ydHMgPVxuLyoqKioqKi8gKGZ1bmN0aW9uKG1vZHVsZXMpIHsgLy8gd2VicGFja0Jvb3RzdHJhcFxuLyoqKioqKi8gXHQvLyBUaGUgbW9kdWxlIGNhY2hlXG4vKioqKioqLyBcdHZhciBpbnN0YWxsZWRNb2R1bGVzID0ge307XG4vKioqKioqL1xuLyoqKioqKi8gXHQvLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuLyoqKioqKi8gXHRmdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG4vKioqKioqL1xuLyoqKioqKi8gXHRcdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuLyoqKioqKi8gXHRcdGlmKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKSB7XG4vKioqKioqLyBcdFx0XHRyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0cztcbi8qKioqKiovIFx0XHR9XG4vKioqKioqLyBcdFx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcbi8qKioqKiovIFx0XHR2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7XG4vKioqKioqLyBcdFx0XHRpOiBtb2R1bGVJZCxcbi8qKioqKiovIFx0XHRcdGw6IGZhbHNlLFxuLyoqKioqKi8gXHRcdFx0ZXhwb3J0czoge31cbi8qKioqKiovIFx0XHR9O1xuLyoqKioqKi9cbi8qKioqKiovIFx0XHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cbi8qKioqKiovIFx0XHRtb2R1bGVzW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcbi8qKioqKiovXG4vKioqKioqLyBcdFx0Ly8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZFxuLyoqKioqKi8gXHRcdG1vZHVsZS5sID0gdHJ1ZTtcbi8qKioqKiovXG4vKioqKioqLyBcdFx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcbi8qKioqKiovIFx0XHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG4vKioqKioqLyBcdH1cbi8qKioqKiovXG4vKioqKioqL1xuLyoqKioqKi8gXHQvLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKVxuLyoqKioqKi8gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzO1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGUgY2FjaGVcbi8qKioqKiovIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5jID0gaW5zdGFsbGVkTW9kdWxlcztcbi8qKioqKiovXG4vKioqKioqLyBcdC8vIGlkZW50aXR5IGZ1bmN0aW9uIGZvciBjYWxsaW5nIGhhcm1vbnkgaW1wb3J0cyB3aXRoIHRoZSBjb3JyZWN0IGNvbnRleHRcbi8qKioqKiovIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5pID0gZnVuY3Rpb24odmFsdWUpIHsgcmV0dXJuIHZhbHVlOyB9O1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gZGVmaW5lIGdldHRlciBmdW5jdGlvbiBmb3IgaGFybW9ueSBleHBvcnRzXG4vKioqKioqLyBcdF9fd2VicGFja19yZXF1aXJlX18uZCA9IGZ1bmN0aW9uKGV4cG9ydHMsIG5hbWUsIGdldHRlcikge1xuLyoqKioqKi8gXHRcdGlmKCFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywgbmFtZSkpIHtcbi8qKioqKiovIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBuYW1lLCB7XG4vKioqKioqLyBcdFx0XHRcdGNvbmZpZ3VyYWJsZTogZmFsc2UsXG4vKioqKioqLyBcdFx0XHRcdGVudW1lcmFibGU6IHRydWUsXG4vKioqKioqLyBcdFx0XHRcdGdldDogZ2V0dGVyXG4vKioqKioqLyBcdFx0XHR9KTtcbi8qKioqKiovIFx0XHR9XG4vKioqKioqLyBcdH07XG4vKioqKioqL1xuLyoqKioqKi8gXHQvLyBnZXREZWZhdWx0RXhwb3J0IGZ1bmN0aW9uIGZvciBjb21wYXRpYmlsaXR5IHdpdGggbm9uLWhhcm1vbnkgbW9kdWxlc1xuLyoqKioqKi8gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm4gPSBmdW5jdGlvbihtb2R1bGUpIHtcbi8qKioqKiovIFx0XHR2YXIgZ2V0dGVyID0gbW9kdWxlICYmIG1vZHVsZS5fX2VzTW9kdWxlID9cbi8qKioqKiovIFx0XHRcdGZ1bmN0aW9uIGdldERlZmF1bHQoKSB7IHJldHVybiBtb2R1bGVbJ2RlZmF1bHQnXTsgfSA6XG4vKioqKioqLyBcdFx0XHRmdW5jdGlvbiBnZXRNb2R1bGVFeHBvcnRzKCkgeyByZXR1cm4gbW9kdWxlOyB9O1xuLyoqKioqKi8gXHRcdF9fd2VicGFja19yZXF1aXJlX18uZChnZXR0ZXIsICdhJywgZ2V0dGVyKTtcbi8qKioqKiovIFx0XHRyZXR1cm4gZ2V0dGVyO1xuLyoqKioqKi8gXHR9O1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsXG4vKioqKioqLyBcdF9fd2VicGFja19yZXF1aXJlX18ubyA9IGZ1bmN0aW9uKG9iamVjdCwgcHJvcGVydHkpIHsgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmplY3QsIHByb3BlcnR5KTsgfTtcbi8qKioqKiovXG4vKioqKioqLyBcdC8vIF9fd2VicGFja19wdWJsaWNfcGF0aF9fXG4vKioqKioqLyBcdF9fd2VicGFja19yZXF1aXJlX18ucCA9IFwiXCI7XG4vKioqKioqL1xuLyoqKioqKi8gXHQvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbi8qKioqKiovIFx0cmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oX193ZWJwYWNrX3JlcXVpcmVfXy5zID0gNik7XG4vKioqKioqLyB9KVxuLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbi8qKioqKiovIChbXG4vKiAwICovXG4vKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cbnZhciBlYXNpbmcgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDcpO1xudmFyIFNRUlRfMiA9IE1hdGguc3FydCgyKTtcbnZhciBjb3MgPSBNYXRoLmNvcyxcbiAgICBtYXggPSBNYXRoLm1heCxcbiAgICBtaW4gPSBNYXRoLm1pbjtcblxuXG5mdW5jdGlvbiBnZXRQcmVzcyhibG90KSB7XG4gIHJldHVybiBtaW4oYmxvdC5kdXJhdGlvbiwgRGF0ZS5ub3coKSAtIGJsb3QubW91c2VEb3duKTtcbn1cblxuZnVuY3Rpb24gZ2V0UmVsZWFzZShibG90KSB7XG4gIHJldHVybiBibG90Lm1vdXNlVXAgPiAwID8gRGF0ZS5ub3coKSAtIGJsb3QubW91c2VVcCA6IDA7XG59XG5cbmZ1bmN0aW9uIGdldFJhZGl1cyhibG90KSB7XG4gIHZhciBkdXJhdGlvbiA9IGJsb3QuZHVyYXRpb24sXG4gICAgICByYWRpdXMgPSBibG90LnJhZGl1cztcblxuXG4gIHZhciBkb3duID0gZWFzaW5nKGdldFByZXNzKGJsb3QpLCAwLCByYWRpdXMsIGR1cmF0aW9uKSAqIDAuODU7XG4gIHZhciB1cCA9IGVhc2luZyhnZXRSZWxlYXNlKGJsb3QpLCAwLCByYWRpdXMsIGR1cmF0aW9uKSAqIDAuMTU7XG4gIHZhciB1bmR1bGF0aW9uID0gcmFkaXVzICogMC4wMiAqIGNvcyhEYXRlLm5vdygpIC8gZHVyYXRpb24pO1xuXG4gIHJldHVybiBtYXgoMCwgZG93biArIHVwICsgdW5kdWxhdGlvbik7XG59XG5cbm1vZHVsZS5leHBvcnRzID0ge1xuICBnZXRNYXhSYWRpdXM6IGZ1bmN0aW9uIGdldE1heFJhZGl1cyhoZWlnaHQsIHdpZHRoLCByYWRpdXMpIHtcbiAgICByZXR1cm4gbWluKG1heChoZWlnaHQsIHdpZHRoKSAqIDAuNSwgcmFkaXVzKTtcbiAgfSxcbiAgZ2V0QmxvdE9wYWNpdHk6IGZ1bmN0aW9uIGdldEJsb3RPcGFjaXR5KGJsb3QsIG9wYWNpdHkpIHtcbiAgICByZXR1cm4gZWFzaW5nKGdldFJlbGVhc2UoYmxvdCksIG9wYWNpdHksIC1vcGFjaXR5LCBibG90LmR1cmF0aW9uKTtcbiAgfSxcbiAgZ2V0QmxvdE91dGVyT3BhY2l0eTogZnVuY3Rpb24gZ2V0QmxvdE91dGVyT3BhY2l0eShibG90LCBvcGFjaXR5KSB7XG4gICAgcmV0dXJuIG1pbih0aGlzLmdldEJsb3RPcGFjaXR5KGJsb3QsIG9wYWNpdHkpLCBlYXNpbmcoZ2V0UHJlc3MoYmxvdCksIDAsIDAuMywgYmxvdC5kdXJhdGlvbiAqIDMpKTtcbiAgfSxcbiAgZ2V0QmxvdFNoaWZ0WDogZnVuY3Rpb24gZ2V0QmxvdFNoaWZ0WChibG90LCBzaXplLCB3aWR0aCkge1xuICAgIHJldHVybiBtaW4oMSwgZ2V0UmFkaXVzKGJsb3QpIC8gc2l6ZSAqIDIgLyBTUVJUXzIpICogKHdpZHRoIC8gMiAtIGJsb3QueCk7XG4gIH0sXG4gIGdldEJsb3RTaGlmdFk6IGZ1bmN0aW9uIGdldEJsb3RTaGlmdFkoYmxvdCwgc2l6ZSwgaGVpZ2h0KSB7XG4gICAgcmV0dXJuIG1pbigxLCBnZXRSYWRpdXMoYmxvdCkgLyBzaXplICogMiAvIFNRUlRfMikgKiAoaGVpZ2h0IC8gMiAtIGJsb3QueSk7XG4gIH0sXG4gIGdldEJsb3RTY2FsZTogZnVuY3Rpb24gZ2V0QmxvdFNjYWxlKGJsb3QpIHtcbiAgICByZXR1cm4gZ2V0UmFkaXVzKGJsb3QpIC8gYmxvdC5yYWRpdXM7XG4gIH1cbn07XG5cbi8qKiovIH0pLFxuLyogMSAqL1xuLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykge1xuXG5tb2R1bGUuZXhwb3J0cyA9IHtcbiAgYm9yZGVyUmFkaXVzOiAnaW5oZXJpdCcsXG4gIGhlaWdodDogJzEwMCUnLFxuICBsZWZ0OiAwLFxuICBwb3NpdGlvbjogJ2Fic29sdXRlJyxcbiAgdG9wOiAwLFxuICB3aWR0aDogJzEwMCUnXG59O1xuXG4vKioqLyB9KSxcbi8qIDIgKi9cbi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHtcblxudmFyIGJvb2wgPSBmYWxzZTtcblxuaWYgKHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnKSB7XG4gIGJvb2wgPSAnb250b3VjaHN0YXJ0JyBpbiB3aW5kb3cgfHwgd2luZG93LkRvY3VtZW50VG91Y2ggJiYgZG9jdW1lbnQgaW5zdGFuY2VvZiB3aW5kb3cuRG9jdW1lbnRUb3VjaDtcbn1cblxubW9kdWxlLmV4cG9ydHMgPSBib29sO1xuXG4vKioqLyB9KSxcbi8qIDMgKi9cbi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHtcblxuLy8gR29vZCBzdHVmZiBoZXJlOlxuLy8gaHR0cDovL3d3dy5odG1sNXJvY2tzLmNvbS9lbi90dXRvcmlhbHMvY2FudmFzL2hpZHBpL1xuXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChjb250ZXh0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZGV2aWNlUGl4ZWxSYXRpbyA9IHdpbmRvdy5kZXZpY2VQaXhlbFJhdGlvIHx8IDE7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgYmFja2luZ1N0b3JlUmF0aW8gPSBjb250ZXh0LndlYmtpdEJhY2tpbmdTdG9yZVBpeGVsUmF0aW8gfHwgY29udGV4dC5tb3pCYWNraW5nU3RvcmVQaXhlbFJhdGlvIHx8IGNvbnRleHQubXNCYWNraW5nU3RvcmVQaXhlbFJhdGlvIHx8IGNvbnRleHQub0JhY2tpbmdTdG9yZVBpeGVsUmF0aW8gfHwgY29udGV4dC5iYWNraW5nU3RvcmVQaXhlbFJhdGlvIHx8IDE7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBkZXZpY2VQaXhlbFJhdGlvIC8gYmFja2luZ1N0b3JlUmF0aW87XG59O1xuXG4vKioqLyB9KSxcbi8qIDQgKi9cbi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuLyoqXG4gKiBJbmsgU3RvcmVcbiAqIEtlZXBzIHRyYWNrIG9mIGNoYW5nZXMgdG8gcmlwcGxlIGVwaWNlbnRlcnNcbiAqIHNvIHRoYXQgPEluayAvPiBjYW4gZm9jdXMgb24gcmVuZGVyaW5nIHRoZW0uXG4gKi9cblxudmFyIEVxdWF0aW9ucyA9IF9fd2VicGFja19yZXF1aXJlX18oMCk7XG5cbnZhciBraWxsU3RhbGUgPSBmdW5jdGlvbiBraWxsU3RhbGUoX3JlZikge1xuICB2YXIgbW91c2VVcCA9IF9yZWYubW91c2VVcCxcbiAgICAgIGR1cmF0aW9uID0gX3JlZi5kdXJhdGlvbjtcbiAgcmV0dXJuICFtb3VzZVVwIHx8IERhdGUubm93KCkgLSBtb3VzZVVwIDwgZHVyYXRpb247XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChwdWJsaWNpemUpIHtcbiAgdmFyIF9kYXRhID0gW107XG4gIHZhciBfcGxheWluZyA9IGZhbHNlO1xuICB2YXIgX2ZyYW1lID0gdm9pZCAwO1xuXG4gIHZhciBTdG9yZSA9IHtcbiAgICBlYWNoOiBmdW5jdGlvbiBlYWNoKGNhbGxiYWNrLCBzY29wZSkge1xuICAgICAgZm9yICh2YXIgaSA9IDAsIGwgPSBfZGF0YS5sZW5ndGg7IGkgPCBsOyBpKyspIHtcbiAgICAgICAgY2FsbGJhY2suY2FsbChzY29wZSwgX2RhdGFbaV0pO1xuICAgICAgfVxuICAgIH0sXG4gICAgcGxheTogZnVuY3Rpb24gcGxheSgpIHtcbiAgICAgIGlmICghX3BsYXlpbmcpIHtcbiAgICAgICAgX3BsYXlpbmcgPSB0cnVlO1xuICAgICAgICBTdG9yZS51cGRhdGUoKTtcbiAgICAgIH1cbiAgICB9LFxuICAgIHN0b3A6IGZ1bmN0aW9uIHN0b3AoKSB7XG4gICAgICBfcGxheWluZyA9IGZhbHNlO1xuICAgICAgY2FuY2VsQW5pbWF0aW9uRnJhbWUoX2ZyYW1lKTtcbiAgICB9LFxuICAgIGdldFRvdGFsT3BhY2l0eTogZnVuY3Rpb24gZ2V0VG90YWxPcGFjaXR5KG9wYWNpdHkpIHtcbiAgICAgIHZhciBhbnN3ZXIgPSAwO1xuXG4gICAgICBmb3IgKHZhciBpID0gMCwgbCA9IF9kYXRhLmxlbmd0aDsgaSA8IGw7IGkrKykge1xuICAgICAgICBhbnN3ZXIgKz0gRXF1YXRpb25zLmdldEJsb3RPdXRlck9wYWNpdHkoX2RhdGFbaV0sIG9wYWNpdHkpO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gYW5zd2VyO1xuICAgIH0sXG4gICAgdXBkYXRlOiBmdW5jdGlvbiB1cGRhdGUoKSB7XG4gICAgICBfZGF0YSA9IF9kYXRhLmZpbHRlcihraWxsU3RhbGUpO1xuXG4gICAgICBpZiAoX2RhdGEubGVuZ3RoKSB7XG4gICAgICAgIF9mcmFtZSA9IHJlcXVlc3RBbmltYXRpb25GcmFtZShTdG9yZS51cGRhdGUpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgU3RvcmUuc3RvcCgpO1xuICAgICAgfVxuXG4gICAgICBwdWJsaWNpemUoKTtcbiAgICB9LFxuICAgIGFkZDogZnVuY3Rpb24gYWRkKHByb3BzKSB7XG4gICAgICBfZGF0YS5wdXNoKHByb3BzKTtcbiAgICAgIFN0b3JlLnBsYXkoKTtcbiAgICB9LFxuICAgIHJlbGVhc2U6IGZ1bmN0aW9uIHJlbGVhc2UodGltZSkge1xuICAgICAgZm9yICh2YXIgaSA9IF9kYXRhLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSB7XG4gICAgICAgIGlmICghX2RhdGFbaV0ubW91c2VVcCkge1xuICAgICAgICAgIHJldHVybiBfZGF0YVtpXS5tb3VzZVVwID0gdGltZTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfTtcblxuICByZXR1cm4gU3RvcmU7XG59O1xuXG4vKioqLyB9KSxcbi8qIDUgKi9cbi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHtcblxubW9kdWxlLmV4cG9ydHMgPSByZXF1aXJlKFwicmVhY3RcIik7XG5cbi8qKiovIH0pLFxuLyogNiAqL1xuLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXG52YXIgX2V4dGVuZHMgPSBPYmplY3QuYXNzaWduIHx8IGZ1bmN0aW9uICh0YXJnZXQpIHsgZm9yICh2YXIgaSA9IDE7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspIHsgdmFyIHNvdXJjZSA9IGFyZ3VtZW50c1tpXTsgZm9yICh2YXIga2V5IGluIHNvdXJjZSkgeyBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHNvdXJjZSwga2V5KSkgeyB0YXJnZXRba2V5XSA9IHNvdXJjZVtrZXldOyB9IH0gfSByZXR1cm4gdGFyZ2V0OyB9O1xuXG5mdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIik7IH0gfVxuXG5mdW5jdGlvbiBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybihzZWxmLCBjYWxsKSB7IGlmICghc2VsZikgeyB0aHJvdyBuZXcgUmVmZXJlbmNlRXJyb3IoXCJ0aGlzIGhhc24ndCBiZWVuIGluaXRpYWxpc2VkIC0gc3VwZXIoKSBoYXNuJ3QgYmVlbiBjYWxsZWRcIik7IH0gcmV0dXJuIGNhbGwgJiYgKHR5cGVvZiBjYWxsID09PSBcIm9iamVjdFwiIHx8IHR5cGVvZiBjYWxsID09PSBcImZ1bmN0aW9uXCIpID8gY2FsbCA6IHNlbGY7IH1cblxuZnVuY3Rpb24gX2luaGVyaXRzKHN1YkNsYXNzLCBzdXBlckNsYXNzKSB7IGlmICh0eXBlb2Ygc3VwZXJDbGFzcyAhPT0gXCJmdW5jdGlvblwiICYmIHN1cGVyQ2xhc3MgIT09IG51bGwpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIlN1cGVyIGV4cHJlc3Npb24gbXVzdCBlaXRoZXIgYmUgbnVsbCBvciBhIGZ1bmN0aW9uLCBub3QgXCIgKyB0eXBlb2Ygc3VwZXJDbGFzcyk7IH0gc3ViQ2xhc3MucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShzdXBlckNsYXNzICYmIHN1cGVyQ2xhc3MucHJvdG90eXBlLCB7IGNvbnN0cnVjdG9yOiB7IHZhbHVlOiBzdWJDbGFzcywgZW51bWVyYWJsZTogZmFsc2UsIHdyaXRhYmxlOiB0cnVlLCBjb25maWd1cmFibGU6IHRydWUgfSB9KTsgaWYgKHN1cGVyQ2xhc3MpIE9iamVjdC5zZXRQcm90b3R5cGVPZiA/IE9iamVjdC5zZXRQcm90b3R5cGVPZihzdWJDbGFzcywgc3VwZXJDbGFzcykgOiBzdWJDbGFzcy5fX3Byb3RvX18gPSBzdXBlckNsYXNzOyB9XG5cbi8qKlxuICogSW5rXG4gKiBGaWxscyBhIGNvbnRhaW5lciB3aXRoIGFuIFNWRyBvYmplY3QgdGhhdCBwcm92aWRlcyBmZWVkYmFjayBvbiBtb3VzZS90b3VjaFxuICogZXZlbnRzIHdpdGggYSByaXBwbGluZyBwb29sLlxuICovXG5cbnZhciBIQVNfVE9VQ0ggPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDIpO1xudmFyIE1PVVNFX0xFRlQgPSAwO1xudmFyIHBpeGVsUmF0aW8gPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpO1xudmFyIFJlYWN0ID0gX193ZWJwYWNrX3JlcXVpcmVfXyg1KTtcbnZhciBTVFlMRSA9IF9fd2VicGFja19yZXF1aXJlX18oMSk7XG52YXIgU3RvcmUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQpO1xudmFyIFRBVSA9IE1hdGguUEkgKiAyO1xudmFyIEVxdWF0aW9ucyA9IF9fd2VicGFja19yZXF1aXJlX18oMCk7XG5cbnZhciBJbmsgPSBmdW5jdGlvbiAoX1JlYWN0JFB1cmVDb21wb25lbnQpIHtcbiAgX2luaGVyaXRzKEluaywgX1JlYWN0JFB1cmVDb21wb25lbnQpO1xuXG4gIGZ1bmN0aW9uIEluayhwcm9wcykge1xuICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBJbmspO1xuXG4gICAgdmFyIF90aGlzID0gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4odGhpcywgX1JlYWN0JFB1cmVDb21wb25lbnQuYXBwbHkodGhpcywgYXJndW1lbnRzKSk7XG5cbiAgICBfdGhpcy50aWNrID0gZnVuY3Rpb24gKCkge1xuICAgICAgdmFyIF90aGlzJHN0YXRlID0gX3RoaXMuc3RhdGUsXG4gICAgICAgICAgY3R4ID0gX3RoaXMkc3RhdGUuY3R4LFxuICAgICAgICAgIGNvbG9yID0gX3RoaXMkc3RhdGUuY29sb3IsXG4gICAgICAgICAgZGVuc2l0eSA9IF90aGlzJHN0YXRlLmRlbnNpdHksXG4gICAgICAgICAgaGVpZ2h0ID0gX3RoaXMkc3RhdGUuaGVpZ2h0LFxuICAgICAgICAgIHdpZHRoID0gX3RoaXMkc3RhdGUud2lkdGgsXG4gICAgICAgICAgc3RvcmUgPSBfdGhpcyRzdGF0ZS5zdG9yZTtcblxuXG4gICAgICBjdHguc2F2ZSgpO1xuXG4gICAgICBjdHguc2NhbGUoZGVuc2l0eSwgZGVuc2l0eSk7XG5cbiAgICAgIGN0eC5jbGVhclJlY3QoMCwgMCwgd2lkdGgsIGhlaWdodCk7XG5cbiAgICAgIGN0eC5maWxsU3R5bGUgPSBjb2xvcjtcblxuICAgICAgaWYgKF90aGlzLnByb3BzLmJhY2tncm91bmQpIHtcbiAgICAgICAgY3R4Lmdsb2JhbEFscGhhID0gc3RvcmUuZ2V0VG90YWxPcGFjaXR5KF90aGlzLnByb3BzLm9wYWNpdHkpO1xuICAgICAgICBjdHguZmlsbFJlY3QoMCwgMCwgd2lkdGgsIGhlaWdodCk7XG4gICAgICB9XG5cbiAgICAgIHN0b3JlLmVhY2goX3RoaXMubWFrZUJsb3QsIF90aGlzKTtcblxuICAgICAgY3R4LnJlc3RvcmUoKTtcbiAgICB9O1xuXG4gICAgX3RoaXMuX2dldENlbnRlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHZhciBlbCA9IF90aGlzLmNhbnZhcztcblxuICAgICAgdmFyIF9lbCRnZXRCb3VuZGluZ0NsaWVudCA9IGVsLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLFxuICAgICAgICAgIHRvcCA9IF9lbCRnZXRCb3VuZGluZ0NsaWVudC50b3AsXG4gICAgICAgICAgYm90dG9tID0gX2VsJGdldEJvdW5kaW5nQ2xpZW50LmJvdHRvbSxcbiAgICAgICAgICBsZWZ0ID0gX2VsJGdldEJvdW5kaW5nQ2xpZW50LmxlZnQsXG4gICAgICAgICAgcmlnaHQgPSBfZWwkZ2V0Qm91bmRpbmdDbGllbnQucmlnaHQ7XG5cbiAgICAgIHJldHVybiB7XG4gICAgICAgIGNsaWVudFg6IGxlZnQgKyAocmlnaHQgLSBsZWZ0KSAvIDIsXG4gICAgICAgIGNsaWVudFk6IHRvcCArIChib3R0b20gLSB0b3ApIC8gMlxuICAgICAgfTtcbiAgICB9O1xuXG4gICAgX3RoaXMuX29uUHJlc3MgPSBmdW5jdGlvbiAoZSkge1xuICAgICAgdmFyIGNlbnRlciA9IF90aGlzLnByb3BzLmNlbnRlcjtcbiAgICAgIHZhciBidXR0b24gPSBlLmJ1dHRvbixcbiAgICAgICAgICBjdHJsS2V5ID0gZS5jdHJsS2V5LFxuICAgICAgICAgIGNsaWVudFggPSBlLmNsaWVudFgsXG4gICAgICAgICAgY2xpZW50WSA9IGUuY2xpZW50WSxcbiAgICAgICAgICBjaGFuZ2VkVG91Y2hlcyA9IGUuY2hhbmdlZFRvdWNoZXM7XG5cbiAgICAgIHZhciB0aW1lU3RhbXAgPSBEYXRlLm5vdygpO1xuXG4gICAgICBpZiAoY2hhbmdlZFRvdWNoZXMpIHtcbiAgICAgICAgaWYgKGNlbnRlcikge1xuICAgICAgICAgIHZhciBfdGhpcyRfZ2V0Q2VudGVyID0gX3RoaXMuX2dldENlbnRlcigpLFxuICAgICAgICAgICAgICBfY2xpZW50WCA9IF90aGlzJF9nZXRDZW50ZXIuY2xpZW50WCxcbiAgICAgICAgICAgICAgX2NsaWVudFkgPSBfdGhpcyRfZ2V0Q2VudGVyLmNsaWVudFk7XG5cbiAgICAgICAgICBfdGhpcy5wdXNoQmxvdCh0aW1lU3RhbXAsIF9jbGllbnRYLCBfY2xpZW50WSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjaGFuZ2VkVG91Y2hlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIF9jaGFuZ2VkVG91Y2hlcyRpID0gY2hhbmdlZFRvdWNoZXNbaV0sXG4gICAgICAgICAgICAgICAgX2NsaWVudFgyID0gX2NoYW5nZWRUb3VjaGVzJGkuY2xpZW50WCxcbiAgICAgICAgICAgICAgICBfY2xpZW50WTIgPSBfY2hhbmdlZFRvdWNoZXMkaS5jbGllbnRZO1xuXG4gICAgICAgICAgICBfdGhpcy5wdXNoQmxvdCh0aW1lU3RhbXAsIF9jbGllbnRYMiwgX2NsaWVudFkyKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSBpZiAoYnV0dG9uID09PSBNT1VTRV9MRUZUICYmICFjdHJsS2V5KSB7XG4gICAgICAgIGlmIChjZW50ZXIpIHtcbiAgICAgICAgICB2YXIgX3RoaXMkX2dldENlbnRlcjIgPSBfdGhpcy5fZ2V0Q2VudGVyKCksXG4gICAgICAgICAgICAgIF9jbGllbnRYMyA9IF90aGlzJF9nZXRDZW50ZXIyLmNsaWVudFgsXG4gICAgICAgICAgICAgIF9jbGllbnRZMyA9IF90aGlzJF9nZXRDZW50ZXIyLmNsaWVudFk7XG5cbiAgICAgICAgICBfdGhpcy5wdXNoQmxvdCh0aW1lU3RhbXAsIF9jbGllbnRYMywgX2NsaWVudFkzKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBfdGhpcy5wdXNoQmxvdCh0aW1lU3RhbXAsIGNsaWVudFgsIGNsaWVudFkpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfTtcblxuICAgIF90aGlzLl9vblJlbGVhc2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgICBfdGhpcy5zdGF0ZS5zdG9yZS5yZWxlYXNlKERhdGUubm93KCkpO1xuICAgIH07XG5cbiAgICBfdGhpcy5zdGF0ZSA9IHtcbiAgICAgIGNvbG9yOiAndHJhbnNwYXJlbnQnLFxuICAgICAgZGVuc2l0eTogMSxcbiAgICAgIGhlaWdodDogMCxcbiAgICAgIHN0b3JlOiBTdG9yZShfdGhpcy50aWNrKSxcbiAgICAgIHRvdWNoRXZlbnRzOiBfdGhpcy50b3VjaEV2ZW50cygpLFxuICAgICAgd2lkdGg6IDBcbiAgICB9O1xuICAgIHJldHVybiBfdGhpcztcbiAgfVxuXG4gIEluay5wcm90b3R5cGUudG91Y2hFdmVudHMgPSBmdW5jdGlvbiB0b3VjaEV2ZW50cygpIHtcbiAgICBpZiAodGhpcy5wcm9wcy5oYXNUb3VjaCkge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgb25Ub3VjaFN0YXJ0OiB0aGlzLl9vblByZXNzLFxuICAgICAgICBvblRvdWNoRW5kOiB0aGlzLl9vblJlbGVhc2UsXG4gICAgICAgIG9uVG91Y2hDYW5jZWw6IHRoaXMuX29uUmVsZWFzZVxuICAgICAgfTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgb25Nb3VzZURvd246IHRoaXMuX29uUHJlc3MsXG4gICAgICAgIG9uTW91c2VVcDogdGhpcy5fb25SZWxlYXNlLFxuICAgICAgICBvbk1vdXNlTGVhdmU6IHRoaXMuX29uUmVsZWFzZVxuICAgICAgfTtcbiAgICB9XG4gIH07XG5cbiAgSW5rLnByb3RvdHlwZS5tYWtlQmxvdCA9IGZ1bmN0aW9uIG1ha2VCbG90KGJsb3QpIHtcbiAgICB2YXIgX3N0YXRlID0gdGhpcy5zdGF0ZSxcbiAgICAgICAgY3R4ID0gX3N0YXRlLmN0eCxcbiAgICAgICAgaGVpZ2h0ID0gX3N0YXRlLmhlaWdodCxcbiAgICAgICAgd2lkdGggPSBfc3RhdGUud2lkdGg7XG4gICAgdmFyIHggPSBibG90LngsXG4gICAgICAgIHkgPSBibG90LnksXG4gICAgICAgIHJhZGl1cyA9IGJsb3QucmFkaXVzO1xuXG5cbiAgICBjdHguZ2xvYmFsQWxwaGEgPSBFcXVhdGlvbnMuZ2V0QmxvdE9wYWNpdHkoYmxvdCwgdGhpcy5wcm9wcy5vcGFjaXR5KTtcbiAgICBjdHguYmVnaW5QYXRoKCk7XG5cbiAgICBpZiAodGhpcy5wcm9wcy5yZWNlbnRlcikge1xuICAgICAgdmFyIHNpemUgPSBNYXRoLm1heChoZWlnaHQsIHdpZHRoKTtcblxuICAgICAgeCArPSBFcXVhdGlvbnMuZ2V0QmxvdFNoaWZ0WChibG90LCBzaXplLCB3aWR0aCk7XG4gICAgICB5ICs9IEVxdWF0aW9ucy5nZXRCbG90U2hpZnRZKGJsb3QsIHNpemUsIGhlaWdodCk7XG4gICAgfVxuXG4gICAgY3R4LmFyYyh4LCB5LCByYWRpdXMgKiBFcXVhdGlvbnMuZ2V0QmxvdFNjYWxlKGJsb3QpLCAwLCBUQVUpO1xuXG4gICAgY3R4LmNsb3NlUGF0aCgpO1xuICAgIGN0eC5maWxsKCk7XG4gIH07XG5cbiAgSW5rLnByb3RvdHlwZS5jb21wb25lbnRXaWxsVW5tb3VudCA9IGZ1bmN0aW9uIGNvbXBvbmVudFdpbGxVbm1vdW50KCkge1xuICAgIHRoaXMuc3RhdGUuc3RvcmUuc3RvcCgpO1xuICB9O1xuXG4gIEluay5wcm90b3R5cGUucHVzaEJsb3QgPSBmdW5jdGlvbiBwdXNoQmxvdCh0aW1lU3RhbXAsIGNsaWVudFgsIGNsaWVudFkpIHtcbiAgICB2YXIgX3RoaXMyID0gdGhpcztcblxuICAgIHZhciBlbCA9IHRoaXMuY2FudmFzO1xuXG4gICAgLy8gMC4xMyBzdXBwb3J0XG4gICAgaWYgKGVsIGluc3RhbmNlb2Ygd2luZG93LkhUTUxDYW52YXNFbGVtZW50ID09PSBmYWxzZSkge1xuICAgICAgZWwgPSBlbC5nZXRET01Ob2RlKCk7XG4gICAgfVxuXG4gICAgdmFyIF9lbCRnZXRCb3VuZGluZ0NsaWVudDIgPSBlbC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKSxcbiAgICAgICAgdG9wID0gX2VsJGdldEJvdW5kaW5nQ2xpZW50Mi50b3AsXG4gICAgICAgIGJvdHRvbSA9IF9lbCRnZXRCb3VuZGluZ0NsaWVudDIuYm90dG9tLFxuICAgICAgICBsZWZ0ID0gX2VsJGdldEJvdW5kaW5nQ2xpZW50Mi5sZWZ0LFxuICAgICAgICByaWdodCA9IF9lbCRnZXRCb3VuZGluZ0NsaWVudDIucmlnaHQ7XG5cbiAgICB2YXIgX3dpbmRvdyRnZXRDb21wdXRlZFN0ID0gd2luZG93LmdldENvbXB1dGVkU3R5bGUoZWwpLFxuICAgICAgICBjb2xvciA9IF93aW5kb3ckZ2V0Q29tcHV0ZWRTdC5jb2xvcjtcblxuICAgIHZhciBjdHggPSB0aGlzLnN0YXRlLmN0eCB8fCBlbC5nZXRDb250ZXh0KCcyZCcpO1xuICAgIHZhciBkZW5zaXR5ID0gcGl4ZWxSYXRpbyhjdHgpO1xuICAgIHZhciBoZWlnaHQgPSBib3R0b20gLSB0b3A7XG4gICAgdmFyIHdpZHRoID0gcmlnaHQgLSBsZWZ0O1xuICAgIHZhciByYWRpdXMgPSBFcXVhdGlvbnMuZ2V0TWF4UmFkaXVzKGhlaWdodCwgd2lkdGgsIHRoaXMucHJvcHMucmFkaXVzKTtcblxuICAgIHRoaXMuc2V0U3RhdGUoeyBjb2xvcjogY29sb3IsIGN0eDogY3R4LCBkZW5zaXR5OiBkZW5zaXR5LCBoZWlnaHQ6IGhlaWdodCwgd2lkdGg6IHdpZHRoIH0sIGZ1bmN0aW9uICgpIHtcbiAgICAgIF90aGlzMi5zdGF0ZS5zdG9yZS5hZGQoe1xuICAgICAgICBkdXJhdGlvbjogX3RoaXMyLnByb3BzLmR1cmF0aW9uLFxuICAgICAgICBtb3VzZURvd246IHRpbWVTdGFtcCxcbiAgICAgICAgbW91c2VVcDogMCxcbiAgICAgICAgcmFkaXVzOiByYWRpdXMsXG4gICAgICAgIHg6IGNsaWVudFggLSBsZWZ0LFxuICAgICAgICB5OiBjbGllbnRZIC0gdG9wXG4gICAgICB9KTtcbiAgICB9KTtcbiAgfTtcblxuICBJbmsucHJvdG90eXBlLnJlbmRlciA9IGZ1bmN0aW9uIHJlbmRlcigpIHtcbiAgICB2YXIgX3RoaXMzID0gdGhpcztcblxuICAgIHZhciBfc3RhdGUyID0gdGhpcy5zdGF0ZSxcbiAgICAgICAgZGVuc2l0eSA9IF9zdGF0ZTIuZGVuc2l0eSxcbiAgICAgICAgaGVpZ2h0ID0gX3N0YXRlMi5oZWlnaHQsXG4gICAgICAgIHdpZHRoID0gX3N0YXRlMi53aWR0aCxcbiAgICAgICAgdG91Y2hFdmVudHMgPSBfc3RhdGUyLnRvdWNoRXZlbnRzO1xuXG5cbiAgICByZXR1cm4gUmVhY3QuY3JlYXRlRWxlbWVudCgnY2FudmFzJywgX2V4dGVuZHMoeyBjbGFzc05hbWU6ICdpbmsnLFxuICAgICAgcmVmOiBmdW5jdGlvbiByZWYoZWwpIHtcbiAgICAgICAgcmV0dXJuIF90aGlzMy5jYW52YXMgPSBlbDtcbiAgICAgIH0sXG4gICAgICBzdHlsZTogX2V4dGVuZHMoe30sIFNUWUxFLCB0aGlzLnByb3BzLnN0eWxlKSxcbiAgICAgIGhlaWdodDogaGVpZ2h0ICogZGVuc2l0eSxcbiAgICAgIHdpZHRoOiB3aWR0aCAqIGRlbnNpdHksXG4gICAgICBvbkRyYWdPdmVyOiB0aGlzLl9vblJlbGVhc2VcbiAgICB9LCB0b3VjaEV2ZW50cykpO1xuICB9O1xuXG4gIHJldHVybiBJbms7XG59KFJlYWN0LlB1cmVDb21wb25lbnQpO1xuXG5JbmsuZGVmYXVsdFByb3BzID0ge1xuICBiYWNrZ3JvdW5kOiB0cnVlLFxuICBkdXJhdGlvbjogMTAwMCxcbiAgb3BhY2l0eTogMC4yNSxcbiAgcmFkaXVzOiAxNTAsXG4gIHJlY2VudGVyOiB0cnVlLFxuICBoYXNUb3VjaDogSEFTX1RPVUNILFxuICBjZW50ZXI6IGZhbHNlXG59O1xuXG5cbm1vZHVsZS5leHBvcnRzID0gSW5rO1xuXG4vKioqLyB9KSxcbi8qIDcgKi9cbi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHtcblxuLyoqXG4gKiBAdCBpcyB0aGUgY3VycmVudCB0aW1lIChvciBwb3NpdGlvbikgb2YgdGhlIHR3ZWVuLiBUaGlzIGNhbiBiZSBzZWNvbmRzIG9yIGZyYW1lcywgc3RlcHMsIHNlY29uZHMsIG1zLCB3aGF0ZXZlciDigJMgYXMgbG9uZyBhcyB0aGUgdW5pdCBpcyB0aGUgc2FtZSBhcyBpcyB1c2VkIGZvciB0aGUgdG90YWwgdGltZSBbM10uXG4gKiBAYiBpcyB0aGUgYmVnaW5uaW5nIHZhbHVlIG9mIHRoZSBwcm9wZXJ0eS5cbiAqIEBjIGlzIHRoZSBjaGFuZ2UgYmV0d2VlbiB0aGUgYmVnaW5uaW5nIGFuZCBkZXN0aW5hdGlvbiB2YWx1ZSBvZiB0aGUgcHJvcGVydHkuXG4gKiBAZCBpcyB0aGUgdG90YWwgdGltZSBvZiB0aGUgdHdlZW4uXG4gKi9cblxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiBlYXNlT3V0UXVpbnQodCwgYiwgYywgZCkge1xuICByZXR1cm4gYyAqICgodCA9IHQgLyBkIC0gMSkgKiB0ICogdCAqIHQgKiB0ICsgMSkgKyBiO1xufTtcblxuLyoqKi8gfSlcbi8qKioqKiovIF0pO1xuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyBpbmsuanMiLCIgXHQvLyBUaGUgbW9kdWxlIGNhY2hlXG4gXHR2YXIgaW5zdGFsbGVkTW9kdWxlcyA9IHt9O1xuXG4gXHQvLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuIFx0ZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXG4gXHRcdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuIFx0XHRpZihpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSkge1xuIFx0XHRcdHJldHVybiBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXS5leHBvcnRzO1xuIFx0XHR9XG4gXHRcdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG4gXHRcdHZhciBtb2R1bGUgPSBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSA9IHtcbiBcdFx0XHRpOiBtb2R1bGVJZCxcbiBcdFx0XHRsOiBmYWxzZSxcbiBcdFx0XHRleHBvcnRzOiB7fVxuIFx0XHR9O1xuXG4gXHRcdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuIFx0XHRtb2R1bGVzW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuIFx0XHQvLyBGbGFnIHRoZSBtb2R1bGUgYXMgbG9hZGVkXG4gXHRcdG1vZHVsZS5sID0gdHJ1ZTtcblxuIFx0XHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuIFx0XHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG4gXHR9XG5cblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXylcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubSA9IG1vZHVsZXM7XG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmMgPSBpbnN0YWxsZWRNb2R1bGVzO1xuXG4gXHQvLyBpZGVudGl0eSBmdW5jdGlvbiBmb3IgY2FsbGluZyBoYXJtb255IGltcG9ydHMgd2l0aCB0aGUgY29ycmVjdCBjb250ZXh0XG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmkgPSBmdW5jdGlvbih2YWx1ZSkgeyByZXR1cm4gdmFsdWU7IH07XG5cbiBcdC8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb24gZm9yIGhhcm1vbnkgZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kID0gZnVuY3Rpb24oZXhwb3J0cywgbmFtZSwgZ2V0dGVyKSB7XG4gXHRcdGlmKCFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywgbmFtZSkpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgbmFtZSwge1xuIFx0XHRcdFx0Y29uZmlndXJhYmxlOiBmYWxzZSxcbiBcdFx0XHRcdGVudW1lcmFibGU6IHRydWUsXG4gXHRcdFx0XHRnZXQ6IGdldHRlclxuIFx0XHRcdH0pO1xuIFx0XHR9XG4gXHR9O1xuXG4gXHQvLyBnZXREZWZhdWx0RXhwb3J0IGZ1bmN0aW9uIGZvciBjb21wYXRpYmlsaXR5IHdpdGggbm9uLWhhcm1vbnkgbW9kdWxlc1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5uID0gZnVuY3Rpb24obW9kdWxlKSB7XG4gXHRcdHZhciBnZXR0ZXIgPSBtb2R1bGUgJiYgbW9kdWxlLl9fZXNNb2R1bGUgP1xuIFx0XHRcdGZ1bmN0aW9uIGdldERlZmF1bHQoKSB7IHJldHVybiBtb2R1bGVbJ2RlZmF1bHQnXTsgfSA6XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0TW9kdWxlRXhwb3J0cygpIHsgcmV0dXJuIG1vZHVsZTsgfTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kKGdldHRlciwgJ2EnLCBnZXR0ZXIpO1xuIFx0XHRyZXR1cm4gZ2V0dGVyO1xuIFx0fTtcblxuIFx0Ly8gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSBmdW5jdGlvbihvYmplY3QsIHByb3BlcnR5KSB7IHJldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqZWN0LCBwcm9wZXJ0eSk7IH07XG5cbiBcdC8vIF9fd2VicGFja19wdWJsaWNfcGF0aF9fXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIlwiO1xuXG4gXHQvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbiBcdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKF9fd2VicGFja19yZXF1aXJlX18ucyA9IDYpO1xuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIHdlYnBhY2svYm9vdHN0cmFwIGI2ZmRmZWU4MTE4NjQ0NjA1ZTUzIiwibGV0IGVhc2luZyA9IHJlcXVpcmUoJy4vZWFzaW5nJylcbmxldCBTUVJUXzIgPSBNYXRoLnNxcnQoMilcbmxldCB7IGNvcywgbWF4LCBtaW4gfSA9IE1hdGhcblxuZnVuY3Rpb24gZ2V0UHJlc3MoYmxvdCkge1xuICByZXR1cm4gbWluKGJsb3QuZHVyYXRpb24sIERhdGUubm93KCkgLSBibG90Lm1vdXNlRG93bilcbn1cblxuZnVuY3Rpb24gZ2V0UmVsZWFzZShibG90KSB7XG4gIHJldHVybiBibG90Lm1vdXNlVXAgPiAwID8gRGF0ZS5ub3coKSAtIGJsb3QubW91c2VVcCA6IDBcbn1cblxuZnVuY3Rpb24gZ2V0UmFkaXVzKGJsb3QpIHtcbiAgbGV0IHsgZHVyYXRpb24sIHJhZGl1cyB9ID0gYmxvdFxuXG4gIGxldCBkb3duICAgICAgID0gZWFzaW5nKGdldFByZXNzKGJsb3QpLCAwLCByYWRpdXMsIGR1cmF0aW9uKSAqIDAuODVcbiAgbGV0IHVwICAgICAgICAgPSBlYXNpbmcoZ2V0UmVsZWFzZShibG90KSwgMCwgcmFkaXVzLCBkdXJhdGlvbikgKiAwLjE1XG4gIGxldCB1bmR1bGF0aW9uID0gcmFkaXVzICogMC4wMiAqIGNvcyhEYXRlLm5vdygpIC8gZHVyYXRpb24pXG5cbiAgcmV0dXJuIG1heCgwLCBkb3duICsgdXAgKyB1bmR1bGF0aW9uKVxufVxuXG5tb2R1bGUuZXhwb3J0cyA9IHtcblxuICBnZXRNYXhSYWRpdXMoaGVpZ2h0LCB3aWR0aCwgcmFkaXVzKSB7XG4gICAgcmV0dXJuIG1pbihtYXgoaGVpZ2h0LCB3aWR0aCkgKiAwLjUsIHJhZGl1cylcbiAgfSxcblxuICBnZXRCbG90T3BhY2l0eShibG90LCBvcGFjaXR5KSB7XG4gICAgcmV0dXJuIGVhc2luZyhnZXRSZWxlYXNlKGJsb3QpLCBvcGFjaXR5LCAtb3BhY2l0eSwgYmxvdC5kdXJhdGlvbilcbiAgfSxcblxuICBnZXRCbG90T3V0ZXJPcGFjaXR5KGJsb3QsIG9wYWNpdHkpIHtcbiAgICByZXR1cm4gbWluKHRoaXMuZ2V0QmxvdE9wYWNpdHkoYmxvdCwgb3BhY2l0eSksXG4gICAgICAgICAgICAgICBlYXNpbmcoZ2V0UHJlc3MoYmxvdCksIDAsIDAuMywgYmxvdC5kdXJhdGlvbiAqIDMpKVxuICB9LFxuXG4gIGdldEJsb3RTaGlmdFgoYmxvdCwgc2l6ZSwgd2lkdGgpIHtcbiAgICByZXR1cm4gbWluKDEsXG4gICAgICAgICAgICAgICBnZXRSYWRpdXMoYmxvdCkgLyBzaXplICogMiAvIFNRUlRfMikgKiAod2lkdGggLyAyIC0gYmxvdC54KVxuICB9LFxuXG4gIGdldEJsb3RTaGlmdFkoYmxvdCwgc2l6ZSwgaGVpZ2h0KSB7XG4gICAgcmV0dXJuIG1pbigxLFxuICAgICAgICAgICAgICAgZ2V0UmFkaXVzKGJsb3QpIC8gc2l6ZSAqIDIgLyBTUVJUXzIpICogKGhlaWdodCAvIDIgLSBibG90LnkpXG4gIH0sXG5cbiAgZ2V0QmxvdFNjYWxlKGJsb3QpIHtcbiAgICByZXR1cm4gZ2V0UmFkaXVzKGJsb3QpIC8gYmxvdC5yYWRpdXNcbiAgfVxufVxuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3JjL3V0aWwvZXF1YXRpb25zLmpzIiwibW9kdWxlLmV4cG9ydHMgPSB7XG4gIGJvcmRlclJhZGl1czogJ2luaGVyaXQnLFxuICBoZWlnaHQ6ICcxMDAlJyxcbiAgbGVmdDogMCxcbiAgcG9zaXRpb246ICdhYnNvbHV0ZScsXG4gIHRvcDogMCxcbiAgd2lkdGg6ICcxMDAlJ1xufVxuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3JjL3N0eWxlLmpzIiwidmFyIGJvb2wgPSBmYWxzZVxuXG5pZiAodHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgYm9vbCA9ICgnb250b3VjaHN0YXJ0JyBpbiB3aW5kb3cpIHx8IHdpbmRvdy5Eb2N1bWVudFRvdWNoICYmIGRvY3VtZW50IGluc3RhbmNlb2Ygd2luZG93LkRvY3VtZW50VG91Y2hcbn1cblxubW9kdWxlLmV4cG9ydHMgPSBib29sXG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9zcmMvdXRpbC9oYXNUb3VjaC5qcyIsIi8vIEdvb2Qgc3R1ZmYgaGVyZTpcbi8vIGh0dHA6Ly93d3cuaHRtbDVyb2Nrcy5jb20vZW4vdHV0b3JpYWxzL2NhbnZhcy9oaWRwaS9cblxubW9kdWxlLmV4cG9ydHMgPSBjb250ZXh0ID0+IHtcbiAgbGV0IGRldmljZVBpeGVsUmF0aW8gID0gd2luZG93LmRldmljZVBpeGVsUmF0aW8gfHwgMVxuICBsZXQgYmFja2luZ1N0b3JlUmF0aW8gPSBjb250ZXh0LndlYmtpdEJhY2tpbmdTdG9yZVBpeGVsUmF0aW8gfHxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGV4dC5tb3pCYWNraW5nU3RvcmVQaXhlbFJhdGlvICAgIHx8XG4gICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRleHQubXNCYWNraW5nU3RvcmVQaXhlbFJhdGlvICAgICB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZXh0Lm9CYWNraW5nU3RvcmVQaXhlbFJhdGlvICAgICAgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGV4dC5iYWNraW5nU3RvcmVQaXhlbFJhdGlvICAgICAgIHx8IDFcblxuICByZXR1cm4gZGV2aWNlUGl4ZWxSYXRpbyAvIGJhY2tpbmdTdG9yZVJhdGlvXG59XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9zcmMvdXRpbC9waXhlbFJhdGlvLmpzIiwiLyoqXG4gKiBJbmsgU3RvcmVcbiAqIEtlZXBzIHRyYWNrIG9mIGNoYW5nZXMgdG8gcmlwcGxlIGVwaWNlbnRlcnNcbiAqIHNvIHRoYXQgPEluayAvPiBjYW4gZm9jdXMgb24gcmVuZGVyaW5nIHRoZW0uXG4gKi9cblxudmFyIEVxdWF0aW9ucyA9IHJlcXVpcmUoJy4vZXF1YXRpb25zJylcblxubGV0IGtpbGxTdGFsZSA9ICh7IG1vdXNlVXAsIGR1cmF0aW9uIH0pID0+ICFtb3VzZVVwIHx8IChEYXRlLm5vdygpIC0gbW91c2VVcCkgPCBkdXJhdGlvblxuXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKHB1YmxpY2l6ZSkge1xuICBsZXQgX2RhdGEgICAgPSBbXVxuICBsZXQgX3BsYXlpbmcgPSBmYWxzZVxuICBsZXQgX2ZyYW1lXG5cbiAgbGV0IFN0b3JlID0ge1xuXG4gICAgZWFjaChjYWxsYmFjaywgc2NvcGUpIHtcbiAgICAgIGZvciAodmFyIGkgPSAwLCBsID0gX2RhdGEubGVuZ3RoOyBpIDwgbDsgaSsrKSB7XG4gICAgICAgIGNhbGxiYWNrLmNhbGwoc2NvcGUsIF9kYXRhW2ldKVxuICAgICAgfVxuICAgIH0sXG5cbiAgICBwbGF5KCkge1xuICAgICAgaWYgKCFfcGxheWluZykge1xuICAgICAgICBfcGxheWluZyA9IHRydWVcbiAgICAgICAgU3RvcmUudXBkYXRlKClcbiAgICAgIH1cbiAgICB9LFxuXG4gICAgc3RvcCgpIHtcbiAgICAgIF9wbGF5aW5nID0gZmFsc2VcbiAgICAgIGNhbmNlbEFuaW1hdGlvbkZyYW1lKF9mcmFtZSlcbiAgICB9LFxuXG4gICAgZ2V0VG90YWxPcGFjaXR5KG9wYWNpdHkpIHtcbiAgICAgIGxldCBhbnN3ZXIgPSAwXG5cbiAgICAgIGZvciAodmFyIGkgPSAwLCBsID0gX2RhdGEubGVuZ3RoOyBpIDwgbDsgaSsrKSB7XG4gICAgICAgIGFuc3dlciArPSBFcXVhdGlvbnMuZ2V0QmxvdE91dGVyT3BhY2l0eShfZGF0YVtpXSwgb3BhY2l0eSlcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIGFuc3dlclxuICAgIH0sXG5cbiAgICB1cGRhdGUoKSB7XG4gICAgICBfZGF0YSA9IF9kYXRhLmZpbHRlcihraWxsU3RhbGUpXG5cbiAgICAgIGlmIChfZGF0YS5sZW5ndGgpIHtcbiAgICAgICAgX2ZyYW1lID0gcmVxdWVzdEFuaW1hdGlvbkZyYW1lKFN0b3JlLnVwZGF0ZSlcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIFN0b3JlLnN0b3AoKVxuICAgICAgfVxuXG4gICAgICBwdWJsaWNpemUoKVxuICAgIH0sXG5cbiAgICBhZGQocHJvcHMpIHtcbiAgICAgIF9kYXRhLnB1c2gocHJvcHMpXG4gICAgICBTdG9yZS5wbGF5KClcbiAgICB9LFxuXG4gICAgcmVsZWFzZSh0aW1lKSB7XG4gICAgICBmb3IgKGxldCBpID0gX2RhdGEubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIHtcbiAgICAgICAgaWYgKCFfZGF0YVtpXS5tb3VzZVVwKSB7XG4gICAgICAgICAgcmV0dXJuIF9kYXRhW2ldLm1vdXNlVXAgPSB0aW1lXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgfVxuXG4gIHJldHVybiBTdG9yZVxufVxuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3JjL3V0aWwvc3RvcmUuanMiLCJtb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoXCJyZWFjdFwiKTtcblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyBleHRlcm5hbCBcInJlYWN0XCJcbi8vIG1vZHVsZSBpZCA9IDVcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwiLyoqXG4gKiBJbmtcbiAqIEZpbGxzIGEgY29udGFpbmVyIHdpdGggYW4gU1ZHIG9iamVjdCB0aGF0IHByb3ZpZGVzIGZlZWRiYWNrIG9uIG1vdXNlL3RvdWNoXG4gKiBldmVudHMgd2l0aCBhIHJpcHBsaW5nIHBvb2wuXG4gKi9cblxubGV0IEhBU19UT1VDSCAgPSByZXF1aXJlKCcuL3V0aWwvaGFzVG91Y2gnKVxubGV0IE1PVVNFX0xFRlQgPSAwXG5sZXQgcGl4ZWxSYXRpbyA9IHJlcXVpcmUoJy4vdXRpbC9waXhlbFJhdGlvJylcbmxldCBSZWFjdCAgICAgID0gcmVxdWlyZSgncmVhY3QnKVxubGV0IFNUWUxFICAgICAgPSByZXF1aXJlKCcuL3N0eWxlJylcbmxldCBTdG9yZSAgICAgID0gcmVxdWlyZSgnLi91dGlsL3N0b3JlJylcbmxldCBUQVUgICAgICAgID0gTWF0aC5QSSAqIDJcbmxldCBFcXVhdGlvbnMgID0gcmVxdWlyZSgnLi91dGlsL2VxdWF0aW9ucycpXG5cbmNsYXNzIEluayBleHRlbmRzIFJlYWN0LlB1cmVDb21wb25lbnQge1xuXG4gIHN0YXRpYyBkZWZhdWx0UHJvcHMgPSB7XG4gICAgYmFja2dyb3VuZCA6IHRydWUsXG4gICAgZHVyYXRpb24gICA6IDEwMDAsXG4gICAgb3BhY2l0eSAgICA6IDAuMjUsXG4gICAgcmFkaXVzICAgICA6IDE1MCxcbiAgICByZWNlbnRlciAgIDogdHJ1ZSxcbiAgICBoYXNUb3VjaCAgIDogSEFTX1RPVUNILFxuICAgIGNlbnRlciAgICAgOiBmYWxzZSxcbiAgfVxuXG4gIGNvbnN0cnVjdG9yIChwcm9wcykge1xuICAgIHN1cGVyKC4uLmFyZ3VtZW50cylcblxuICAgIHRoaXMuc3RhdGUgPSB7XG4gICAgICBjb2xvciAgICAgICA6ICd0cmFuc3BhcmVudCcsXG4gICAgICBkZW5zaXR5ICAgICA6IDEsXG4gICAgICBoZWlnaHQgICAgICA6IDAsXG4gICAgICBzdG9yZSAgICAgICA6IFN0b3JlKHRoaXMudGljayksXG4gICAgICB0b3VjaEV2ZW50cyA6IHRoaXMudG91Y2hFdmVudHMoKSxcbiAgICAgIHdpZHRoICAgICAgIDogMFxuICAgIH1cbiAgfVxuXG4gIHRvdWNoRXZlbnRzICgpIHtcbiAgICBpZiAodGhpcy5wcm9wcy5oYXNUb3VjaCkge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgb25Ub3VjaFN0YXJ0ICA6IHRoaXMuX29uUHJlc3MsXG4gICAgICAgIG9uVG91Y2hFbmQgICAgOiB0aGlzLl9vblJlbGVhc2UsXG4gICAgICAgIG9uVG91Y2hDYW5jZWwgOiB0aGlzLl9vblJlbGVhc2VcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgb25Nb3VzZURvd24gICA6IHRoaXMuX29uUHJlc3MsXG4gICAgICAgIG9uTW91c2VVcCAgICAgOiB0aGlzLl9vblJlbGVhc2UsXG4gICAgICAgIG9uTW91c2VMZWF2ZSAgOiB0aGlzLl9vblJlbGVhc2VcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICB0aWNrID0gKCkgPT4ge1xuICAgIGxldCB7IGN0eCwgY29sb3IsIGRlbnNpdHksIGhlaWdodCwgd2lkdGgsIHN0b3JlIH0gPSB0aGlzLnN0YXRlXG5cbiAgICBjdHguc2F2ZSgpXG5cbiAgICBjdHguc2NhbGUoZGVuc2l0eSwgZGVuc2l0eSlcblxuICAgIGN0eC5jbGVhclJlY3QoMCwgMCwgd2lkdGgsIGhlaWdodClcblxuICAgIGN0eC5maWxsU3R5bGUgPSBjb2xvclxuXG4gICAgaWYgKHRoaXMucHJvcHMuYmFja2dyb3VuZCkge1xuICAgICAgY3R4Lmdsb2JhbEFscGhhID0gc3RvcmUuZ2V0VG90YWxPcGFjaXR5KHRoaXMucHJvcHMub3BhY2l0eSlcbiAgICAgIGN0eC5maWxsUmVjdCgwLCAwLCB3aWR0aCwgaGVpZ2h0KVxuICAgIH1cblxuICAgIHN0b3JlLmVhY2godGhpcy5tYWtlQmxvdCwgdGhpcylcblxuICAgIGN0eC5yZXN0b3JlKClcbiAgfVxuXG4gIG1ha2VCbG90IChibG90KSB7XG4gICAgbGV0IHsgY3R4LCBoZWlnaHQsIHdpZHRoIH0gPSB0aGlzLnN0YXRlXG4gICAgbGV0IHsgeCwgeSwgcmFkaXVzIH0gPSBibG90XG5cbiAgICBjdHguZ2xvYmFsQWxwaGEgPSBFcXVhdGlvbnMuZ2V0QmxvdE9wYWNpdHkoYmxvdCwgdGhpcy5wcm9wcy5vcGFjaXR5KVxuICAgIGN0eC5iZWdpblBhdGgoKVxuXG4gICAgaWYgKHRoaXMucHJvcHMucmVjZW50ZXIpIHtcbiAgICAgIGxldCBzaXplID0gTWF0aC5tYXgoaGVpZ2h0LCB3aWR0aClcblxuICAgICAgeCArPSBFcXVhdGlvbnMuZ2V0QmxvdFNoaWZ0WChibG90LCBzaXplLCB3aWR0aClcbiAgICAgIHkgKz0gRXF1YXRpb25zLmdldEJsb3RTaGlmdFkoYmxvdCwgc2l6ZSwgaGVpZ2h0KVxuICAgIH1cblxuICAgIGN0eC5hcmMoeCwgeSwgcmFkaXVzICogRXF1YXRpb25zLmdldEJsb3RTY2FsZShibG90KSwgMCwgVEFVKVxuXG4gICAgY3R4LmNsb3NlUGF0aCgpXG4gICAgY3R4LmZpbGwoKVxuICB9XG5cbiAgY29tcG9uZW50V2lsbFVubW91bnQgKCkge1xuICAgIHRoaXMuc3RhdGUuc3RvcmUuc3RvcCgpXG4gIH1cblxuICBwdXNoQmxvdCAodGltZVN0YW1wLCBjbGllbnRYLCBjbGllbnRZKSB7XG4gICAgbGV0IGVsID0gdGhpcy5jYW52YXNcblxuICAgIC8vIDAuMTMgc3VwcG9ydFxuICAgIGlmIChlbCBpbnN0YW5jZW9mIHdpbmRvdy5IVE1MQ2FudmFzRWxlbWVudCA9PT0gZmFsc2UpIHtcbiAgICAgIGVsID0gZWwuZ2V0RE9NTm9kZSgpXG4gICAgfVxuXG4gICAgbGV0IHsgdG9wLCBib3R0b20sIGxlZnQsIHJpZ2h0IH0gPSBlbC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKVxuICAgIGxldCB7IGNvbG9yIH0gPSB3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZShlbClcblxuICAgIGxldCBjdHggICAgID0gdGhpcy5zdGF0ZS5jdHggfHwgZWwuZ2V0Q29udGV4dCgnMmQnKVxuICAgIGxldCBkZW5zaXR5ID0gcGl4ZWxSYXRpbyhjdHgpXG4gICAgbGV0IGhlaWdodCAgPSBib3R0b20gLSB0b3BcbiAgICBsZXQgd2lkdGggICA9IHJpZ2h0IC0gbGVmdFxuICAgIGxldCByYWRpdXMgID0gRXF1YXRpb25zLmdldE1heFJhZGl1cyhoZWlnaHQsIHdpZHRoLCB0aGlzLnByb3BzLnJhZGl1cylcblxuICAgIHRoaXMuc2V0U3RhdGUoeyBjb2xvciwgY3R4LCBkZW5zaXR5LCBoZWlnaHQsIHdpZHRoIH0sICgpID0+IHtcbiAgICAgIHRoaXMuc3RhdGUuc3RvcmUuYWRkKHtcbiAgICAgICAgZHVyYXRpb24gIDogdGhpcy5wcm9wcy5kdXJhdGlvbixcbiAgICAgICAgbW91c2VEb3duIDogdGltZVN0YW1wLFxuICAgICAgICBtb3VzZVVwICAgOiAwLFxuICAgICAgICByYWRpdXMgICAgOiByYWRpdXMsXG4gICAgICAgIHggICAgICAgICA6IGNsaWVudFggLSBsZWZ0LFxuICAgICAgICB5ICAgICAgICAgOiBjbGllbnRZIC0gdG9wXG4gICAgICB9KVxuICAgIH0pXG4gIH1cblxuICByZW5kZXIgKCkge1xuICAgIGxldCB7IGRlbnNpdHksIGhlaWdodCwgd2lkdGgsIHRvdWNoRXZlbnRzIH0gPSB0aGlzLnN0YXRlXG5cbiAgICByZXR1cm4gKFxuICAgICAgPGNhbnZhcyBjbGFzc05hbWU9XCJpbmtcIlxuICAgICAgICAgICAgICByZWY9e2VsID0+IHRoaXMuY2FudmFzID0gZWx9XG4gICAgICAgICAgICAgIHN0eWxlPXt7IC4uLlNUWUxFLCAuLi50aGlzLnByb3BzLnN0eWxlIH19XG4gICAgICAgICAgICAgIGhlaWdodD17IGhlaWdodCAqIGRlbnNpdHkgfVxuICAgICAgICAgICAgICB3aWR0aD17IHdpZHRoICogZGVuc2l0eSB9XG4gICAgICAgICAgICAgIG9uRHJhZ092ZXI9eyB0aGlzLl9vblJlbGVhc2UgfVxuICAgICAgICAgICAgICB7IC4uLnRvdWNoRXZlbnRzIH0gLz5cbiAgICApXG4gIH1cblxuICBfZ2V0Q2VudGVyID0gKCkgPT4ge1xuICAgIGxldCBlbCA9IHRoaXMuY2FudmFzXG4gICAgbGV0IHsgdG9wLCBib3R0b20sIGxlZnQsIHJpZ2h0IH0gPSBlbC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKVxuXG4gICAgcmV0dXJuIHtcbiAgICAgIGNsaWVudFg6IGxlZnQgKyAocmlnaHQgLSBsZWZ0KSAvIDIsXG4gICAgICBjbGllbnRZOiB0b3AgKyAoYm90dG9tIC0gdG9wKSAvIDIsXG4gICAgfVxuICB9XG5cbiAgX29uUHJlc3MgPSAoZSkgPT4ge1xuICAgIGxldCB7IGNlbnRlciB9ID0gdGhpcy5wcm9wc1xuICAgIGxldCB7IGJ1dHRvbiwgY3RybEtleSwgY2xpZW50WCwgY2xpZW50WSwgY2hhbmdlZFRvdWNoZXMgfSA9IGVcbiAgICBsZXQgdGltZVN0YW1wID0gRGF0ZS5ub3coKVxuXG4gICAgaWYgKGNoYW5nZWRUb3VjaGVzKSB7XG4gICAgICBpZiAoY2VudGVyKSB7XG4gICAgICAgIGxldCB7IGNsaWVudFgsIGNsaWVudFkgfSA9IHRoaXMuX2dldENlbnRlcigpXG4gICAgICAgIHRoaXMucHVzaEJsb3QodGltZVN0YW1wLCBjbGllbnRYLCBjbGllbnRZKVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjaGFuZ2VkVG91Y2hlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgIGxldCB7IGNsaWVudFgsIGNsaWVudFkgfSA9IGNoYW5nZWRUb3VjaGVzW2ldXG4gICAgICAgICAgdGhpcy5wdXNoQmxvdCh0aW1lU3RhbXAsIGNsaWVudFgsIGNsaWVudFkpXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9IGVsc2UgaWYgKGJ1dHRvbiA9PT0gTU9VU0VfTEVGVCAmJiAhY3RybEtleSkge1xuICAgICAgaWYgKGNlbnRlcikge1xuICAgICAgICBsZXQgeyBjbGllbnRYLCBjbGllbnRZIH0gPSB0aGlzLl9nZXRDZW50ZXIoKVxuICAgICAgICB0aGlzLnB1c2hCbG90KHRpbWVTdGFtcCwgY2xpZW50WCwgY2xpZW50WSlcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMucHVzaEJsb3QodGltZVN0YW1wLCBjbGllbnRYLCBjbGllbnRZKVxuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIF9vblJlbGVhc2UgPSAoKSA9PiB7XG4gICAgdGhpcy5zdGF0ZS5zdG9yZS5yZWxlYXNlKERhdGUubm93KCkpXG4gIH1cblxufVxuXG5tb2R1bGUuZXhwb3J0cyA9IElua1xuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3JjL2luZGV4LmpzIiwiLyoqXG4gKiBAdCBpcyB0aGUgY3VycmVudCB0aW1lIChvciBwb3NpdGlvbikgb2YgdGhlIHR3ZWVuLiBUaGlzIGNhbiBiZSBzZWNvbmRzIG9yIGZyYW1lcywgc3RlcHMsIHNlY29uZHMsIG1zLCB3aGF0ZXZlciDigJMgYXMgbG9uZyBhcyB0aGUgdW5pdCBpcyB0aGUgc2FtZSBhcyBpcyB1c2VkIGZvciB0aGUgdG90YWwgdGltZSBbM10uXG4gKiBAYiBpcyB0aGUgYmVnaW5uaW5nIHZhbHVlIG9mIHRoZSBwcm9wZXJ0eS5cbiAqIEBjIGlzIHRoZSBjaGFuZ2UgYmV0d2VlbiB0aGUgYmVnaW5uaW5nIGFuZCBkZXN0aW5hdGlvbiB2YWx1ZSBvZiB0aGUgcHJvcGVydHkuXG4gKiBAZCBpcyB0aGUgdG90YWwgdGltZSBvZiB0aGUgdHdlZW4uXG4gKi9cblxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiBlYXNlT3V0UXVpbnQgKHQsIGIsIGMsIGQpIHtcbiAgcmV0dXJuIGMqKCh0PXQvZC0xKSp0KnQqdCp0ICsgMSkgKyBiXG59XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9zcmMvdXRpbC9lYXNpbmcuanMiXSwic291cmNlUm9vdCI6IiJ9